{
  final SeqType et=expr.type(), vt=type();
  if (!checksType() || vt.type.instanceOf(et.type) || et.type.instanceOf(vt.type) && et.occ.instanceOf(vt.occ))   return;
  if (!promote || !et.type.isNode() && !et.promotable(vt)) {
    if (vt.type.nsSensitive() && sc.xquery3())     throw NSSENS.get(info,et,vt);
    throw INVCAST.get(info,et,vt);
  }
}
