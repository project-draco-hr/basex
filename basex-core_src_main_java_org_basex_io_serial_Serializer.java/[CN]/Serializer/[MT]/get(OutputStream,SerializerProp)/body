{
  if (props == null)   return get(os);
  final String m=props.check(S_METHOD,METHODS);
  if (M_XHTML.equals(m))   return new XHTMLSerializer(os,props);
  if (M_HTML.equals(m))   return new HTMLSerializer(os,props);
  if (M_TEXT.equals(m))   return new TextSerializer(os,props);
  if (M_RAW.equals(m))   return new RawSerializer(os,props);
  if (M_CSV.equals(m))   return new CsvSerializer(os,props);
  final boolean jsonml=M_JSONML.equals(m);
  if (jsonml || M_JSON.equals(m)) {
    final JsonProp jp=new JsonProp(props.get(S_JSON));
    if (jsonml) {
      jp.set(JsonProp.FORMAT,M_JSONML);
      props.set(S_JSON,jp.toString());
    }
    return jp.get(JsonProp.FORMAT).equals(M_JSON) ? new JsonCGSerializer(os,props) : new JsonMLSerializer(os,props);
  }
  return new XMLSerializer(os,props);
}
