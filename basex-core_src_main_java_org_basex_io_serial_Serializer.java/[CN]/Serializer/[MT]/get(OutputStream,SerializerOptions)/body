{
  if (opts == null)   return get(os);
switch (opts.get(SerializerOptions.METHOD)) {
case XHTML:
    return new XHTMLSerializer(os,opts);
case HTML:
  return new HTMLSerializer(os,opts);
case TEXT:
return new TextSerializer(os,opts);
case RAW:
return new RawSerializer(os,opts);
case CSV:
return new CsvSerializer(os,opts);
case JSON:
final JsonSerialOptions jopts=new JsonSerialOptions(opts.get(SerializerOptions.JSON));
return jopts.get(JsonOptions.FORMAT) == JsonFormat.JSONML ? new JsonMLSerializer(os,opts) : new JsonDirectSerializer(os,opts);
default :
return new XMLSerializer(os,opts);
}
}
