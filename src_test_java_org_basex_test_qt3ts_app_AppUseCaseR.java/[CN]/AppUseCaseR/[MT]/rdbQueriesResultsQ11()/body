{
  final XQuery query=new XQuery("\n" + "        let $highbid := max($bids//bid_tuple/bid) \n" + "        return <result> { for $item in $items//item_tuple, \n"+ "                              $b in $bids//bid_tuple[itemno = $item/itemno] \n"+ "                          where $b/bid = $highbid \n"+ "                          return <expensive_item> { $item/itemno } { $item/description } \n"+ "                                    <high_bid>{ $highbid }</high_bid> \n"+ "                                 </expensive_item> \n"+ "               } </result>\n"+ "      ",ctx);
  try {
    query.bind("$users",node(file("docs/users.xml")));
    query.bind("$items",node(file("docs/items.xml")));
    query.bind("$bids",node(file("docs/bids.xml")));
    result=new QT3Result(query.value());
  }
 catch (  final Throwable trw) {
    result=new QT3Result(trw);
  }
 finally {
    query.close();
  }
  test(assertSerialization("<result><expensive_item><itemno>1002</itemno><description>Motorcycle</description><high_bid>1200</high_bid></expensive_item></result>",false));
}
