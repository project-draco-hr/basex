{
  final XQuery query=new XQuery("\n" + "        <result> { \n" + "            for $uid in distinct-values($bids//userid), \n"+ "                $u in $users//user_tuple[userid = $uid] \n"+ "            let $b := $bids//bid_tuple[userid = $uid] \n"+ "            order by exactly-one($u/userid) \n"+ "            return <bidder> { $u/userid } { $u/name } <bidcount>{ count($b) }</bidcount> <avgbid>{ avg($b/bid) }</avgbid> </bidder> \n"+ "        } </result>\n"+ "      ",ctx);
  query.bind("$users",node(file("docs/users.xml")));
  query.bind("$items",node(file("docs/items.xml")));
  query.bind("$bids",node(file("docs/bids.xml")));
  final QT3Result res=result(query);
  result=res;
  test(assertSerialization("<result><bidder><userid>U01</userid><name>Tom Jones</name><bidcount>2</bidcount><avgbid>220</avgbid></bidder><bidder><userid>U02</userid><name>Mary Doe</name><bidcount>5</bidcount><avgbid>387</avgbid></bidder><bidder><userid>U03</userid><name>Dee Linquent</name><bidcount>2</bidcount><avgbid>487.5</avgbid></bidder><bidder><userid>U04</userid><name>Roger Smith</name><bidcount>5</bidcount><avgbid>266</avgbid></bidder><bidder><userid>U05</userid><name>Jack Sprat</name><bidcount>2</bidcount><avgbid>110</avgbid></bidder></result>",false));
}
