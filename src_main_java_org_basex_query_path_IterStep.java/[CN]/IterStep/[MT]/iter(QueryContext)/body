{
  return new NodeIter(){
    final Value cv=ctx.value;
    final long cp=ctx.pos;
    boolean finish;
    NodeIter ir;
    Iter iter;
    @Override public Nod next() throws QueryException {
      if (finish)       return null;
      if (iter == null) {
        iter=checkCtx(ctx).iter(ctx);
        ctx.pos=0;
      }
      Nod temp=null;
      while (true) {
        ctx.checkStop();
        if (ir == null) {
          final Item i=iter.next();
          if (i == null)           break;
          if (!i.node())           NODESPATH.thrw(input,IterStep.this,i.type);
          ir=axis.init((Nod)i);
        }
        final Nod nod=ir.next();
        if (nod != null) {
          if (test.eval(nod)) {
            ctx.value=nod;
            ctx.pos++;
            final Item i=pred[0].test(ctx,input);
            if (i != null) {
              nod.score(i.score());
              if (pos != null && pos.last(ctx))               ir=null;
              return nod.finish();
            }
            if (last)             temp=nod.finish();
          }
        }
 else {
          ir=null;
        }
      }
      ctx.value=cv;
      ctx.pos=cp;
      finish=last;
      return temp;
    }
  }
;
}
