{
  if (map == EMPTY)   return this;
  if (map.dt != 0 && dt != 0 && (map.dt > 0 ? dt < 0 : dt > 0))   throw MAP_TZ.get(ii);
  final TrieNode upd=root.addAll(map.root,0,ii);
  return upd == map.root ? map : new Map(upd,map.dt + dt);
}
