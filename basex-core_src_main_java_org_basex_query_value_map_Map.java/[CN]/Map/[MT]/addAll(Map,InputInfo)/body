{
  if (map == EMPTY)   return this;
  final TrieNode upd=root.addAll(map.root,0,ii);
  if (upd == map.root)   return map;
  if (map.dt != 0 && dt != 0 && (map.dt > 0 ? dt < 0 : dt > 0))   throw MAPTZ.get(ii);
  return new Map(upd,map.dt + dt);
}
