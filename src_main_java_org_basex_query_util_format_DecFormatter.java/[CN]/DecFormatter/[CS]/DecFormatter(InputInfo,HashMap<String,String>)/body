{
  int zero='0';
  if (map != null) {
    for (    final Entry<String,String> e : map.entrySet()) {
      final String key=e.getKey(), val=e.getValue();
      int cp=val.isEmpty() ? 0 : val.codePointAt(0);
      if (Character.charCount(cp) != val.length())       cp=0;
      if (key.equals(DF_INF)) {
        inf=val;
      }
 else       if (key.equals(DF_NAN)) {
        nan=val;
      }
 else       if (cp != 0) {
        if (key.equals(DF_DEC))         decimal=cp;
 else         if (key.equals(DF_GRP))         grouping=cp;
 else         if (key.equals(DF_PAT))         pattern=cp;
 else         if (key.equals(DF_MIN))         minus=cp;
 else         if (key.equals(DF_DIG))         optional=cp;
 else         if (key.equals(DF_PC))         percent=cp;
 else         if (key.equals(DF_PM))         permille=cp;
 else         if (key.equals(DF_ZG)) {
          zero=zeroes(cp);
          if (zero == -1)           INVDECFORM.thrw(ii,key,val);
        }
      }
 else {
        INVDECFORM.thrw(ii,key,val);
      }
    }
  }
  final IntSet is=new IntSet();
  for (  final int i : new int[]{decimal,grouping,percent,permille,zero,optional,pattern}) {
    if (is.add(i) < 0)     DUPLDECFORM.thrw(ii,(char)i);
  }
  final TokenBuilder tb=new TokenBuilder();
  for (int i=0; i < 10; i++)   tb.add(zero + i);
  digits=tb.toString();
  active=tb.add(decimal).add(grouping).add(optional).toString();
}
