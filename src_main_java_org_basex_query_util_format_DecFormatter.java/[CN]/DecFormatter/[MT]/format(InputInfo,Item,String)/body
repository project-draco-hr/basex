{
  final TokenList tl=new TokenList();
  String pic=picture;
  final int i=pic.indexOf(pattern);
  if (i == -1) {
    tl.add(pic);
  }
 else {
    tl.add(pic.substring(0,i));
    pic=pic.substring(i + 1);
    if (pic.indexOf(pattern) != -1)     PICNUM.thrw(ii,picture);
    tl.add(pic);
  }
  final byte[][] patterns=tl.toArray();
  if (!check(patterns))   PICNUM.thrw(ii,picture);
  final Picture[] pics=analyze(patterns);
  return token(format(number,pics,ii));
}
