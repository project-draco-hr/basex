{
  if (!selected()) {
    select(0,size());
    if (!selected())     return false;
  }
  final int s=Math.min(ms,me), e=Math.max(ms,me), tl=text.length;
  final byte[] format=syntax.format(Arrays.copyOfRange(text,s,e));
  final boolean changed=text(new TokenBuilder().add(text,0,s).add(format).add(text,e,tl).finish());
  ms=s;
  me=s + format.length;
  setCaret(me);
  checkSelect();
  return changed;
}
