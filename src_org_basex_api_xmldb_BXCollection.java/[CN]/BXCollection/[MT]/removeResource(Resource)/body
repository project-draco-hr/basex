{
  check();
  if (res instanceof BXXMLResource) {
    BXXMLResource tmp=(BXXMLResource)res;
    if (Token.string(ctx.data().text(tmp.getPre())).equals(tmp.getDocumentId())) {
      ctx.data().delete(((BXXMLResource)res).getPre());
      ctx.data().flush();
    }
 else {
      throw new XMLDBException(ErrorCodes.NO_SUCH_RESOURCE);
    }
  }
 else {
    throw new XMLDBException(ErrorCodes.INVALID_RESOURCE);
  }
}
