{
  if (res.getContent() instanceof Document) {
    try {
      final Data tmp=CreateDB.xml(new DOCWrapper((Document)res.getContent()),res.getId());
      ctx.data().atts.noStats();
      ctx.data().insert(ctx.data().size,-1,tmp);
      ctx.data().flush();
      tmp.close();
      DropDB.drop(res.getId());
    }
 catch (    final IOException ex) {
      throw new XMLDBException(ErrorCodes.INVALID_RESOURCE);
    }
  }
 else {
    String cont=res.getContent().toString();
    try {
      final Data tmp=CreateDB.xml(IO.get(cont),res.getId());
      ctx.data().insert(ctx.data().size,-1,tmp);
      ctx.data().flush();
      tmp.close();
      DropDB.drop(res.getId());
    }
 catch (    final IOException ex) {
      throw new XMLDBException(ErrorCodes.INVALID_RESOURCE);
    }
  }
}
