{
  final boolean i=args.length == 1 && args[0].i();
  final boolean e=args.length == 1 && args[0].e();
switch (func) {
case FALSE:
case TRUE:
    return atomic(ctx);
case EMPTY:
case EXISTS:
case BOOL:
  return i ? atomic(ctx) : this;
case NOT:
if (i) return atomic(ctx);
if (args[0] instanceof Fun) {
final Fun fs=(Fun)args[0];
if (fs.func == FunDef.EMPTY) {
  args=fs.args;
  func=FunDef.EXISTS;
}
 else if (fs.func == FunDef.EXISTS) {
  args=fs.args;
  func=FunDef.EMPTY;
}
}
return this;
case ZEROONE:
return e || i || args[0].returned(ctx).single ? args[0] : this;
case EXONE:
case ONEMORE:
return i || args[0].returned(ctx).single ? args[0] : this;
case UNORDER:
return args[0];
default :
return this;
}
}
