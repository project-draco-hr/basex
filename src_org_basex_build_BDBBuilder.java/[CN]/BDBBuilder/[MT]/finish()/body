{
  if (tags.size() > 0x0FFF)   throw new IOException(LIMITTAGS);
  if (atts.size() > 0x0FFF)   throw new IOException(LIMITATTS);
  close();
  final String db=meta.dbname;
  final DataOutput out=new DataOutput(meta.dbname,DATAINFO);
  meta.finish(out);
  tags.finish(out);
  atts.finish(out);
  skel.finish(out);
  ns.finish(out);
  out.close();
  return new BDBData(db);
}
