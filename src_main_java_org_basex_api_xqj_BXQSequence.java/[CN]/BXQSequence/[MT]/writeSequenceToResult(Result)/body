{
  valid(res,Result.class);
  if (it != null && !next)   throw new BXQException(TWICE);
  if (res instanceof StreamResult) {
    final StreamResult sr=(StreamResult)res;
    if (sr.getWriter() != null)     writeSequence(sr.getWriter(),null);
 else     writeSequence(sr.getOutputStream(),null);
  }
 else   if (res instanceof SAXResult) {
    final SAXSerializer ser=new SAXSerializer(null);
    final SAXResult sax=(SAXResult)res;
    ser.setContentHandler(sax.getHandler());
    ser.setLexicalHandler(sax.getLexicalHandler());
    while (next())     serialize(item().it,ser);
  }
 else {
    throw Util.notimplemented();
  }
}
