{
  return new BXCode<BXResource>(this){
    @Override public BXDocument get() throws IOException {
      s.execute(new Open(db));
      final String doc=path.isEmpty() ? newName : path + SEP + newName;
      if (count(s,db,doc) == 0) {
        addFile(s,newName,input,contentType);
        deleteDummy(s,db,path);
      }
 else {
        s.replace(doc,input);
      }
      return new BXDocument(db,doc,session,isRaw(s,db,doc));
    }
  }
.eval();
}
