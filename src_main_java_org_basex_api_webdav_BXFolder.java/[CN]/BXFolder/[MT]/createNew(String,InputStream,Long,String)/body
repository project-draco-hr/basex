{
  if (supported(contentType)) {
    try {
      final ClientSession cs=login(user,pass);
      try {
        cs.execute(new Open(db));
        final String docPath=path.isEmpty() ? newName : path + DIRSEP + newName;
        if (resource(cs,db,docPath) != null) {
          cs.replace(docPath,inputStream);
        }
 else {
          cs.add(newName,path,inputStream);
        }
        return new BXDocument(db,path + DIRSEP + newName,user,pass);
      }
  finally {
        cs.close();
      }
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  return null;
}
