{
  return new BXCode<BXDocument>(this){
    @Override public BXDocument get() throws IOException {
      s.execute(new Open(db));
      final String doc=path.isEmpty() ? newName : path + SEP + newName;
      if (count(s,db,doc) == 0) {
        s.add(newName,path,input);
        deleteDummy(s,db,path);
      }
 else {
        s.replace(doc,input);
      }
      return new BXDocument(db,doc,session);
    }
  }
.eval();
}
