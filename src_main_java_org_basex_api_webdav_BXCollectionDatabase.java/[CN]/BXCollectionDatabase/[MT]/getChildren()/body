{
  final List<BXResource> dbs=new ArrayList<BXResource>();
  final TokenObjMap<IntList> dirs=new TokenObjMap<IntList>();
  try {
    new Open(dbname).execute(ctx);
    for (    final int pre : ctx.doc()) {
      final byte[] doc=ctx.data.text(pre,true);
      final int idx=indexOf(doc,token(Prop.DIRSEP));
      if (idx <= 0)       dbs.add(new BXDocument(dbname,string(doc),ctx));
 else {
        final byte[] dir=substring(doc,0,idx);
        if (dirs.get(dir) == null)         dirs.add(dir,new IntList());
        dirs.get(dir).add(pre);
      }
    }
    for (    final byte[] d : dirs)     dbs.add(new BXFolder(dbname,dirs.get(d).toArray(),string(d),ctx));
    new Close().execute(ctx);
  }
 catch (  BaseXException e) {
    e.printStackTrace();
  }
  return dbs;
}
