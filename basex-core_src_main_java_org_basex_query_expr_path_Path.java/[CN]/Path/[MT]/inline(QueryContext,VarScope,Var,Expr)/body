{
  boolean changed=false;
  final Value init=qc.value;
  qc.value=null;
  try {
    changed=inlineAll(qc,scp,steps,var,ex);
  }
  finally {
    qc.value=init;
  }
  if (root != null) {
    final Expr rt=root.inline(qc,scp,var,ex);
    if (rt != null) {
      root=rt;
      changed=true;
    }
  }
  return changed ? optimize(qc,scp) : null;
}
