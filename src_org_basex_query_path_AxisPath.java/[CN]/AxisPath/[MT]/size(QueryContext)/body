{
  long res=-1;
  final Item rt=root(ctx);
  final Data data=rt != null && rt.type == Type.DOC && rt instanceof DBNode ? ((DBNode)rt).data : null;
  if (data != null && data.meta.uptodate && data.ns.size() == 0) {
    HashSet<SkelNode> nodes=new HashSet<SkelNode>(1);
    nodes.add(data.skel.root);
    for (    final Step s : step) {
      res=-1;
      nodes=s.count(nodes,data);
      if (nodes == null)       break;
      res=0;
      for (      final SkelNode sn : nodes)       res+=sn.count;
    }
  }
  return res;
}
