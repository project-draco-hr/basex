{
  long res=-1;
  final Item rt=root(ctx);
  final Data data=rt != null && rt.type == Type.DOC && rt instanceof DBNode ? ((DBNode)rt).data : null;
  if (data != null && !data.meta.pathindex && data.meta.uptodate && data.ns.size() == 0) {
    ArrayList<PathNode> nodes=data.path.root();
    for (    final Step s : step) {
      res=-1;
      nodes=s.count(nodes,data);
      if (nodes == null)       break;
      res=0;
      for (      final PathNode sn : nodes)       res+=sn.count;
    }
  }
  return res;
}
