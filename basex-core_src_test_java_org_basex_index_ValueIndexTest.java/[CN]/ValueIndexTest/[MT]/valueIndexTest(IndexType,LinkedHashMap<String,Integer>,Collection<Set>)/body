{
  for (  Set option : options)   execute(option);
  execute(new CreateDB(NAME,FILE));
  boolean text=IndexType.TEXT == indexType;
  ValueIndex index=text ? context.data().textIndex : IndexType.ATTTOKEN == indexType ? context.data().attrTokenIndex : context.data().attrIndex;
  for (  final Entry<String,Integer> entry : tokens.entrySet()) {
    byte[] token=token(entry.getKey());
    IndexIterator it=index.iter(new IndexEntries(token,indexType));
    long count=0;
    while (it.more()) {
      int pre=it.pre();
      final byte[] result=context.data().text(pre,text);
      if (IndexType.ATTTOKEN == indexType)       assertTrue("Token '" + entry.getKey() + "' not found in match '"+ string(result)+ "'!",new TokenSet(Token.split(normalize(result),' ')).contains(token(entry.getKey())));
 else       assertEquals("Wrong result returned!",entry.getKey(),string(result));
      count++;
    }
    assertEquals("Wrong number of nodes returned: \"" + entry.getKey() + "\": ",(long)entry.getValue(),count);
  }
  execute(new Set(MainOptions.MAINMEM,false));
  execute(new Set(MainOptions.UPDINDEX,false));
  execute(new DropDB(NAME));
}
