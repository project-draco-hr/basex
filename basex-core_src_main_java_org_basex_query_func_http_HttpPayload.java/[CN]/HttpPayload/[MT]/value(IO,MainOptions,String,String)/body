{
  Value val=null;
  if (ctype != null) {
    if (isJSON(ctype)) {
      final JsonParserOptions jopts=new JsonParserOptions();
      if (Strings.eq(ctype,APP_JSONML))       jopts.set(JsonOptions.FORMAT,JsonFormat.JSONML);
      val=new DBNode(new JsonParser(in,opts,jopts));
    }
 else     if (TEXT_CSV.equals(ctype)) {
      val=new DBNode(new CsvParser(in,opts));
    }
 else     if (TEXT_HTML.equals(ctype)) {
      val=new DBNode(new HtmlParser(in,opts));
    }
 else     if (APP_FORM_URLENCODED.equals(ctype)) {
      final String enc=charset(ext);
      val=Str.get(URLDecoder.decode(string(in.read()),enc == null ? Strings.UTF8 : enc));
    }
 else     if (isXML(ctype)) {
      val=new DBNode(in);
    }
 else     if (isText(ctype)) {
      val=Str.get(new TextInput(in).content());
    }
 else     if (isMultipart(ctype)) {
      try (final InputStream is=in.inputStream()){
        final HttpPayload hp=new HttpPayload(in.inputStream(),true,null,opts);
        hp.extractParts(concat(DASHES,hp.boundary(ext)),null);
        val=hp.payloads();
      }
     }
  }
  return val == null ? new B64(in.read()) : val;
}
