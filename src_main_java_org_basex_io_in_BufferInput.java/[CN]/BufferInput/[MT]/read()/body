{
  if (pos >= size) {
    if (size > 0 && size < buffer.length) {
      int r=-1;
      while ((r=in.read(buffer,size,buffer.length - size)) <= 0)       if (r < 0)       return -1;
      size+=r;
      read+=r;
    }
 else {
      while ((size=in.read(buffer)) <= 0)       if (size < 0)       return -1;
      pos=0;
      read+=size;
    }
  }
  return buffer[pos++] & 0xFF;
}
