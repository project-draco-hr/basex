{
  if (prim == null) {
    prim=new UpdatePrimitive[]{p};
    return;
  }
  final int typeIndex=index(p.type);
  if (typeIndex != -1) {
    final UpdatePrimitive up=prim[typeIndex];
    if (up instanceof InsertInto) {
      final InsertInto oldprim=(InsertInto)up;
      final InsertInto newprim=(InsertInto)p;
      if (newprim.rec)       prim[typeIndex]=newprim;
      if (!oldprim.rec && !newprim.rec)       up.merge(p);
    }
 else     up.merge(p);
    return;
  }
  addToPrimitives(p);
}
