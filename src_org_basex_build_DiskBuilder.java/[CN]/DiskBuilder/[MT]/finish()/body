{
  close();
  DiskData.write(meta,tags,atts,path,ns);
  final String db=meta.dbname;
  final TableAccess ta=new TableDiskAccess(db,DATATBL);
  final DataInput in=new DataInput(db,DATATMP);
  for (int pre=0; pre < ssize; pre++) {
    final boolean sz=in.readBool();
    final int p=in.readNum();
    if (sz)     ta.write4(p,8,in.readNum());
 else     ta.write5(p,3,in.read5());
  }
  ta.close();
  in.close();
  IO.dbfile(db,DATATMP).delete();
  return new DiskData(db,false);
}
