{
  if (tags.size() > 0xFFFF)   throw new IOException(LIMITTAGS);
  if (atts.size() > 0xFFFF)   throw new IOException(LIMITATTS);
  final String db=meta.dbname;
  tags.finish(db);
  atts.finish(db);
  ns.finish(db);
  skel.finish(db);
  meta.finish(size);
  close();
  final TableAccess ta=new TableDiskAccess(db,DATATBL);
  final DataInput in=new DataInput(db,DATATMP);
  for (int pre=0; pre < ssize; pre++) {
    ta.write4(in.readNum(),8,in.readNum());
  }
  ta.close();
  in.close();
  IO.dbfile(db,DATATMP).delete();
  return new DiskData(db,false);
}
