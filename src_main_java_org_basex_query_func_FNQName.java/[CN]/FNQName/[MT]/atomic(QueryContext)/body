{
  final Item it=expr[0].atomic(ctx);
  final Item it2=expr.length == 2 ? expr[1].atomic(ctx) : null;
switch (func) {
case RESQNAME:
    return it == null ? null : resolve(ctx,it,checkEmpty(it2));
case QNAME:
  final Uri uri=Uri.uri(it == null ? EMPTY : checkType(it,Type.STR).atom());
final Item it3=it2 == null ? Str.ZERO : checkType(it2,Type.STR);
final byte[] str=it3.atom();
if (!XMLToken.isQName(str)) Err.or(input,INVALUE,Type.QNM,it3);
QNm nm=new QNm(str,uri);
if (nm.ns() && uri == Uri.EMPTY) Err.or(input,INVALUE,Type.URI,uri);
return nm;
case LOCNAMEQNAME:
if (it == null) return null;
return new NCN(((QNm)checkType(it,Type.QNM)).ln(),input);
case PREQNAME:
if (it == null) return null;
nm=(QNm)checkType(it,Type.QNM);
return !nm.ns() ? null : new NCN(nm.pref(),input);
case NSURIPRE:
final byte[] pre=checkStrEmp(it);
final Atts at=((Nod)checkType(it2,Type.ELM)).ns();
final int i=at != null ? at.get(pre) : -1;
return i != -1 ? Uri.uri(at.val[i]) : null;
case RESURI:
if (it == null) return null;
final Uri rel=Uri.uri(checkStrEmp(it));
if (!rel.valid()) Err.or(input,URIINV,it);
final Uri base=it2 == null ? ctx.baseURI : Uri.uri(checkStrEmp(it2));
if (!base.valid()) Err.or(input,URIINV,base);
return base.resolve(rel);
default :
return super.atomic(ctx);
}
}
