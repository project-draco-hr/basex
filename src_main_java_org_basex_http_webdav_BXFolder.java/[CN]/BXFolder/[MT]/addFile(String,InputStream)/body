{
  final BufferInput bi=new BufferInput(in,1 << 22);
  try {
    final TextInput ti=new TextInput(bi);
    final boolean xml=ti.read() == '<';
    try {
      ti.reset();
    }
 catch (    final IOException e) {
    }
    if (xml) {
      try {
        addXML(n,bi);
        return;
      }
 catch (      final IOException ex) {
        try {
          bi.reset();
        }
 catch (        final IOException e) {
          throw ex;
        }
      }
    }
    addRaw(n,bi);
  }
  finally {
    bi.close();
  }
}
