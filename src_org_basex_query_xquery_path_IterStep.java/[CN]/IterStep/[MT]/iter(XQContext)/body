{
  return new NodeIter(){
    final Item ci=ctx.item;
    final int cp=ctx.pos;
    boolean more=true;
    NodeIter ir;
    Iter iter;
    @Override public Nod next() throws XQException {
      if (more) {
        if (iter == null) {
          iter=checkCtx(ctx);
          ctx.pos=1;
        }
        Nod temp=null;
        while (true) {
          if (ir == null) {
            final Item i=iter.next();
            if (i == null) {
              ctx.item=ci;
              ctx.pos=cp;
              if (temp != null) {
                more=false;
                return temp;
              }
              return null;
            }
            if (!i.node())             Err.or(NODESPATH,IterStep.this,i.type);
            ir=axis.init((Nod)i);
          }
          final Nod nod=ir.next();
          if (nod != null) {
            if (test.e(nod)) {
              ctx.item=nod;
              final Item i=ctx.iter(pred[0]).ebv();
              final boolean found=i.n() ? i.dbl() == ctx.pos : i.bool();
              ctx.pos++;
              if (found) {
                nod.score(i.score());
                if (num)                 more=false;
                ctx.item=ci;
                return nod.finish();
              }
              if (last)               temp=nod.finish();
            }
          }
 else {
            ir=null;
          }
        }
      }
      return null;
    }
  }
;
}
