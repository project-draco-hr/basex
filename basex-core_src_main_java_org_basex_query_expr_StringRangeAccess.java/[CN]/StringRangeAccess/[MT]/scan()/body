{
  return new IndexIterator(){
    final boolean text=sr.type == IndexType.TEXT;
    final byte kind=text ? Data.TEXT : Data.ATTR;
    int pre=-1;
    @Override public int pre(){
      return pre;
    }
    @Override public boolean more(){
      final Data data=ictx.data;
      while (++pre < data.meta.size) {
        if (data.kind(pre) != kind)         continue;
        final byte[] t=data.text(pre,text);
        final int mn=Token.diff(t,sr.min);
        final int mx=Token.diff(t,sr.max);
        if (mn >= (sr.mni ? 0 : 1) && mx <= (sr.mxi ? 0 : 1))         return true;
      }
      return false;
    }
  }
;
}
