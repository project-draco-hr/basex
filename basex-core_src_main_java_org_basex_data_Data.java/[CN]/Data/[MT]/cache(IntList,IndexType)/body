{
  final TokenObjMap<IntList> map=new TokenObjMap<>();
  final IndexNames in=new IndexNames(type,this);
  final boolean text=type == IndexType.TEXT;
  final int ps=pres.size(), kind=text ? TEXT : ATTR;
  for (int p=0; p < ps; p++) {
    final int pre=pres.get(p);
    if (kind(pre) == kind && in.contains(pre,text)) {
      if (type == IndexType.TOKEN) {
        for (        final byte[] token : distinctTokens(text(pre,text))) {
          addId(map,token,pre);
        }
      }
 else       if (textLen(pre,text) <= meta.maxlen) {
        addId(map,text(pre,text),pre);
      }
    }
  }
  return map;
}
