{
  final TokenObjMap<IntList> map=new TokenObjMap<>();
  final IndexNames in=new IndexNames(type,this);
  final boolean text=type == IndexType.TEXT;
  final int ps=pres.size(), kind=text ? TEXT : ATTR;
  for (int p=0; p < ps; p++) {
    final int pre=pres.get(p);
    if (kind(pre) == kind && textLen(pre,text) <= meta.maxlen && in.contains(this,pre,text)) {
      final byte[] key=text(pre,text);
      IntList ids=map.get(key);
      if (ids == null) {
        ids=new IntList(1);
        map.put(key,ids);
      }
      ids.add(id(pre));
    }
  }
  return map;
}
