{
  IndexArrayIterator it=IndexArrayIterator.EMP;
  final int tl=tok.length;
  final int e=Math.min(tp.length,tl + k);
  int s=Math.max(1,tl - k) - 1;
  while (++s <= e) {
    int p=tp[s];
    if (p == -1)     continue;
    int i=s + 1;
    int r=-1;
    do     r=tp[i++];
 while (r == -1);
    while (p < r) {
      if (ls.similar(ti.readBytes(p,p + s),tok)) {
        it=IndexArrayIterator.union(data(pointer(p,s),size(p,s),dat),it);
      }
      p+=s + ENTRY;
    }
  }
  return it;
}
