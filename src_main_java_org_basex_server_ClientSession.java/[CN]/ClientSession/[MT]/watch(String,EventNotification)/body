{
  try {
    sout.write(10);
    send(name);
    final BufferInput bi=new BufferInput(sin);
    if (esocket == null) {
      String id=bi.readString();
      int eport=new Integer(bi.readString()).intValue();
      this.en=new HashMap<String,EventNotification>();
      esocket=new Socket();
      esocket.connect(new InetSocketAddress(ehost,eport),5000);
      PrintOutput tout=PrintOutput.get(esocket.getOutputStream());
      tout.print(id);
      tout.write(0);
      tout.flush();
      startListener(esocket.getInputStream());
    }
    info=bi.readString();
    if (!ok(bi))     throw new IOException(info);
    en.put(name,notification);
  }
 catch (  IOException e) {
    throw new BaseXException(e);
  }
}
