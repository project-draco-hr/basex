{
  final Context context=gui.context;
  final Nodes n=new Nodes(context.data(),context.marked().ftpos);
  if (!cont[hist].same(quick ? context.current() : context.marked())) {
    if (!quick) {
      final String input=gui.input.getText();
      checkHist();
      queries[hist]=input;
      marked[hist]=context.marked();
      cont[++hist]=nodes;
      queries[hist]=input;
      marked[hist]=n;
      maxhist=hist;
    }
 else {
      checkHist();
      queries[hist]="";
      marked[hist]=new Nodes(context.data());
      cont[++hist]=context.current();
      maxhist=hist;
    }
  }
  init(context,nodes,n);
  for (  final View v : view)   if (v != vw && v.visible())   v.refreshContext(true,quick);
  gui.refreshControls();
}
