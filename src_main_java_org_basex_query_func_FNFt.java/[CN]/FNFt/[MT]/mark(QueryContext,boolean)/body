{
  byte[] m=MARK;
  int l=ex ? 150 : Integer.MAX_VALUE;
  if (expr.length > 1) {
    m=checkStr(expr[1],ctx);
    if (!XMLToken.isQName(m))     Err.value(input,AtomType.QNM,m);
  }
  if (expr.length > 2) {
    l=(int)checkItr(expr[2],ctx);
  }
  final byte[] mark=m;
  final int len=l;
  return new Iter(){
    final FTPosData ftd=new FTPosData();
    ValueIter vi;
    Iter ir;
    @Override public Item next() throws QueryException {
      while (true) {
        if (vi != null) {
          final Item it=vi.next();
          if (it != null)           return it;
          vi=null;
        }
        final FTPosData tmp=ctx.ftpos;
        ctx.ftpos=ftd;
        if (ir == null)         ir=ctx.iter(expr[0]);
        final Item it=ir.next();
        if (it != null) {
          final MemData md=new MemData(ctx.context.prop);
          final DataBuilder db=new DataBuilder(md);
          db.ftpos(mark,ctx.ftpos,len).build(checkDBNode(it));
          final IntList il=new IntList();
          for (int p=0; p < md.meta.size; p+=md.size(p,md.kind(p))) {
            il.add(p);
          }
          vi=DBNodeSeq.get(il,md,false,false).iter();
        }
        ctx.ftpos=tmp;
        if (it == null)         return null;
      }
    }
  }
;
}
