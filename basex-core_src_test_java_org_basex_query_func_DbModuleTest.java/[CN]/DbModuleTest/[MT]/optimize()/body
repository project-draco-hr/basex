{
  query(_DB_OPTIMIZE.args(NAME));
  query(_DB_OPTIMIZE.args(NAME));
  error(_DB_OPTIMIZE.args(NAME,true),UPDBOPTERR_X);
  execute(new Close());
  query(_DB_OPTIMIZE.args(NAME,true));
  final String[] nopt={"maxcats","maxlen","indexsplitsize","ftindexsplitsize"};
  for (  final String k : nopt) {
    query(_DB_OPTIMIZE.args(NAME,false," map { '" + k + "': 1 }"));
  }
  final String[] bopt={"textindex","attrindex","ftindex","stemming","casesens","diacritics"};
  for (  final String k : bopt) {
    for (    final boolean v : new boolean[]{true,false}) {
      query(_DB_OPTIMIZE.args(NAME,false," map { '" + k + "':"+ v+ "() }"));
    }
  }
  final String[] sopt={"language","stopwords"};
  for (  final String k : sopt) {
    query(_DB_OPTIMIZE.args(NAME,false," map { '" + k + "':'' }"));
  }
  assertEquals(context.options.get(MainOptions.TEXTINDEX),true);
  error(_DB_OPTIMIZE.args(NAME,false," map { 'xyz': 'abc' }"),BASX_OPTIONS_X);
  error(_DB_OPTIMIZE.args(NAME,false," map { 'updindex': 1 }"),BASX_OPTIONS_X);
  error(_DB_OPTIMIZE.args(NAME,false," map { 'maxlen': -1 }"),BASX_VALUE_X_X);
  error(_DB_OPTIMIZE.args(NAME,false," map { 'maxlen': 'a' }"),BASX_VALUE_X_X);
  error(_DB_OPTIMIZE.args(NAME,false," map { 'textindex':'nope' }"),BASX_VALUE_X_X);
  query(_DB_OPTIMIZE.args(NAME));
  query(_DB_INFO.args(NAME) + "//textindex/text()","false");
  query(_DB_INFO.args(NAME) + "//attrindex/text()","false");
  query(_DB_INFO.args(NAME) + "//ftindex/text()","false");
  execute(new Open(NAME));
  execute(new CreateIndex(CmdIndex.TEXT));
  execute(new CreateIndex(CmdIndex.ATTRIBUTE));
  execute(new CreateIndex(CmdIndex.FULLTEXT));
  execute(new Close());
  query(_DB_OPTIMIZE.args(NAME));
  query(_DB_INFO.args(NAME) + "//textindex/text()","true");
  query(_DB_INFO.args(NAME) + "//attrindex/text()","true");
  query(_DB_INFO.args(NAME) + "//ftindex/text()","true");
  execute(new Open(NAME));
  execute(new DropIndex(CmdIndex.TEXT));
  execute(new DropIndex(CmdIndex.ATTRIBUTE));
  execute(new DropIndex(CmdIndex.FULLTEXT));
  execute(new Close());
  query(_DB_OPTIMIZE.args(NAME));
  query(_DB_INFO.args(NAME) + "//textindex/text()","false");
  query(_DB_INFO.args(NAME) + "//attrindex/text()","false");
  query(_DB_INFO.args(NAME) + "//ftindex/text()","false");
  query(_DB_OPTIMIZE.args(NAME,true," map { 'textindex':true(),'attrindex':true(),'ftindex':true(),'updindex':true() }"));
  query(_DB_INFO.args(NAME) + "//textindex/text()","true");
  query(_DB_INFO.args(NAME) + "//attrindex/text()","true");
  query(_DB_INFO.args(NAME) + "//ftindex/text()","true");
  query(_DB_INFO.args(NAME) + "//updindex/text()","true");
}
