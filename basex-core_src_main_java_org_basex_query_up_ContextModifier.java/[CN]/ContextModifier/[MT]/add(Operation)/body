{
  if (p instanceof DBBackup) {
    final DBBackup c=(DBBackup)p;
    final DBBackup o=dbBackups.get(c.data);
    if (o != null)     o.merge(c);
    dbBackups.put(c.data,c);
    return;
  }
  if (p instanceof DBCreate) {
    final DBCreate c=(DBCreate)p;
    final DBCreate o=dbCreates.get(c.dbName);
    if (o != null)     o.merge(c);
    dbCreates.put(c.dbName,c);
    return;
  }
  if (p instanceof DBRestore) {
    final DBRestore c=(DBRestore)p;
    final DBRestore o=dbRestores.get(c.backupName);
    if (o != null)     o.merge(c);
    dbRestores.put(c.backupName,c);
    return;
  }
  final Data data=p.getData();
  DatabaseUpdates dbp=pendingUpdates.get(data);
  if (dbp == null) {
    dbp=new DatabaseUpdates(data);
    pendingUpdates.put(data,dbp);
  }
  if (tmp == null)   tmp=new MemData(data.meta.options);
  dbp.add(p,tmp);
}
