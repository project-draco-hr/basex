{
  if (scm == 0)   hash.init();
 else   hash.initIter();
  final DataOutput outb=new DataOutput(data.meta.file(DATAFTX + 'b'));
  while (hash.more()) {
    final int p=hash.next();
    final byte[] tok=hash.key();
    final int ds=hash.ns[p];
    final long cpre=outb.size();
    writeFTData(outb,hash.pre[p],hash.pos[p]);
    index.insertSorted(tok,ds,cpre);
  }
  outb.close();
  hash=null;
  final TokenList tokens=index.tokens;
  final IntArrayList next=index.next;
  final DataOutput outa=new DataOutput(data.meta.file(DATAFTX + 'a'));
  final DataOutput outc=new DataOutput(data.meta.file(DATAFTX + 'c'));
  outa.write1(1);
  outa.write1(-1);
  int j=1;
  final int js=next.get(0).length - 2;
  for (; j < js; j++) {
    final int p=next.get(0)[j];
    outa.write4(p);
    outa.write1(tokens.get(next.get(p)[0])[0]);
  }
  outa.write4(next.get(0)[j]);
  outa.write5(-1);
  outc.write4(0);
  final int siz=(next.get(0).length - 3) * 5 + 11;
  writeSubTree(null,outa,outc,0,siz);
  outa.close();
  outc.close();
}
