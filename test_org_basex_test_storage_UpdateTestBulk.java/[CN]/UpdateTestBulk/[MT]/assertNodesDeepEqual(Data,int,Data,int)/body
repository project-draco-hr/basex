{
  final int kind=data1.kind(pre1);
  assertEquals(kind,data2.kind(pre2));
switch (kind) {
case Data.TEXT:
    assertByteArraysEqual(data1.text(pre1),data2.text(pre2));
  break;
case Data.ATTR:
assertByteArraysEqual(data1.attName(pre1),data2.attName(pre2));
assertByteArraysEqual(data1.attValue(pre1),data2.attValue(pre2));
break;
case Data.ELEM:
assertByteArraysEqual(data1.tag(pre1),data2.tag(pre2));
assertEquals(data1.size(pre1,kind),data2.size(pre2,kind));
final int siz=data1.size(pre1,kind);
int pos=1;
while (pos < siz) {
assertNodesDeepEqual(data1,pre1 + pos,data2,pre2 + pos);
pos+=data1.size(pre1 + pos,data1.kind(pre1 + pos));
}
break;
default :
fail("Unknown nodekind!");
}
}
