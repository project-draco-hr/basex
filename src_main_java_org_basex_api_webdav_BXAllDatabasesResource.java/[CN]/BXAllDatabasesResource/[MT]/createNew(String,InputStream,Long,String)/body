{
  Session s=null;
  try {
    s=factory.login(user,pass);
    final String dbname=dbname(newName);
    s.create(dbname,inputStream);
    s.execute(new Close());
    return new BXDatabase(dbname,factory,user,pass);
  }
 catch (  final Exception ex) {
    handle(ex);
    throw new BadRequestException(this,ex.getMessage());
  }
 finally {
    try {
      if (s != null)       s.close();
    }
 catch (    final IOException e) {
      handle(e);
    }
  }
}
