{
  final Expr[] pragmas=pragma();
  if (pragmas.length != 0) {
    check(BRACE1);
    final FTExpr e=ftSelection(true);
    check(BRACE2);
    return new FTExtensionSelection(input(),pragmas,e);
  }
  if (consumeWS(PAR1)) {
    final FTExpr e=ftSelection(false);
    check(PAR2);
    return e;
  }
  skipWS();
  final Expr e=curr('{') ? enclosed(NOENCLEXPR) : quote(curr()) ? literal() : null;
  if (e == null)   error(prg ? NOPRAGMA : NOENCLEXPR);
  FTMode mode=FTMode.M_ANY;
  if (consumeWS(ALL)) {
    mode=consumeWS(WORDS) ? FTMode.M_ALLWORDS : FTMode.M_ALL;
  }
 else   if (consumeWS(ANY)) {
    mode=consumeWS(WORD) ? FTMode.M_ANYWORD : FTMode.M_ANY;
  }
 else   if (consumeWS(PHRASE)) {
    mode=FTMode.M_PHRASE;
  }
  Expr[] occ=null;
  if (consumeWS(OCCURS)) {
    occ=ftRange();
    if (occ == null)     error(FTRANGE);
    check(TIMES);
  }
  return new FTWords(input(),e,mode,occ);
}
