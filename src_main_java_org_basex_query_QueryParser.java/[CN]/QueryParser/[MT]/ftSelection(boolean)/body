{
  FTExpr expr=ftOr(prg);
  FTExpr old;
  do {
    old=expr;
    if (consumeWS(ORDERED)) {
      expr=new FTOrder(input(),expr);
    }
 else     if (consumeWS(WINDOW)) {
      expr=new FTWindow(input(),expr,additive(),ftUnit());
    }
 else     if (consumeWS(DISTANCE)) {
      final Expr[] r=ftRange();
      if (r == null)       error(FTRANGE);
      expr=new FTDistance(input(),expr,r,ftUnit());
    }
 else     if (consumeWS(AT)) {
      final boolean start=consumeWS(START);
      final boolean end=!start && consumeWS(END);
      if (!start && !end)       error(INCOMPLETE);
      expr=new FTContent(input(),expr,start,end);
    }
 else     if (consumeWS(ENTIRE)) {
      check(CONTENT);
      expr=new FTContent(input(),expr,false,false);
    }
 else {
      final boolean same=consumeWS(SAME);
      final boolean diff=!same && consumeWS(DIFFERENT);
      if (same || diff) {
        FTUnit unit=null;
        if (consumeWS(SENTENCE))         unit=FTUnit.SENTENCE;
 else         if (consumeWS(PARAGRAPH))         unit=FTUnit.PARAGRAPH;
 else         error(INCOMPLETE);
        expr=new FTScope(input(),expr,unit,same);
      }
    }
  }
 while (old != expr);
  return expr;
}
