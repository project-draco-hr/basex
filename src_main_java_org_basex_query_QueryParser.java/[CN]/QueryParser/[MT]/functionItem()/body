{
  skipWS();
  final int pos=ip;
  final Ann ann=ctx.sc.xquery3 && curr('%') ? annotations() : null;
  if (wsConsume(FUNCTION) && wsConsume(PAR1)) {
    final int s=ctx.vars.size();
    final Var[] args=paramList();
    wsCheck(PAR2);
    final SeqType type=optAsType();
    if (ann != null && (ann.contains(Ann.Q_PRIVATE) || ann.contains(Ann.Q_PUBLIC)))     error(INVISIBLE);
    final Expr body=enclosed(NOFUNBODY);
    ctx.vars.size(s);
    return new InlineFunc(info(),type,args,body,ann,ctx);
  }
  if (ann != null)   error(NOANN);
  ip=pos;
  final QNm name=eQName(null,ctx.sc.nsFunc);
  if (name != null && consume('#')) {
    final long card=((Int)numericLiteral(true)).itr();
    if (card < 0 || card > Integer.MAX_VALUE)     error(FUNCUNKNOWN,name);
    return Functions.get(name,card,false,ctx,info());
  }
  ip=pos;
  return null;
}
