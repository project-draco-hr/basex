{
  byte[] ns=EMPTY;
  if (wsConsumeWs(NSPACE)) {
    ns=ncName(XPNAME);
    wsCheck(IS);
  }
  final byte[] uri=stringLiteral();
  if (uri.length == 0)   error(NSMODURI);
  if (modules.contains(uri))   error(DUPLMODULE,uri);
  final QNm name=new QNm(ns,uri);
  if (ns != EMPTY)   ctx.ns.add(name,input());
  try {
    if (wsConsumeWs(AT)) {
      do {
        module(stringLiteral(),name.uri());
      }
 while (wsConsumeWs(COMMA));
    }
 else {
      final TokenSet pkgs=ctx.context.repo.nsDict().get(uri);
      if (pkgs != null) {
        for (        final byte[] pkg : pkgs) {
          if (pkg != null)           loadPackage(pkg,new TokenSet(),new TokenSet());
        }
      }
 else {
        boolean found=false;
        for (        final byte[] u : MODULES)         found|=eq(uri,u);
        for (        final byte[] path : ctx.modDeclared) {
          if (eq(ctx.modDeclared.get(path),uri)) {
            module(path,name.uri());
            found=true;
          }
        }
        if (!found)         error(NOMODULE,uri);
      }
    }
  }
 catch (  final StackOverflowError ex) {
    error(CIRCMODULE);
  }
}
