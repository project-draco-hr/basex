{
  final Context ctx=gui.context;
  final Data data=ctx.data;
  final boolean db=data != null;
  if (db) {
    cont[0]=ctx.current;
    marked[0]=new Nodes(data);
    final long fs=data.meta.dbsize();
    boolean close=false;
    for (    final View v : view)     close|=v.visible() && v.db();
    if (close && fs > LARGEDB && Dialog.confirm(gui,Util.info(OPENLARGE,Performance.format(fs)))) {
      for (      final View v : view)       if (v.visible() && v.db())       v.visible(false);
    }
  }
 else {
    for (    final Window w : gui.getOwnedWindows()) {
      if (w.isVisible() && w instanceof Dialog && !(w instanceof DialogHelp))       ((Dialog)w).cancel();
    }
  }
  gui.context.focused=-1;
  hist=0;
  maxhist=0;
  for (  final View v : view)   v.refreshInit();
  gui.layoutViews();
  gui.setTitle(Text.TITLE + (db ? " - " + data.meta.name : ""));
}
