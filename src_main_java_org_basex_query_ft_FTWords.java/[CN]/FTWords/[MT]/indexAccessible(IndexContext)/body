{
  final MetaData md=ic.data.meta;
  final FTOpt fto=ftt.opt;
  final boolean wc=fto.is(WC);
  if (wc && !md.wildcards)   return false;
  if (fto.isSet(CS) && md.casesens != fto.is(CS) || fto.isSet(DC) && md.diacritics != fto.is(DC) || fto.isSet(ST) && md.stemming != fto.is(ST) || fto.ln != null && md.language != fto.ln || occ != null)   return false;
  if (txt == null) {
    ic.costs(Math.max(1,ic.data.meta.size / 20));
    return true;
  }
  fto.set(CS,md.casesens);
  fto.set(DC,md.diacritics);
  fto.set(ST,md.stemming);
  fto.ln=md.language;
  final FTLexer ft=new FTLexer(fto);
  ic.costs(0);
  for (  byte[] t : txt) {
    ft.init(t);
    while (ft.hasNext()) {
      final byte[] tok=ft.nextToken();
      if (fto.sw != null && fto.sw.id(tok) != 0)       continue;
      if (wc) {
        t=ft.get();
        if (t[0] == '.')         return false;
        int d=0;
        for (        final byte w : t) {
          if (w == '{' || w == '\\' || w == '.' && ++d > 1)           return false;
        }
      }
      ic.addCosts(Math.max(1,ic.data.nrIDs(ft) >> 2));
    }
  }
  return true;
}
