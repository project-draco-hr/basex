{
  final Key key=new SecretKeySpec(k,string(a));
  byte[] hash=null;
  final byte[] aa=a.length == 0 ? DEFA : a;
  if (!ALGHMAC.contains(lc(aa)))   CRYPTOINVHASH.thrw(info,aa);
  final boolean b64=eq(lc(enc),BASE64) || enc.length == 0;
  if (!b64 && !eq(lc(enc),HEX))   CRYPTOENC.thrw(info,enc);
  try {
    final Mac mac=Mac.getInstance(string(ALGHMAC.get(lc(aa))));
    mac.init(key);
    hash=mac.doFinal(msg);
  }
 catch (  final NoSuchAlgorithmException e) {
    CRYPTOINVHASH.thrw(info,e);
  }
catch (  final InvalidKeyException e) {
    CRYPTOKEYINV.thrw(info,e);
  }
  return Str.get(b64 ? Base64.encode(hash) : hex(hash,true));
}
