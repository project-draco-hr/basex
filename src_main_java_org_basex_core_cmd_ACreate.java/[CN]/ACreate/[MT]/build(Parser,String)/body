{
  new Close().run(context);
  try {
    final boolean mem=prop.is(Prop.MAINMEM);
    if (!mem && context.pinned(db))     return error(DBLOCKED,db);
    builder=mem ? new MemBuilder(p,prop) : new DiskBuilder(p,prop);
    progress(builder);
    final Data d=builder.build(db);
    if (mem) {
      context.openDB(d);
    }
 else {
      d.close();
      final Open cmd=new Open(db);
      if (!cmd.run(context))       return error(cmd.info());
      index(context.data);
    }
    return info(DBCREATED,db,perf);
  }
 catch (  final ProgressException ex) {
    throw ex;
  }
catch (  final Exception ex) {
    Main.debug(ex);
    abort();
    final String msg=ex instanceof IOException ? ex.getMessage() : Main.info(PARSEERR,p.file);
    return error(msg != null ? msg : args[0]);
  }
}
