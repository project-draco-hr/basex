{
  if (data.inMemory())   return;
  final IndexBuilder ib;
switch (index) {
case TEXT:
    ib=new ValueIndexBuilder(data,true);
  break;
case ATTRIBUTE:
ib=new ValueIndexBuilder(data,false);
break;
case FULLTEXT:
ib=new FTBuilder(data);
break;
default :
throw Util.notexpected();
}
data.closeIndex(index);
data.setIndex(index,(cmd == null ? ib : cmd.progress(ib)).build());
}
