{
  if (data instanceof MemData)   return;
  IndexBuilder ib;
switch (index) {
case TEXT:
    ib=new ValueBuilder(data,true);
  break;
case ATTRIBUTE:
ib=new ValueBuilder(data,false);
break;
case FULLTEXT:
ib=FTBuilder.get(data);
break;
case PATH:
ib=new PathBuilder(data);
break;
default :
throw Util.notexpected();
}
data.closeIndex(index);
data.setIndex(index,(cmd == null ? ib : cmd.progress(ib)).build());
}
