{
  if (data instanceof MemData)   return;
  IndexBuilder ib=null;
switch (type) {
case TEXT:
    ib=new ValueBuilder(data,true);
  break;
case ATTRIBUTE:
ib=new ValueBuilder(data,false);
break;
case FULLTEXT:
ib=FTBuilder.get(data);
break;
case PATH:
ib=new PathBuilder(data);
break;
default :
throw Util.notexpected();
}
data.closeIndex(type);
data.meta.dirty=true;
data.setIndex(type,progress(ib).build());
}
