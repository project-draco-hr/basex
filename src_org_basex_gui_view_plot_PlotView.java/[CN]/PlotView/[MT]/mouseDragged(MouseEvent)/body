{
  if (working || painting || e.isShiftDown())   return;
  if (dragging) {
    mouseX=e.getX();
    mouseY=e.getY();
  }
  final int h=getHeight();
  final int w=getWidth();
  final int th=14;
  final int lb=MARGIN[1] - th;
  final int rb=w - MARGIN[3] + th;
  final int tb=MARGIN[0] - th;
  final int bb=h - MARGIN[2] + th;
  boolean inBox=mouseY > tb && mouseY < bb && mouseX > lb && mouseX < rb;
  if (!dragging && !inBox)   return;
  if (!dragging) {
    dragging=true;
    selectionBox.setStart(mouseX,mouseY);
  }
  drawSubNodes=false;
  if (!inBox) {
    if (mouseX < lb) {
      if (mouseY > bb) {
        selectionBox.setEnd(lb,bb);
      }
 else       if (mouseY < tb) {
        selectionBox.setEnd(lb,tb);
      }
 else {
        selectionBox.setEnd(lb,mouseY);
      }
    }
 else     if (mouseX > rb) {
      if (mouseY > bb) {
        selectionBox.setEnd(rb,bb);
      }
 else       if (mouseY < tb) {
        selectionBox.setEnd(rb,tb);
      }
 else {
        selectionBox.setEnd(rb,mouseY);
      }
    }
 else     if (mouseY < tb) {
      selectionBox.setEnd(mouseX,tb);
    }
 else     selectionBox.setEnd(mouseX,bb);
  }
 else {
    selectionBox.setEnd(mouseX,mouseY);
  }
  IntList il=new IntList();
  for (int i=0; i < plotData.size; i++) {
    final int x=calcCoordinate(true,plotData.xAxis.co[i]);
    final int y=calcCoordinate(false,plotData.yAxis.co[i]);
    if (((x >= selectionBox.x1 && x <= selectionBox.x2) || (x <= selectionBox.x1 && x >= selectionBox.x2)) && ((y >= selectionBox.y1 && y <= selectionBox.y2) || (y <= selectionBox.y1 && y >= selectionBox.y2))) {
      il.add(plotData.pres[i]);
    }
  }
  notifyMark(new Nodes(il.finish(),GUI.context.data()),this);
  markingChanged=true;
  repaint();
}
