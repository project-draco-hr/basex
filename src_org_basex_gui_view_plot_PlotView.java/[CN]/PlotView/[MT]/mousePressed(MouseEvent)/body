{
  if (working || painting)   return;
  mouseX=e.getX();
  mouseY=e.getY();
  focus();
  if (focused == -1) {
    Nodes n=new Nodes(GUI.context.data());
    notifyMark(n,this);
    tmpMarked.reset();
    return;
  }
  final int pre=plotData.findPre(focused);
  if (pre < 0)   return;
  final boolean left=SwingUtilities.isLeftMouseButton(e);
  final IntList il=new IntList();
  if (left && !e.isShiftDown())   tmpMarked.reset();
  final int mx=calcCoordinate(true,plotData.xAxis.co[pre]);
  final int my=calcCoordinate(false,plotData.yAxis.co[pre]);
  for (int i=0; i < plotData.size; i++) {
    final int x=calcCoordinate(true,plotData.xAxis.co[i]);
    final int y=calcCoordinate(false,plotData.yAxis.co[i]);
    if (mx == x && my == y) {
      il.add(plotData.pres[i]);
      tmpMarked.add(i);
    }
  }
  if (SwingUtilities.isRightMouseButton(e))   drawMarkedContext=false;
  if (e.isShiftDown()) {
    final Nodes marked=GUI.context.marked();
    marked.union(il.finish());
    notifyMark(marked,this);
  }
 else   if (e.getClickCount() == 2) {
    final Nodes marked=new Nodes(GUI.context.data());
    marked.union(il.finish());
    notifyContext(marked,false,null);
  }
 else {
    final Nodes marked=new Nodes(GUI.context.data());
    marked.union(il.finish());
    notifyMark(marked,this);
  }
}
