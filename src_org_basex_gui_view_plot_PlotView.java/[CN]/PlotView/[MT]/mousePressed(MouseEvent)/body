{
  if (working || painting)   return;
  if (SwingUtilities.isRightMouseButton(e)) {
    rightClick=true;
    return;
  }
  if (rightClick)   markingChanged=true;
  mouseX=e.getX();
  mouseY=e.getY();
  focus();
  if (focused == -1) {
    notifyMark(new Nodes(GUI.context.data()),this);
    markingChanged=true;
    return;
  }
  final int pre=plotData.findPre(focused);
  if (pre < 0)   return;
  markingChanged=true;
  final int[] il=getOverlappingNodes(pre);
  if (e.isShiftDown()) {
    final Nodes marked=GUI.context.marked();
    marked.union(il);
    notifyMark(marked,this);
  }
 else   if (e.getClickCount() == 2) {
    final Nodes marked=new Nodes(GUI.context.data());
    marked.union(il);
    notifyContext(marked,false,null);
  }
 else {
    final Nodes marked=new Nodes(GUI.context.data());
    marked.union(il);
    notifyMark(marked,this);
  }
}
