{
  DataInput in=null;
  try {
    in=new DataInput(pr.dbfile(db,DATAINFO));
    meta=new MetaData(db,in,pr);
    while (true) {
      final String k=in.readString();
      if (k.length() == 0)       break;
      if (k.equals(DBTAGS))       tags=new Names(in);
 else       if (k.equals(DBATTS))       atts=new Names(in);
 else       if (k.equals(DBPATH))       path=new PathSummary(in);
 else       if (k.equals(DBNS))       ns=new Namespaces(in);
    }
    init();
    if (meta.txtindex)     txtindex=new Values(this,true);
    if (meta.atvindex)     atvindex=new Values(this,false);
    if (meta.ftxindex)     ftxindex=meta.ftfz ? new FTFuzzy(this) : new FTTrie(this);
  }
 catch (  final IOException ex) {
    throw ex;
  }
 finally {
    if (in != null)     try {
      in.close();
    }
 catch (    final IOException ex) {
    }
  }
}
