{
  final TokenMap attrs=getAttrs(body);
  final StringBuilder sb=new StringBuilder();
  byte[] mediaType=attrs.get(MEDIATYPE);
  String src=null;
  String method=null;
  for (int i=0; i < attrs.size(); i++) {
    byte[] key=attrs.keys()[i];
    if (eq(key,MEDIATYPE))     mediaType=attrs.get(key);
 else     if (eq(key,SRC))     src=string(attrs.get(key));
 else     if (eq(key,METHOD))     method=string(attrs.get(key));
    sb.append(string(key)).append("=").append(string(attrs.get(key)));
  }
  if (src == null) {
    if (sb.length() != 0)     sb.append(',');
    sb.append("method=");
    if (method == null) {
      if (eq(mediaType,APPL_XHTML))       sb.append(M_XHTML);
 else       if (eq(mediaType,APPL_XML) || eq(mediaType,APPL_EXT_XML) || eq(mediaType,TXT_XML)|| eq(mediaType,TXT_EXT_XML)|| endsWith(mediaType,MIME_XML_SUFFIX))       sb.append(M_XML);
 else       if (eq(mediaType,TXT_HTML))       sb.append(M_HTML);
 else       if (startsWith(mediaType,MIME_TEXT_PREFIX))       sb.append(M_TEXT);
 else       sb.append(M_XML);
    }
 else {
      sb.append(method);
    }
    final SerializerProp serialProp=new SerializerProp(sb.toString());
    final XMLSerializer xml=new XMLSerializer(out,serialProp);
    try {
      final AxisIter ai=body.children();
      ANode child=null;
      while ((child=ai.next()) != null)       child.serialize(xml);
    }
  finally {
      xml.cls();
    }
  }
 else {
  }
}
