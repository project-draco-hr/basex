{
  final NodeIter attrs=body.attr();
  final StringBuilder sb=new StringBuilder();
  byte[] mediaType=null;
  String src=null;
  String method=null;
  Nod attr=null;
  while ((attr=attrs.next()) != null) {
    if (eq(attr.nname(),MEDIATYPE))     mediaType=attr.atom();
 else     if (eq(attr.nname(),SRC))     src=string(attr.atom());
 else     if (eq(attr.nname(),METHOD))     method=string(attr.atom());
 else     sb.append(string(attr.nname())).append('=').append(string(attr.atom()));
  }
  conn.setRequestProperty(CONT_TYPE,string(mediaType));
  if (src == null) {
    if (method == null) {
      if (eq(mediaType,APPL_XHTML))       sb.append("method=xhtml");
 else       if (eq(mediaType,APPL_XML) || eq(mediaType,APPL_EXT_XML) || eq(mediaType,TXT_XML)|| eq(mediaType,TXT_EXT_XML)|| endsWith(mediaType,MIME_XML_SUFFIX))       sb.append("method=xml");
 else       if (eq(mediaType,TXT_HTML))       sb.append("method=html");
 else       if (startsWith(mediaType,MIME_TEXT_PREFIX))       sb.append("method=text");
 else       sb.append("method=xml");
    }
 else {
      sb.append("method=").append(method);
    }
    final OutputStream out=conn.getOutputStream();
    final SerializerProp serialProp=new SerializerProp(sb.toString());
    try {
      final XMLSerializer xml=new XMLSerializer(out,serialProp);
      final NodeIter children=body.child();
      Nod child=null;
      while ((child=children.next()) != null)       child.serialize(xml);
    }
  finally {
      out.close();
    }
  }
 else {
  }
}
