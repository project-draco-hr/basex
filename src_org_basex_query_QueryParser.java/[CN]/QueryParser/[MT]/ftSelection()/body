{
  final FTExpr e=ftOr();
  final FTPos pos=new FTPos();
  final FTSelect sel=new FTSelect(e,pos);
  while (true) {
    if (consumeWS(ORDERED)) {
      pos.ordered=true;
    }
 else     if (consumeWS(WINDOW)) {
      sel.window=additive();
      pos.wunit=ftUnit();
    }
 else     if (consumeWS(DISTANCE)) {
      sel.dist=ftRange();
      if (sel.dist == null)       Err.or(FTRANGE);
      pos.dunit=ftUnit();
    }
 else     if (consumeWS(AT)) {
      pos.start=consumeWS(START);
      if (!pos.start)       pos.end=consumeWS(END);
      if (!pos.start && !pos.end)       Err.or(INCOMPLETE);
    }
 else     if (consumeWS(ENTIRE)) {
      check(CONTENT);
      pos.content=true;
    }
 else {
      final boolean same=consumeWS(SAME);
      final boolean diff=!same && consumeWS(DIFFERENT);
      if (!same && !diff)       break;
      pos.same=same;
      pos.different=diff;
      if (consumeWS(SENTENCE))       pos.sdunit=FTUnit.SENTENCES;
 else       if (consumeWS(PARAGRAPH))       pos.sdunit=FTUnit.PARAGRAPHS;
 else       Err.or(INCOMPLETE);
    }
  }
  sel.weight=consumeWS(WEIGHT) ? range() : Dbl.ONE;
  return sel;
}
