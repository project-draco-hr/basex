{
  long value;
  if (o instanceof Integer)   value=(Integer)o;
 else   if (o instanceof Double)   value=((Double)o).longValue();
 else   if (o instanceof Long)   value=(Long)o;
 else   if (o instanceof Short)   value=(Short)o;
 else   if (o instanceof Byte)   value=(Byte)o;
 else   if (o instanceof Float)   value=((Float)o).longValue();
 else   if (o instanceof String) {
    final byte[] a=Token.token((String)o);
    int i=0;
    final int len=a.length;
    while (i < len && a[i] >= '0' && a[i] <= '9')     i++;
    value=Token.toLong(a,0,i);
    if (value == Long.MIN_VALUE) {
      Main.debug("SpotlightExtractor: invalid value for int field: %",(String)o);
      return null;
    }
  }
 else {
    Main.debug("SpotlightExtractor: unsupported data type: %",o.getClass().getName());
    return null;
  }
  return value;
}
