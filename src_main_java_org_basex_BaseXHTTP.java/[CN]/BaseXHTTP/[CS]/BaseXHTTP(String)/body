{
  parseArguments(args);
  final String webapp=context.mprop.get(MainProp.WEBPATH);
  final WebAppContext wac=new WebAppContext(webapp,"/");
  jetty=(Server)new XmlConfiguration(initJetty(webapp).inputStream()).configure();
  jetty.setHandler(wac);
  for (  final Connector c : jetty.getConnectors()) {
    if (c instanceof SelectChannelConnector) {
      if (httpPort == 0)       httpPort=c.getPort();
 else       c.setPort(httpPort);
    }
  }
  if (stopPort == 0)   stopPort=httpPort - 1;
  if (stopped) {
    stop();
    Util.outln(HTTP + ' ' + SRV_STOPPED);
    Performance.sleep(1000);
    return;
  }
  if (service) {
    start(httpPort,args);
    Util.outln(HTTP + ' ' + SRV_STARTED);
    Performance.sleep(1000);
    return;
  }
  if (!Prop.getSystem(HTTPProp.USER).isEmpty()) {
    while (Prop.getSystem(HTTPProp.PASSWORD).isEmpty()) {
      Util.out(PASSWORD + COLS);
      Prop.setSystem(HTTPProp.PASSWORD,Util.password());
    }
  }
  jetty.start();
  Util.outln(HTTP + ' ' + SRV_STARTED,SERVERMODE);
  HTTPContext.init(wac.getServletContext());
  new StopServer(context.mprop.get(MainProp.SERVERHOST)).start();
  Runtime.getRuntime().addShutdownHook(new Thread(){
    @Override public void run(){
      Util.outln(HTTP + ' ' + SRV_STOPPED);
      final Log l=context.log;
      if (l != null)       l.writeServer(OK,HTTP + ' ' + SRV_STOPPED);
      context.close();
    }
  }
);
  context.log.writeServer(OK,HTTP + ' ' + SRV_STARTED);
}
