{
  final Data data=GUI.context.data();
  if (data == null)   return;
  super.paintComponent(g);
  BaseXLayout.antiAlias(g);
  final int w=getWidth();
  final int h=getHeight();
  final int novalue=noValueSize();
  final int minSize=novalue * 8;
  if (w < minSize || h < minSize) {
    g.setFont(GUIConstants.font);
    g.setColor(Color.black);
    BaseXLayout.drawCenter(g,NOSPACE,getWidth(),h / 2);
    return;
  }
  if (scatterData == null) {
    refreshInit();
    return;
  }
  if (w + h != viewDimension) {
    viewDimension=w + h;
    plotChanged=true;
  }
  plotWidth=w - (MARGIN[1] + MARGIN[3]);
  plotHeight=h - (MARGIN[0] + MARGIN[2]);
  g.setColor(GUIConstants.back);
  g.fillRect(MARGIN[1] + novalue,MARGIN[0],plotWidth - novalue,plotHeight - novalue);
  drawAxis(g,true);
  drawAxis(g,false);
  if (scatterData.size == 0)   return;
  if (plotImg == null || plotChanged)   plotImg=createPlotImage();
  g.drawImage(plotImg,0,0,this);
  final Nodes marked=GUI.context.marked();
  if (marked.size() > 0) {
    for (int i=0; i < marked.size(); i++) {
      final int prePos=scatterData.findPre(marked.nodes[i]);
      if (prePos > -1)       drawItem(g,scatterData.xAxis.co[prePos],scatterData.yAxis.co[prePos],false,true);
    }
  }
  final int f=scatterData.findPre(focused);
  if (f > -1) {
    if (!dragging) {
      final double x1=scatterData.xAxis.co[f];
      final double y1=scatterData.yAxis.co[f];
      drawItem(g,x1,y1,true,false);
      g.setFont(GUIConstants.font);
      String x="";
      byte[] tVal=scatterData.xAxis.getValue(focused);
      Kind numType=scatterData.xAxis.numType;
      if (tVal.length > 0)       x=!(numType == Kind.TEXT || numType == Kind.CAT) ? formatString(toDouble(scatterData.xAxis.getValue(focused)),true) : string(scatterData.xAxis.getValue(focused));
      String y="";
      tVal=scatterData.yAxis.getValue(focused);
      numType=scatterData.yAxis.numType;
      if (tVal.length > 0)       y=!(numType == Kind.TEXT || numType == Kind.CAT) ? formatString(toDouble(scatterData.yAxis.getValue(focused)),false) : string(scatterData.yAxis.getValue(focused));
      final String label=(x.length() > 16 ? x.substring(0,16) : x) + " / " + (y.length() > 15 ? y.substring(0,15) : y);
      final int tw=BaseXLayout.width(g,label);
      final int th=g.getFontMetrics().getHeight();
      final int xx=Math.min(getWidth() - tw - 8,calcCoordinate(true,x1));
      g.setColor(GUIConstants.COLORS[10]);
      g.fillRect(xx - 1,calcCoordinate(false,y1) - th,tw + 4,th);
      g.setColor(GUIConstants.color1);
      g.drawString(label,xx,calcCoordinate(false,y1) - 4);
    }
  }
  if (dragging) {
    g.setColor(GUIConstants.back);
    final int selW=selectionBox.getWidth();
    final int selH=selectionBox.getHeight();
    final int x1=selectionBox.x1;
    final int y1=selectionBox.y1;
    g.fillRect(selW > 0 ? x1 : x1 + selW,selH > 0 ? y1 : y1 + selH,Math.abs(selW),Math.abs(selH));
    g.setColor(GUIConstants.frame);
    g.drawRect(selW > 0 ? x1 : x1 + selW,selH > 0 ? y1 : y1 + selH,Math.abs(selW),Math.abs(selH));
  }
  plotChanged=false;
}
