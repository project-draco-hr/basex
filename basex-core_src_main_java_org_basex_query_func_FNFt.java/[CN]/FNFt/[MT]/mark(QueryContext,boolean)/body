{
  byte[] m=MARK;
  int l=ex ? 150 : Integer.MAX_VALUE;
  if (exprs.length > 1) {
    m=checkStr(exprs[1],ctx);
    if (!XMLToken.isQName(m))     throw valueError(info,AtomType.QNM,m);
  }
  if (exprs.length > 2) {
    l=(int)checkItr(exprs[2],ctx);
  }
  final byte[] mark=m;
  final int len=l;
  return new Iter(){
    final FTPosData ftd=new FTPosData();
    Iter ir;
    ValueIter vi;
    @Override public Item next() throws QueryException {
      while (true) {
        if (vi != null) {
          final Item it=vi.next();
          if (it != null)           return it;
          vi=null;
        }
        final FTPosData tmp=ctx.ftPosData;
        try {
          ctx.ftPosData=ftd;
          if (ir == null)           ir=ctx.iter(exprs[0]);
          final Item it=ir.next();
          if (it == null)           return null;
          final MemData md=new MemData(ctx.context.options);
          final DataBuilder db=new DataBuilder(md);
          db.ftpos(mark,ctx.ftPosData,len).build(checkDBNode(it));
          final IntList il=new IntList();
          for (int p=0; p < md.meta.size; p+=md.size(p,md.kind(p)))           il.add(p);
          vi=DBNodeSeq.get(il,md,false,false).iter();
        }
  finally {
          ctx.ftPosData=tmp;
        }
      }
    }
  }
;
}
