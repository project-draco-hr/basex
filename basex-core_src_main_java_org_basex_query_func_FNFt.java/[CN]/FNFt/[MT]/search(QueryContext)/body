{
  final Data data=checkData(ctx);
  final Value terms=ctx.value(expr[1]);
  final FTOptions opts=checkOptions(2,Q_OPTIONS,new FTOptions(),ctx);
  final IndexContext ic=new IndexContext(data,false);
  if (!data.meta.ftxtindex)   BXDB_INDEX.thrw(info,data.meta.name,IndexType.FULLTEXT.toString().toLowerCase(Locale.ENGLISH));
  final FTOpt opt=new FTOpt().copy(data.meta);
  final FTMode mode=opts.get(FTIndexOptions.MODE);
  opt.set(FZ,opts.get(FTIndexOptions.FUZZY));
  opt.set(WC,opts.get(FTIndexOptions.WILDCARDS));
  if (opt.is(FZ) && opt.is(WC))   BXFT_MATCH.thrw(info,this);
  final FTOpt tmp=ctx.ftOpt();
  ctx.ftOpt(opt);
  final FTExpr fte=new FTWords(info,ic,terms,mode).compile(ctx,null);
  ctx.ftOpt(tmp);
  return new FTIndexAccess(info,options(fte,opts),ic).iter(ctx);
}
