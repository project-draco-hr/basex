{
  final InputInfo info=fun.info;
  final IndexContext ic=new IndexContext(data,false);
  if (!data.meta.ftxtindex)   BXDB_INDEX.thrw(info,data.meta.name,IndexType.FULLTEXT.toString().toLowerCase(Locale.ENGLISH));
  final FTOpt tmp=ctx.ftOpt();
  final FTOpt opt=new FTOpt().copy(data.meta);
  FTMode mode=FTMode.ANY;
  if (opts != null) {
    opt.set(FZ,opts.get(FTOptions.FUZZY));
    opt.set(WC,opts.get(FTOptions.WILDCARDS));
    mode=opts.get(FTOptions.MODE);
  }
  ctx.ftOpt(opt);
  FTExpr expr=new FTWords(info,ic,terms,mode,ctx);
  ctx.ftOpt(tmp);
  if (opts != null && opts.contains(FTOptions.DISTANCE)) {
    final FTDistanceOptions ftdo=opts.get(FTOptions.DISTANCE);
    final int min=ftdo.get(FTDistanceOptions.MIN);
    final int max=ftdo.get(FTDistanceOptions.MAX);
    expr=new FTDistance(info,expr,Int.get(min),Int.get(max),ftdo.get(FTDistanceOptions.UNIT));
  }
  return new FTIndexAccess(info,expr,ic).iter(ctx);
}
