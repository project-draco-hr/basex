{
  if (spos[0].isEmpty()) {
    if (select)     noSelect();
    return -1;
  }
  int s=spos[0].sortedIndexOf(pc);
switch (dir) {
case CURRENT:
    s=s < 0 ? -s - 1 : s;
  break;
case FORWARD:
s=s < 0 ? -s - 1 : s + 1;
break;
case BACKWARD:
s=s < 0 ? -s - 2 : s - 1;
break;
}
final int sl=spos[0].size();
if (s < 0) s=sl - 1;
 else if (s == sl) s=0;
final int pos=spos[0].get(s);
if (select) {
pc=pos;
ms=pos;
me=spos[1].get(s);
}
 else {
pc=pos;
}
return pos;
}
