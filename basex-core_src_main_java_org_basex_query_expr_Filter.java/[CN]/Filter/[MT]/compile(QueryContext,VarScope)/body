{
  final Value cv=qc.value;
  try {
    root=root.compile(qc,scp);
    if (root.isEmpty())     return optPre(qc);
    if (root instanceof AxisPath && !super.has(Flag.FCS))     return ((Path)root.copy(qc,scp)).addPreds(qc,scp,preds).compile(qc,scp);
    qc.value=null;
    final Expr e=super.compile(qc,scp);
    if (e != this)     return e;
    return preds.length == 0 ? root : opt(qc);
  }
  finally {
    qc.value=cv;
  }
}
