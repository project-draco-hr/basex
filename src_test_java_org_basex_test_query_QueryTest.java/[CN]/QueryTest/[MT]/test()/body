{
  final String file=doc.replaceAll("\\\"","\\\\\"");
  final String name=Util.name(this);
  final boolean up=this instanceof XQUPTest;
  new CreateDB(name,file).execute(context);
  final StringBuilder sb=new StringBuilder();
  int fail=0;
  for (  final Object[] qu : queries) {
    final String title=(String)qu[0];
    if (up && title.startsWith("xxx")) {
      new CreateDB(name,file).execute(context);
    }
    final boolean correct=qu.length == 3;
    final String query=qu[correct ? 2 : 1].toString();
    final Command c=new XQuery(query);
    try {
      c.execute(context);
      final Result val=c.result();
      final Result cmp=correct ? (Result)qu[1] : null;
      if (val instanceof Nodes && cmp instanceof Nodes) {
        ((Nodes)cmp).data=((Nodes)val).data;
      }
      if (!correct || !val.sameAs(cmp)) {
        final String cp=!(cmp instanceof Nodes) || ((Nodes)cmp).data != null ? cmp.toString() : "--";
        sb.append("-- " + qu[0] + ": "+ query+ "\n[E] "+ (correct ? cp : "error")+ "\n[F] "+ val+ " "+ details()+ "\n");
        ++fail;
      }
    }
 catch (    final BaseXException ex) {
      if (correct) {
        sb.append("-- " + qu[0] + ": "+ query+ "\n[E] "+ qu[1]+ "\n[F] "+ ex.getMessage()+ " "+ details()+ "\n");
        ++fail;
      }
    }
  }
  if (fail != 0)   fail(fail + " wrong queries; [E] expected, [F] found:\n" + sb.toString().trim());
}
