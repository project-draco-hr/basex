{
  try {
    final Session s=factory.login(user,pass);
    try {
      if (target instanceof BXAllDatabasesResource) {
        createDb(s,name);
        delete(s);
      }
 else       if (target instanceof BXDatabase) {
        final BXDatabase trg=(BXDatabase)target;
        if (trg.db.equals(db)) {
          s.execute(new Open(db));
          s.execute(new Rename(path,name));
        }
 else {
          add(s,trg.db,name);
          delete(s);
        }
      }
 else       if (target instanceof BXFolder) {
        final BXFolder trg=(BXFolder)target;
        if (trg.db.equals(db)) {
          s.execute(new Open(db));
          s.execute(new Rename(path,trg.path + SEP + name));
        }
 else {
          add(s,trg.db,name,trg.path);
          deleteDummy(s,trg.db,trg.path);
          delete(s);
        }
      }
    }
  finally {
      s.close();
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
