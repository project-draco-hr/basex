{
  return new Iter(){
    final Item c=ctx.item;
    final int cs=ctx.size;
    final int cp=ctx.pos;
    boolean firstTime=true;
    Iter iter;
    int stepCount=0;
    Item it;
    @Override public Item next() throws QueryException {
      while (true) {
        if (firstTime) {
          it=root != null ? ctx.iter(root).finish() : ctx.item;
          ctx.item=it;
          firstTime=false;
        }
        if (iter == null) {
          iter=ctx.iter(step[stepCount]);
          ctx.size=it.size();
          ctx.pos=1;
        }
        final Item i=iter.next();
        if (i == null) {
          if (stepCount == step.length - 1) {
            ctx.item=c;
            ctx.size=cs;
            ctx.pos=cp;
            return null;
          }
          stepCount++;
          iter=null;
        }
 else {
          if (!i.node())           Err.or(NODESPATH,this,i.type);
          ctx.item=i;
          ctx.pos++;
          return i;
        }
      }
    }
  }
;
}
