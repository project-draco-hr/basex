{
  final MetaData meta=data.meta;
  final MainOptions opts=meta.options;
  nprops.put(MainOptions.TEXTINDEX,meta.createtext);
  nprops.put(MainOptions.ATTRINDEX,meta.createattr);
  nprops.put(MainOptions.FTINDEX,meta.createftxt);
  initOptions();
  assignOptions();
  final boolean rebuild=opts.number(MainOptions.MAXCATS) != meta.maxcats || opts.number(MainOptions.MAXLEN) != meta.maxlen;
  meta.maxcats=opts.number(MainOptions.MAXCATS);
  meta.maxlen=opts.number(MainOptions.MAXLEN);
  meta.createtext=opts.bool(MainOptions.TEXTINDEX);
  meta.createattr=opts.bool(MainOptions.ATTRINDEX);
  meta.createftxt=opts.bool(MainOptions.FTINDEX);
  try {
    if (all)     OptimizeAll.optimizeAll(data,qc.context,null);
 else     Optimize.optimize(data,rebuild,null);
  }
 catch (  final IOException ex) {
    UPDBOPTERR.thrw(info,ex);
  }
 finally {
    resetOptions();
  }
  if (all)   qc.resource.removeData(data.meta.name);
}
