{
  Long value=null;
  final Entry<Integer,LinkedList<Long>> ps=free.ceilingEntry(size);
  if (ps != null) {
    final int sz=ps.getKey();
    final LinkedList<Long> ll=ps.getValue();
    value=ll.pop();
    if (ll.isEmpty())     free.remove(sz);
    if (sz != size)     add(size - sz,value + sz);
  }
  return value == null ? offset : value;
}
