{
  final XQuery query=new XQuery("\n" + "for sliding window $w in ./stream/event\n" + "  start  $s_curr when fn:true()\n"+ "  only end next $next when $next/@time > $s_curr/@time + 3\n"+ "return\n"+ "  let $avg := fn:avg($w/@temp)\n"+ "  where $avg * 2 lt xs:double($next/@temp) or $avg div 2 gt xs:double($next/@temp)\n"+ "  return <alarm>Outlier detected. Event id:{data($next/@time)}</alarm>\n"+ "      ",ctx);
  try {
    query.context(node(file("prod/WindowClause/temp_events.xml")));
    result=new QT3Result(query.value());
  }
 catch (  final Throwable trw) {
    result=new QT3Result(trw);
  }
 finally {
    query.close();
  }
  test(assertSerialization("<alarm>Outlier detected. Event id:5</alarm>",false));
}
