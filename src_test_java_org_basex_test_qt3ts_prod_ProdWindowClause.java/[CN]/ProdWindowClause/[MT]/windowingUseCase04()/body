{
  final XQuery query=new XQuery("\n" + "let $MAX_DIFF := 2\n" + "\n"+ "for sliding window $w in ./stream/event\n"+ "  start  $s_curr at $s_pos previous $s_prev\n"+ "    when ($s_curr/@time ne $s_prev/@time) or (empty($s_prev))\n"+ "  only end next $e_next\n"+ "    when $e_next/@time - $s_curr/@time gt $MAX_DIFF\n"+ "return\n"+ "  avg( $w/@temp )\n"+ "      ",ctx);
  query.context(node(file("prod/WindowClause/temp_events.xml")));
  final QT3Result res=result(query);
  result=res;
  test(assertSerialization("8 9 17 18",false));
}
