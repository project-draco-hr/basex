{
  final XQuery query=new XQuery("\n" + "<result>{\n" + "  for tumbling window $w in ./rss/channel/item\n"+ "    start  $s_curr when true()\n"+ "    end next $e_next when\n"+ "      fn:day-from-dateTime(xs:dateTime($e_next/pubDate)) ne\n"+ "      fn:day-from-dateTime(xs:dateTime($s_curr/pubDate))\n"+ "  return\n"+ "    <item>\n"+ "      <date>{xs:date(xs:dateTime($s_curr/pubDate))}</date>\n"+ "       {  for $a in fn:distinct-values($w/author)\n"+ "           return\n"+ "             <author name=\"{$a}\">\n"+ "               <titles>\n"+ "                 { $w[author eq $a]/title }\n"+ "               </titles>\n"+ "             </author>\n"+ "            }\n"+ "          </item>\n"+ "}</result>\n"+ "      ",ctx);
  try {
    query.context(node(file("prod/WindowClause/rss.xml")));
    result=new QT3Result(query.value());
  }
 catch (  final Throwable trw) {
    result=new QT3Result(trw);
  }
 finally {
    query.close();
  }
  test(assertSerialization("<result><item><date>2003-06-03</date><author name=\"rokas@e-mail.de\"><titles><title>Why use cases are important Part 1.</title><title>Why use cases are important Part 2.</title><title>Why use cases are important Part 3.</title></titles></author><author name=\"tim@e-mail.de\"><titles><title>Extending XQuery with Window Functions</title></titles></author><author name=\"david@e-mail.de\"><titles><title>XQueryP: A new programming language is born</title></titles></author></item><item><date>2003-06-04</date><author name=\"rokas@e-mail.de\"><titles><title>Why use cases are annoying to write.</title></titles></author></item></result>",false));
}
