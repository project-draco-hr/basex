{
  final XQuery query=new XQuery("\n" + "          let $stock :=\n" + "            <stock>\n"+ "              <closing> <date>2008-01-01</date> <price>105</price> </closing>\n"+ "              <closing> <date>2008-01-02</date> <price>101</price> </closing>\n"+ "              <closing> <date>2008-01-03</date> <price>102</price> </closing>\n"+ "              <closing> <date>2008-01-04</date> <price>103</price> </closing>\n"+ "              <closing> <date>2008-01-05</date> <price>102</price> </closing>\n"+ "              <closing> <date>2008-01-06</date> <price>104</price> </closing>\n"+ "            </stock>\n"+ "          for tumbling window $w in $stock//closing\n"+ "             start $first next $second when $first/price < $second/price\n"+ "             end $last next $beyond when $last/price > $beyond/price\n"+ "          return\n"+ "             <run-up>\n"+ "                <start-date>{fn:data($first/date)}</start-date>\n"+ "                <start-price>{fn:data($first/price)}</start-price>\n"+ "                <end-date>{fn:data($last/date)}</end-date>\n"+ "                <end-price>{fn:data($last/price)}</end-price>\n"+ "             </run-up>\n"+ "        ",ctx);
  final QT3Result res=result(query);
  result=res;
  test(assertSerialization("<run-up><start-date>2008-01-02</start-date><start-price>101</start-price><end-date>2008-01-04</end-date><end-price>103</end-price></run-up><run-up><start-date>2008-01-05</start-date><start-price>102</start-price><end-date>2008-01-06</end-date><end-price>104</end-price></run-up>",false));
}
