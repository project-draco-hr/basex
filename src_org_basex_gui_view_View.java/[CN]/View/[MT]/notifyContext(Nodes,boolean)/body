{
  final Context context=GUI.context;
  if (nodes.size == 0)   return;
  final Nodes n=new Nodes(context.data());
  final GUI gui=GUI.get();
  if (!quick) {
    final String input=gui.input.getText();
    checkHist();
    QUERYHIST[hist]=input;
    MARKHIST[hist]=context.marked();
    NODEHIST[++hist]=nodes;
    QUERYHIST[hist]=input;
    MARKHIST[hist]=n;
    maxhist=hist;
  }
 else {
    if (!NODEHIST[hist].sameAs(context.current())) {
      checkHist();
      QUERYHIST[hist]="";
      MARKHIST[hist]=new Nodes(context.data());
      NODEHIST[++hist]=context.current();
      maxhist=hist;
    }
  }
  ViewData.init(nodes,n);
  for (  final View v : view)   v.refreshContext(true,quick);
  gui.refreshControls();
}
