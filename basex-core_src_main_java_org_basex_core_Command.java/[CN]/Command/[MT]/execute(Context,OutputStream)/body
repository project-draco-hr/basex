{
  final Data dt=ctx.data();
  if (dt == null && data)   throw new BaseXException(NO_DB_OPENED);
  if (!ctx.perm(perm,dt != null ? dt.meta : null))   throw new BaseXException(PERM_REQUIRED_X,perm);
  updating=updating(ctx);
  try {
    ctx.register(this);
    if (!run(ctx,os))     throw new BaseXException(info());
  }
 catch (  final RuntimeException th) {
    Util.stack(th);
    throw th;
  }
 finally {
    ctx.unregister(this);
  }
}
