{
  TrieNode[] ch=null;
  int nu=used, ns=size;
  for (int i=0; i < kids.length; i++) {
    final TrieNode k=kids[i], ok=o.kids[i];
    if (ok != null) {
      final TrieNode nw=k == null ? ok : ok.addAll(k,l + 1,ii);
      if (nw != k) {
        if (ch == null)         ch=kids.clone();
        ch[i]=nw;
        nu|=1 << i;
        ns+=nw.size - (k == null ? 0 : k.size);
      }
    }
  }
  return ch == null ? this : new Branch(ch,nu,ns);
}
