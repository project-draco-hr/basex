{
  while (true) {
    byte ch=input.next();
    if (ch < ' ' && ch > 0 && !ws(ch))     error(XMLCHAR,(char)ch,ch);
    if (ch == '%' && pe) {
      byte[] key=name(true);
      byte[] val=pents.get(key);
      if (val == null)       error(UNKNOWNPE,key);
      check(';');
      input.add(val,true);
    }
 else     if (ch != 0x0D) {
      return ch;
    }
  }
}
