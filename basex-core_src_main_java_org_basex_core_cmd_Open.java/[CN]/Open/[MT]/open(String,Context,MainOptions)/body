{
synchronized (context.dbs) {
    Data data=context.dbs.pin(name);
    if (data != null) {
      if (!context.perm(Perm.READ,data.meta)) {
        context.dbs.unpin(data);
        throw new BaseXException(PERM_REQUIRED_X,Perm.READ);
      }
    }
 else {
      if (!context.soptions.dbexists(name))       throw new BaseXException(dbnf(name));
      final MetaData meta=new MetaData(name,options,context.soptions);
      if (meta.updateFile().exists())       throw new BaseXException(Text.DB_UPDATED_X,meta.name);
      meta.users.read();
      if (!context.perm(Perm.READ,meta))       throw new BaseXException(PERM_REQUIRED_X,Perm.READ);
      data=new DiskData(meta);
      context.dbs.add(data);
    }
    return data;
  }
}
