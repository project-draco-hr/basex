{
  final boolean create=ctx.user.perm(User.CREATE);
  final IO io=IO.get(path);
  final String name=io.dbname();
  final Data data=ctx.pin(name);
  if (data != null) {
    final IO in=IO.get(data.meta.original);
    final boolean found=!data.meta.original.isEmpty() && in.eq(io) && io.timeStamp() == in.timeStamp();
    if (found && ctx.perm(User.READ,data.meta))     return data;
    Close.close(data,ctx);
    if (found)     throw new BaseXException(PERM_NEEDED_X,CmdPerm.READ);
  }
  if (!create || MetaData.found(path,name,ctx.mprop))   return Open.open(name,ctx);
  if (!io.exists())   throw new FileNotFoundException(Util.info(FILE_NOT_FOUND_X,io));
  if (!ctx.prop.is(Prop.FORCECREATE))   return CreateDB.mainMem(io,ctx);
  final DirParser dp=new DirParser(io,ctx.prop,ctx.mprop.dbpath(name));
  return CreateDB.create(name,dp,ctx);
}
