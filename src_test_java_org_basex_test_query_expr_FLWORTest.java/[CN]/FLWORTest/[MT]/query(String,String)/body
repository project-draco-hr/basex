{
  final QueryProcessor proc=new QueryProcessor(query,context);
  try {
    final String result=proc.value().serialize().toString();
    assertEquals(expected.replaceAll("\"","'"),result.replaceAll("\"","'"));
  }
 catch (  final QueryException ex) {
    throw (Error)new AssertionError(Util.message(ex)).initCause(ex);
  }
 finally {
    proc.close();
  }
}
