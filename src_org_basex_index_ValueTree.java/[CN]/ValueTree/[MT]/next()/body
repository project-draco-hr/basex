{
  ln=cn;
  if (r(cn) != -1) {
    cn=r(cn);
    while (l(cn) != -1)     cn=l(cn);
  }
 else {
    int t=cn;
    cn=p(cn);
    while (cn != -1 && t == r(cn)) {
      t=cn;
      cn=p(cn);
    }
  }
  final byte[] pp=pres.get(ln);
  pres.set(null,ln);
  return pp;
}
