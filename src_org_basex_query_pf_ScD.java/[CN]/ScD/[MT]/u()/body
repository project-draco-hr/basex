{
  int j=0;
  for (int i=1; i < cn.sz; i++) {
    if (cn.r(j).i() != cn.r(i).i()) {
      cn.r(cn.r(i),++j);
      cr.r(cr.r(i),j);
    }
  }
  cn.sz=++j;
  cr.sz=j;
}
