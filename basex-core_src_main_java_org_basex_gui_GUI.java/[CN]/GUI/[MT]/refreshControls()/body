{
  final Nodes marked=context.marked;
  if (marked != null)   setResults(marked.size());
  filter.setEnabled(marked != null && marked.size() != 0);
  final boolean inf=gprop.is(GUIProp.SHOWINFO);
  context.prop.set(Prop.QUERYINFO,inf);
  context.prop.set(Prop.XMLPLAN,inf);
  final Data data=context.data();
  final int t=mode.getSelectedIndex();
  final int s=data == null ? 2 : gprop.num(GUIProp.SEARCHMODE);
  mode.setEnabled(data != null);
  go.setEnabled(s == 2 || !gprop.is(GUIProp.EXECRT));
  if (s != t) {
    mode.setSelectedIndex(s);
    input.setText("");
    input.requestFocusInWindow();
  }
  toolbar.refresh();
  menu.refresh();
  final int i=context.data() == null ? 2 : gprop.num(GUIProp.SEARCHMODE);
  final Object[] options=i == 0 ? GUIProp.SEARCH : i == 1 ? GUIProp.XQUERY : GUIProp.COMMANDS;
  hist.setEnabled(gprop.strings(options).length != 0);
}
