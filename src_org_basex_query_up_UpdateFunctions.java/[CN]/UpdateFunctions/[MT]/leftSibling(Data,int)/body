{
  if (pre < 1 || pre >= d.size(0,d.kind(0)))   return -1;
  final int par=d.parent(pre,d.kind(pre));
  int s=-1;
  int p=par + 1;
  while (p < pre) {
    s=p;
    p=p + d.size(p,d.kind(p));
  }
  return s;
}
