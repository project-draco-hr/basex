{
  final XQuery query=new XQuery("\n" + "        declare variable $codepoints as xs:integer+ := (9, 10, 13, 32 to 55295, 57344 to 65532, 65536 to 1114111 ); \n" + "        declare variable $count as xs:integer := count($codepoints); \n"+ "        declare variable $lineWidth as xs:integer := 70;\n"+ "        <allCodepoints><r>{codepoints-to-string($codepoints)}</r></allCodepoints> \n"+ "        (:<allCodepoints>{ \n"+ "            for $i in (1 to $count idiv $lineWidth) \n"+ "            let $startOffset := (($i - 1) * $lineWidth) + 1 \n"+ "            return (<r s=\"{$codepoints[$startOffset]}\" e=\"{$codepoints[$startOffset] + $lineWidth}\"> { \n"+ "                codepoints-to-string(subsequence($codepoints, $startOffset, $lineWidth)) } </r>, \"&#xA;\") \n"+ "                } </allCodepoints>:)\n"+ "        ",ctx);
  final QT3Result res=result(query);
  result=res;
  test((assertQuery("sum($result//r/text()/string-length()) = count((9, 10, 13, 32 to 55295, 57344 to 65532, 65536 to 1114111 ))") && assertQuery("starts-with(($result//r/text())[1], '\t')") && assertQuery("ends-with(($result//r/text())[last()], '????')")));
}
