{
  final XPathProcessor stepGender=parse("profile/gender/text()");
  final XPathProcessor stepAge=parse("profile/age/text()");
  final XPathProcessor stepEducation=parse("profile/education/text()");
  final XPathProcessor stepIncome=parse("profile/@income");
  final XPathProcessor stepName=parse("name/text()");
  final XPathProcessor stepStreet=parse("address/street/text()");
  final XPathProcessor stepCity=parse("address/city/text()");
  final XPathProcessor stepCountry=parse("address/country/text()");
  final XPathProcessor stepEmail=parse("emailaddress/text()");
  final XPathProcessor stepHomepage=parse("homepage/text()");
  final XPathProcessor stepCreditcard=parse("creditcard/text()");
  final Nodes person=qu("/site/people/person");
  final byte[][] idist=distinctvalues(qu("/site/people/person/profile/interest/@category"));
  final int cs=idist.length;
  for (int ci=0; ci < cs; ci++) {
    final String category=Token.string(idist[ci]);
    writeSep(ci);
    out.out.print("<categorie>");
    out.out.print(NL);
    out.out.print("<id>");
    out.out.print(category);
    out.out.print("</id>");
    out.out.print(NL);
    final Nodes p=eval(parse(".[profile/interest/@category = '" + category + "']"),person);
    final int ps=p.size;
    for (int pi=0; pi < ps; pi++) {
      out.out.print("<personne>");
      out.out.print(NL);
      out.out.print("  <statistiques>");
      out.out.print(NL);
      out.out.print("    ");
      writeTag("sexe",p,pi,stepGender);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("age",p,pi,stepAge);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("education",p,pi,stepEducation);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("revenu",p,pi,stepIncome);
      out.out.print(NL);
      out.out.print("  </statistiques>");
      out.out.print(NL);
      out.out.print("  <coordonnees>");
      out.out.print(NL);
      out.out.print("    ");
      writeTag("nom",p,pi,stepName);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("rue",p,pi,stepStreet);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("ville",p,pi,stepCity);
      out.out.print(NL);
      out.out.print("    ");
      writeTag("pays",p,pi,stepCountry);
      out.out.print(NL);
      out.out.print("    ");
      out.out.print("<reseau>");
      out.out.print(NL);
      out.out.print("      ");
      writeTag("courrier",p,pi,stepEmail);
      out.out.print(NL);
      out.out.print("      ");
      writeTag("pagePerso",p,pi,stepHomepage);
      out.out.print(NL);
      out.out.print("    </reseau>");
      out.out.print(NL);
      out.out.print("  </coordonnees>");
      out.out.print(NL);
      out.out.print("  ");
      writeTag("cartePaiement",p,pi,stepCreditcard);
      out.out.print(NL);
      out.out.print("</personne>");
      out.out.print(NL);
    }
    out.out.print("</categorie>");
  }
  return idist.length;
}
