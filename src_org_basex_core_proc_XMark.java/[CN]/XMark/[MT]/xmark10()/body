{
  final XPathProcessor stepGender=parse("profile/gender/text()");
  final XPathProcessor stepAge=parse("profile/age/text()");
  final XPathProcessor stepEducation=parse("profile/education/text()");
  final XPathProcessor stepIncome=parse("profile/@income");
  final XPathProcessor stepName=parse("name/text()");
  final XPathProcessor stepStreet=parse("address/street/text()");
  final XPathProcessor stepCity=parse("address/city/text()");
  final XPathProcessor stepCountry=parse("address/country/text()");
  final XPathProcessor stepEmail=parse("emailaddress/text()");
  final XPathProcessor stepHomepage=parse("homepage/text()");
  final XPathProcessor stepCreditcard=parse("creditcard/text()");
  final Nodes person=qu("/site/people/person");
  final byte[] cat=token("categorie");
  final byte[] id=token("id");
  final byte[] pers=token("personne");
  final byte[] stat=token("statistique");
  final byte[] sexe=token("sexe");
  final byte[] age=token("age");
  final byte[] edu=token("education");
  final byte[] rev=token("revenu");
  final byte[] nom=token("nom");
  final byte[] rue=token("rue");
  final byte[] pays=token("pays");
  final byte[] ville=token("ville");
  final byte[] courrier=token("courrier");
  final byte[] page=token("pageperso");
  final byte[] carte=token("cartePaiement");
  final byte[] cord=token("cordonnees");
  final byte[] reseau=token("reseau");
  final byte[][] idist=distinctvalues(qu("/site/people/person/profile/interest/@category"));
  final int cs=idist.length;
  for (int ci=0; ci < cs; ci++) {
    final String category=string(idist[ci]);
    writeSep(ci);
    out.openElement(cat);
    out.out.print(NL);
    out.openElement(id);
    out.out.print(category);
    out.closeElement(cat);
    out.out.print(NL);
    final Nodes p=eval(parse(".[profile/interest/@category = '" + category + "']"),person);
    final int ps=p.size;
    for (int pi=0; pi < ps; pi++) {
      out.openElement(pers);
      out.out.print(NL);
      out.openElement(stat);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(sexe,p,pi,stepGender);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(age,p,pi,stepAge);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(edu,p,pi,stepEducation);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(rev,p,pi,stepIncome);
      out.out.print(NL);
      out.closeElement(stat);
      out.out.print(NL);
      out.openElement(cord);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(nom,p,pi,stepName);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(rue,p,pi,stepStreet);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(ville,p,pi,stepCity);
      out.out.print(NL);
      out.out.print("    ");
      writeTag(pays,p,pi,stepCountry);
      out.out.print(NL);
      out.out.print("    ");
      out.openElement(reseau);
      out.out.print(NL);
      out.out.print("      ");
      writeTag(courrier,p,pi,stepEmail);
      out.out.print(NL);
      out.out.print("      ");
      writeTag(page,p,pi,stepHomepage);
      out.out.print(NL);
      out.closeElement(reseau);
      out.out.print(NL);
      out.closeElement(cord);
      out.out.print(NL);
      out.out.print("  ");
      writeTag(carte,p,pi,stepCreditcard);
      out.out.print(NL);
      out.closeElement(pers);
      out.out.print(NL);
    }
    out.closeElement(cat);
  }
  return idist.length;
}
