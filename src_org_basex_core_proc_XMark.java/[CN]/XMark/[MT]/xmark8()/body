{
  final Nodes p=qu("/site/people/person");
  final Nodes c=qu("/site/closed_auctions/closed_auction");
  final XPathProcessor stepName=parse("name/text()");
  final XPathProcessor stepID=parse("@id");
  final byte[] item=token("item");
  final byte[] person=token("person");
  final int ps=p.size;
  for (int pi=0; pi < ps; pi++) {
    writeSep(pi);
    out.openElement(item,person,atom(p,pi,stepName));
    parse("count(.[buyer/@person = '" + string(atom(p,pi,stepID)) + "'])").query(c).serialize(out);
    out.closeElement(item);
  }
  return p.size;
}
