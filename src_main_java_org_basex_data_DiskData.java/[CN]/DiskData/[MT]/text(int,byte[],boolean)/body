{
  final long v=Token.toSimpleInt(val);
  if (v != Integer.MIN_VALUE) {
    textOff(pre,v | IO.OFFNUM);
  }
 else {
    final DataAccess da=txt ? texts : values;
    final byte[] cpr=comp.pack(val);
    long o=textOff(pre) & IO.OFFCOMP - 1;
    if (num(textOff(pre)) || cpr.length > da.readNum(o) && da.pos() + da.readNum(o) != da.length())     o=da.length();
    da.writeBytes(o,cpr);
    textOff(pre,o | (cpr == val ? 0 : IO.OFFCOMP));
  }
}
