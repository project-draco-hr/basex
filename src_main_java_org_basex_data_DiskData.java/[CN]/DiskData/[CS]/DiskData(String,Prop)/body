{
  meta=new MetaData(db,pr);
  comp=new Compress(pr.num(Prop.COMPRESS));
  final DataInput in=new DataInput(meta.file(DATAINFO));
  try {
    meta.read(in);
    while (true) {
      final String k=Token.string(in.readBytes());
      if (k.isEmpty())       break;
      if (k.equals(DBTAGS))       tags=new Names(in);
 else       if (k.equals(DBATTS))       atts=new Names(in);
 else       if (k.equals(DBPATH))       pthindex=new PathSummary(in);
 else       if (k.equals(DBNS))       ns=new Namespaces(in);
    }
    init();
    if (meta.textindex)     txtindex=new DiskValues(this,true);
    if (meta.attrindex)     atvindex=new DiskValues(this,false);
    if (meta.ftindex)     ftxindex=FTIndex.get(this,meta.wildcards);
  }
 catch (  final IOException ex) {
    throw ex;
  }
 finally {
    try {
      in.close();
    }
 catch (    final IOException ex) {
    }
  }
}
