{
  meta=new MetaData(db,ctx);
  if (updateFile().exists())   throw new BaseXException(Text.DBUPDATED,meta.name);
  final DataInput in=new DataInput(meta.dbfile(DATAINF));
  try {
    meta.read(in);
    while (true) {
      final String k=string(in.readToken());
      if (k.isEmpty())       break;
      if (k.equals(DBTAGS))       tagindex=new Names(in,meta);
 else       if (k.equals(DBATTS))       atnindex=new Names(in,meta);
 else       if (k.equals(DBPATH))       pthindex=new PathSummary(this,in);
 else       if (k.equals(DBNS))       nspaces=new Namespaces(in);
 else       if (k.equals(DBDOCS))       docindex.read(in);
    }
    init();
    if (meta.updindex) {
      idmap=new IdPreMap(meta.dbfile(DATAIDP));
      if (meta.textindex)       txtindex=new UpdatableDiskValues(this,true);
      if (meta.attrindex)       atvindex=new UpdatableDiskValues(this,false);
    }
 else {
      if (meta.textindex)       txtindex=new DiskValues(this,true);
      if (meta.attrindex)       atvindex=new DiskValues(this,false);
    }
    if (meta.ftxtindex)     ftxindex=FTIndex.get(this,meta.wildcards);
  }
  finally {
    in.close();
  }
}
