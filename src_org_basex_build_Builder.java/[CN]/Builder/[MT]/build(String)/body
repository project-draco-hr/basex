{
  init(db);
  parser.parse(this);
  if (level != 0)   error(DOCOPEN,parser.det(),tags.key(tagStack[level]));
  meta.lastid=meta.size;
  if (meta.size == 0) {
    addDoc(utf8(token(db),Prop.ENCODING));
    setSize(0,meta.size);
  }
  if (tags.size() > 0xFFFF)   throw new IOException(LIMITTAGS);
  if (atts.size() > 0xFFFF)   throw new IOException(LIMITATTS);
  return finish();
}
