{
  final int kind=data.kind(pre);
  final int par=data.parent(pre,kind);
  shifts=data.size(pre,kind) - md.meta.size;
  if (kind == Data.TEXT && md.meta.size == 1 && md.kind(0) == Data.TEXT) {
    data.replace(pre,Data.TEXT,md.text(0,true));
  }
 else {
    if (data.ns.size() == 0 && md.ns.size() == 0) {
      data.replace(pre,md);
    }
 else {
      data.delete(pre);
      if (kind == Data.ATTR)       data.insertAttr(pre,par,md);
 else       data.insert(pre,par,md);
    }
  }
}
