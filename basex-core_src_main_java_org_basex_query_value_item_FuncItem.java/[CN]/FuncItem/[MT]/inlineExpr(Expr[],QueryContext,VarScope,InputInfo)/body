{
  if (!StaticFunc.inline(qc,anns,expr) || expr.has(Flag.CTX))   return null;
  qc.compInfo(OPTINLINE_X,this);
  final LinkedList<Clause> cls=exprs.length == 0 ? null : new LinkedList<Clause>();
  final IntObjMap<Var> vs=new IntObjMap<>();
  final int pl=params.length;
  for (int p=0; p < pl; p++) {
    final Var old=params[p], v=scp.newCopyOf(qc,old);
    vs.put(old.id,v);
    cls.add(new Let(v,exprs[p],false,ii).optimize(qc,scp));
  }
  final Expr rt=expr.copy(qc,scp,vs);
  rt.accept(new ASTVisitor(){
    @Override public boolean inlineFunc(    final Scope sub){
      return sub.visit(this);
    }
    @Override public boolean dynFuncCall(    final DynFuncCall call){
      call.markInlined(FuncItem.this);
      return true;
    }
  }
);
  return cls == null ? rt : new GFLWOR(ii,cls,rt).optimize(qc,scp);
}
