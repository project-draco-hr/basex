{
  final int h=sub.getSubtreeHeight(rn);
  rects[rn]=new TreeRect[h][];
  double w=-1;
  for (int lv=0; lv < h; ++lv) {
    w=dw / sub.getLevelSize(rn,lv);
    if (w < 2) {
      bigRectangle(rn,lv,ds,dw);
    }
 else {
      normalRectangle(sub,c,g,rn,lv,ds,w);
    }
  }
  return (int)w;
}
