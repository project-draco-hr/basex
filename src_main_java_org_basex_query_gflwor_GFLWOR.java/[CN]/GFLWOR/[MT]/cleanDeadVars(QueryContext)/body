{
  final IntMap<Var> decl=new IntMap<Var>();
  final BitArray used=new BitArray();
  for (  final Clause cl : clauses)   for (  final Var v : cl.vars())   decl.add(v.id,v);
  final ASTVisitor marker=new ASTVisitor(){
    @Override public boolean used(    final VarRef ref){
      final int id=ref.var.id;
      if (decl.get(id) != null)       used.set(id);
      return true;
    }
  }
;
  ret.accept(marker);
  boolean change=false;
  for (int i=clauses.size(); --i >= 0; ) {
    final Clause curr=clauses.get(i);
    change|=curr.clean(ctx,decl,used);
    curr.accept(marker);
    for (    final Var v : curr.vars())     used.clear(v.id);
  }
  return change;
}
