{
  final DataOutput outx=new DataOutput(data.meta.file(DATAFTX + 'x'));
  final DataOutput outy=new DataOutput(data.meta.file(DATAFTX + 'y'));
  final DataOutput outz=new DataOutput(data.meta.file(DATAFTX + 'z'));
  outx.write(isize);
  long dr=0;
  int tr=0;
  byte j=-1;
  while (++j < tree.length) {
    final FTHash hash=tree[j];
    if (hash == null)     continue;
    outx.write(j);
    outx.writeInt(tr);
    if (scm == 0)     hash.init();
 else     hash.initIter();
    while (hash.more()) {
      final int p=hash.next();
      final byte[] key=hash.key();
      for (int i=0; i < j; i++)       outy.write(key[i]);
      outy.write5(dr);
      outy.writeInt(hash.ns[p]);
      writeFTData(outz,hash.pre[p],hash.pos[p]);
      dr=outz.size();
      tr=(int)outy.size();
    }
    tree[j]=null;
  }
  tree=null;
  outx.write(j);
  outx.writeInt(tr);
  outx.close();
  outy.close();
  outz.close();
}
