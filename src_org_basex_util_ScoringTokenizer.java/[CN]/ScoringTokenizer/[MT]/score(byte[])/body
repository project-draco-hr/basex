{
  final int c=token.get(key);
  token.set(key,-1);
  if (c > 0 && freq != null) {
    final int f=freq.get(key);
    if (f > 0) {
      return Math.max(1,(int)(Math.log(2666130d / f) * c * 1000 / max));
    }
  }
  return c == 0 ? 0 : Math.max(1,c * 1000 / max);
}
