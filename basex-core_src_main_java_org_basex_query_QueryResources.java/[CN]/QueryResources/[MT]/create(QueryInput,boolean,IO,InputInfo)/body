{
  final Context context=qc.context;
  if (!context.user().has(Perm.READ))   throw BXXQ_PERM_X.get(ii,Util.info(Text.PERM_REQUIRED_X,Perm.READ));
  final IO source=checkPath(input,baseIO);
  if (source == null)   throw WHICHRES_X.get(ii,input.original);
  if (single && source.isDir())   throw RESDIR_X.get(ii,baseIO);
  final boolean mem=!context.options.get(MainOptions.FORCECREATE);
  final MainOptions opts=new MainOptions(context.options,true);
  final Parser parser=new DirParser(source,opts);
  final Data data;
  try {
    data=CreateDB.create(source.dbName(),parser,context,opts,mem);
  }
 catch (  final IOException ex) {
    throw IOERR_X.get(ii,ex);
  }
  input.dbPath="";
  return addData(data);
}
