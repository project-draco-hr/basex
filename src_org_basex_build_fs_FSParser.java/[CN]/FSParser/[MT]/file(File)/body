{
  curr=f;
  if (!singlemode)   builder.startElem(FILE,atts(f,false));
  if (f.canRead()) {
    if (Prop.fsmeta && f.getName().indexOf('.') != -1) {
      final String name=f.getName();
      final int dot=name.lastIndexOf('.');
      final byte[] suffix=lc(token(name.substring(dot + 1)));
      final AbstractExtractor index=meta.get(suffix);
      if (index != null && f.length() != 0) {
        try {
          index.extract(builder,f);
        }
 catch (        final MetaDataException ex) {
          BaseX.debug(ex);
        }
      }
    }
    if (Prop.fscont && f.isFile()) {
      final int l=(int)Math.min(f.length(),Prop.fstextmax);
      final byte[] cc=new byte[l];
      BufferInput.read(f,cc);
      int c=-1;
      while (++c < l) {
        final byte b=cc[c];
        if (b >= 0 && b < ' ' && !ws(b))         break;
      }
      if (c == l) {
        while (--c >= 0 && cc[c] <= 0x20 && cc[c] >= 0)         ;
        if (++c != 0) {
          builder.nodeAndText(CONTENT,atts.reset(),Array.finish(cc,c));
        }
      }
    }
  }
  if (!singlemode)   builder.endElem(FILE);
  sizeStack[lvl]+=f.length();
}
