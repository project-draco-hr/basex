{
  try {
    final String query=q == null ? "" : q;
    final QueryProcessor qu=new QueryProcessor(query,context);
    progress(qu);
    final Nodes nodes=qu.queryNodes();
    if (err != null) {
      final Data data=context.data();
      for (int i=nodes.size() - 1; i >= 0; i--) {
        if (data.kind(nodes.nodes[i]) != Data.ELEM) {
          error(err);
          return null;
        }
      }
    }
    return nodes;
  }
 catch (  final QueryException ex) {
    Main.debug(ex);
    error(ex.getMessage());
    return null;
  }
}
