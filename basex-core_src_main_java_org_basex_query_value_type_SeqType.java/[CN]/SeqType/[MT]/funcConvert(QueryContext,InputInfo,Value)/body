{
  final long n=val.size();
  if (!occ.check(n))   throw Err.treat(ii,this,val);
  if (n == 0)   return Empty.SEQ;
  if (val.isItem())   return instance((Item)val,true) ? val : funcConv(ctx,ii,(Item)val);
  ValueBuilder vb=null;
  final Item fst=val.itemAt(0);
  if (!instance(fst,true)) {
    vb=new ValueBuilder(new Item[(int)val.size()],0);
    vb.add(funcConv(ctx,ii,fst));
  }
 else   if (val.homogeneous()) {
    return val;
  }
  for (int i=1; i < n; i++) {
    final Item it=val.itemAt(i);
    if (vb != null) {
      vb.add(instance(it,true) ? it : funcConv(ctx,ii,it));
    }
 else     if (!instance(it,true)) {
      vb=new ValueBuilder(new Item[(int)val.size()],0);
      for (int j=0; j < i; j++)       vb.add(val.itemAt(j));
      vb.add(funcConv(ctx,ii,it));
    }
  }
  return vb != null ? Seq.get(vb.item,(int)vb.size(),type) : val;
}
