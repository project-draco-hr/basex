{
  if (!(expr[0] instanceof AxisPath))   return this;
  final ArrayList<PathNode> nodes=((AxisPath)expr[0]).nodes(ctx);
  if (nodes == null)   return this;
  final ItemSet is=new ItemSet();
  for (  PathNode pn : nodes) {
    if (pn.kind == Data.ELEM) {
      if (!pn.stats.isLeaf())       return this;
      for (      final PathNode n : pn.ch)       if (n.kind == Data.TEXT)       pn=n;
    }
    if (pn.kind != Data.TEXT && pn.kind != Data.ATTR)     return this;
    if (pn.stats.type != StatsType.CATEGORY)     return this;
    for (    final byte[] c : pn.stats.cats)     is.index(input,new Atm(c));
  }
  final ItemCache ic=new ItemCache(is.size());
  for (  final Item i : is)   ic.add(i);
  return ic.value();
}
