{
  root=checkUp(root,ctx).comp(ctx);
  if (root.isEmpty())   return optPre(null,ctx);
  if (root instanceof AxisPath && !super.uses(Use.POS))   return ((AxisPath)root).copy().addPreds(preds).comp(ctx);
  final Expr e=super.comp(ctx);
  if (e != this)   return e;
  return preds.length == 0 ? root : comp2(ctx);
}
