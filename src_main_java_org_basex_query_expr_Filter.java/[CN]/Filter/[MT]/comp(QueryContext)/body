{
  root=checkUp(root,ctx).comp(ctx);
  if (root.empty())   return optPre(Empty.SEQ,ctx);
  if (root instanceof AxisPath && !super.uses(Use.POS))   return ((AxisPath)root).copy().addPreds(pred).comp(ctx);
  final Value cv=ctx.value;
  ctx.value=null;
  final Expr e=super.comp(ctx);
  ctx.value=cv;
  if (e != this)   return e;
  return pred.length == 0 ? root : comp2(ctx);
}
