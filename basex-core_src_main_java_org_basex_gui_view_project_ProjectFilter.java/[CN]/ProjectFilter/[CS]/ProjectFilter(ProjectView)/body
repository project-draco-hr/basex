{
  super(view.gui);
  project=view;
  addKeyListener(new KeyAdapter(){
    @Override public void keyReleased(    final KeyEvent e){
      final String pattern=getText().trim();
      if (last.equals(pattern))       return;
      last=pattern;
      final Component oldView=view.scroll.getViewport().getView(), newView;
      if (pattern.isEmpty()) {
        newView=view.tree;
      }
 else {
        newView=view.list;
        final Thread t=new Thread(){
          @Override public void run(){
            filter(pattern);
          }
        }
;
        t.setDaemon(true);
        t.start();
      }
      if (oldView != newView)       view.scroll.setViewportView(newView);
    }
    @Override public void keyPressed(    final KeyEvent e){
      if (BaseXKeys.NEXTLINE.is(e) || BaseXKeys.PREVLINE.is(e) || BaseXKeys.NEXTPAGE.is(e)|| BaseXKeys.PREVPAGE.is(e)|| BaseXKeys.LINESTART.is(e)|| BaseXKeys.LINEEND.is(e)) {
        project.list.dispatchEvent(e);
      }
    }
    @Override public void keyTyped(    final KeyEvent e){
      if (BaseXKeys.ENTER.is(e))       view.list.open();
 else       if (BaseXKeys.ESCAPE.is(e))       setText("");
    }
  }
);
}
