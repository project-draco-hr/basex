{
  if (results.size() < MAXHITS) {
    final boolean path=Token.indexOf(pattern,'\\') != -1 || Token.indexOf(pattern,'/') != -1;
    for (    final byte[] input : cache) {
      final int offset=offset(input,path);
      if (mode == 0 && Token.startsWith(input,pattern,offset) || mode == 1 && Token.contains(input,pattern,offset) || matches(input,pattern,offset)) {
        if (!exclude.contains(input)) {
          exclude.add(input);
          if (filterContent(input,search,results))           return true;
        }
      }
      if (thread != threadID)       return false;
    }
  }
  return true;
}
