{
  if (results.size() < MAXHITS) {
    for (    final byte[] input : cache) {
      final byte[] lc=Token.replace(Token.lc(input),'\\','/');
      final int offset=offset(lc,path);
      if (mode == 0 ? Token.startsWith(lc,pattern,offset) : mode == 1 ? Token.contains(lc,pattern,offset) : matches(lc,pattern,offset)) {
        if (!exclude.contains(input)) {
          exclude.add(input);
          if (filterContent(input,search,results))           return true;
        }
      }
      if (thread != threadID)       return false;
    }
  }
  return true;
}
