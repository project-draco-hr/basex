{
  final IOFile io=new IOFile(TEMP);
  io.write(Token.token("<x"));
  new Set(MainOptions.SKIPCORRUPT,true).execute(context);
  assertEquals(0,context.data().resources.docsIn("").size());
  new Add("x","<x").execute(context);
  new Add("x",CORRUPT).execute(context);
  assertEquals(0,context.data().resources.docsIn("").size());
  new Set(MainOptions.SKIPCORRUPT,false).execute(context);
  try {
    new Add("","<x").execute(context);
    fail("Broken file was added to the database.");
  }
 catch (  final Exception ignored) {
  }
  assertTrue(io.delete());
}
