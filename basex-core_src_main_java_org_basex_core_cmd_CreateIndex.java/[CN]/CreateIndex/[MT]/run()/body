{
  final Data data=context.data();
  final CmdIndex ci=getOption(CmdIndex.class);
  if (ci == null)   return error(UNKNOWN_CMD_X,this);
  final IndexType type;
  if (ci == CmdIndex.TEXT) {
    data.meta.createtext=true;
    data.meta.textinclude=options.get(MainOptions.TEXTINCLUDE);
    data.meta.splitsize=options.get(MainOptions.INDEXSPLITSIZE);
    type=IndexType.TEXT;
  }
 else   if (ci == CmdIndex.ATTRIBUTE) {
    data.meta.createattr=true;
    data.meta.attrinclude=options.get(MainOptions.ATTRINCLUDE);
    data.meta.splitsize=options.get(MainOptions.INDEXSPLITSIZE);
    type=IndexType.ATTRIBUTE;
  }
 else   if (ci == CmdIndex.ATTTOKEN) {
    data.meta.createattrtoken=true;
    data.meta.attrtokeninclude=options.get(MainOptions.ATTRTOKENIZE);
    data.meta.splitsize=options.get(MainOptions.INDEXSPLITSIZE);
    type=IndexType.ATTTOKEN;
  }
 else   if (ci == CmdIndex.FULLTEXT) {
    data.meta.createftxt=true;
    data.meta.ftinclude=options.get(MainOptions.FTINCLUDE);
    data.meta.stemming=options.get(MainOptions.STEMMING);
    data.meta.casesens=options.get(MainOptions.CASESENS);
    data.meta.diacritics=options.get(MainOptions.DIACRITICS);
    data.meta.language=Language.get(options);
    data.meta.stopwords=options.get(MainOptions.STOPWORDS);
    data.meta.ftsplitsize=options.get(MainOptions.FTINDEXSPLITSIZE);
    type=IndexType.FULLTEXT;
  }
 else {
    return error(UNKNOWN_CMD_X,this);
  }
  if (!startUpdate())   return false;
  boolean ok=true;
  try {
    create(type,data,this);
    ok=info(INDEX_CREATED_X_X,type,perf);
  }
 catch (  final IOException ex) {
    ok=error(Util.message(ex));
  }
 finally {
    ok&=finishUpdate();
  }
  return ok;
}
