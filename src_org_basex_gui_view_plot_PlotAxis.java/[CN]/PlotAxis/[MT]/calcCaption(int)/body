{
  if (type == Kind.DBL || type == Kind.INT) {
    final double range=Math.abs(max - min);
    if (range == 0) {
      nrCaptions=1;
      return;
    }
    final boolean dbl=type == Kind.DBL;
    captionStep=calculatedCaptionStep;
    nrCaptions=(int)(range / captionStep) + 1;
    while (2 * nrCaptions * PlotView.CAPTIONWHITESPACE* 2 < space && dbl ? dbl : captionStep % 2 == 0) {
      captionStep/=2;
      nrCaptions=(int)(range / captionStep);
    }
    while (nrCaptions * PlotView.CAPTIONWHITESPACE * 2 > space) {
      captionStep*=2;
      nrCaptions=(int)(range / captionStep);
    }
    firstLabel=sigVal;
    while (firstLabel > min + captionStep * 1.2d)     firstLabel-=captionStep;
  }
 else {
    nrCaptions=space / (PlotView.CAPTIONWHITESPACE);
    if (nrCaptions > nrCats)     nrCaptions=nrCats;
    captionStep=1.0d / (nrCaptions - 1);
  }
}
