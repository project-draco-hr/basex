{
  final Type t=jType(o.getClass());
  if (t != Type.JAVA)   return t;
  if (o instanceof Element)   return Type.ELM;
  if (o instanceof Document)   return Type.DOC;
  if (o instanceof Attr)   return Type.ATT;
  if (o instanceof Comment)   return Type.COM;
  if (o instanceof ProcessingInstruction)   return Type.PI;
  if (o instanceof Text)   return Type.TXT;
  if (o instanceof Duration) {
    final QName type=((Duration)o).getXMLSchemaType();
    if (type == DatatypeConstants.DURATION_DAYTIME)     return Type.DTD;
    if (type == DatatypeConstants.DURATION_YEARMONTH)     return Type.YMD;
    if (type == DatatypeConstants.DURATION)     return Type.DUR;
  }
  if (o instanceof XMLGregorianCalendar) {
    final QName type=((XMLGregorianCalendar)o).getXMLSchemaType();
    if (type == DatatypeConstants.DATE)     return Type.DAT;
    if (type == DatatypeConstants.DATETIME)     return Type.DTM;
    if (type == DatatypeConstants.TIME)     return Type.TIM;
    if (type == DatatypeConstants.GYEARMONTH)     return Type.YMO;
    if (type == DatatypeConstants.GMONTHDAY)     return Type.MDA;
    if (type == DatatypeConstants.GYEAR)     return Type.YEA;
    if (type == DatatypeConstants.GMONTH)     return Type.MON;
    if (type == DatatypeConstants.GDAY)     return Type.DAY;
  }
  return null;
}
