{
  this.req=req;
  method=Method.valueOf(req.getMethod());
  String u=req.getRequestURL().toString();
  if (u.indexOf("%") != -1) {
    try {
      final String enc=req.getCharacterEncoding();
      final String ud=URLDecoder.decode(u,enc == null ? Strings.UTF8 : enc);
      u=ud.contains("\uFFFD") ? URLDecoder.decode(u,"ISO-8859-1") : ud;
    }
 catch (    final Exception ignore) {
      Util.debug(ignore);
    }
  }
  url=u;
}
