{
  final int ar=exprs.length - 1;
  final Expr f=exprs[ar];
  final Type t=f.seqType().type;
  if (t instanceof FuncType) {
    final FuncType ft=(FuncType)t;
    if (ft.argTypes != null && ft.argTypes.length != ar) {
      final Expr e=f instanceof FuncItem ? ((FuncItem)f).expr : f;
      throw INVARITY_X_X_X_X.get(info,e,ar,ar == 1 ? "" : "s",ft.argTypes.length);
    }
    if (ft.retType != null)     seqType=ft.retType;
  }
  if (f instanceof XQFunctionExpr) {
    if (allAreValues() && f instanceof Map)     return optPre(value(qc),qc);
    if (!(f instanceof FuncItem && comesFrom((FuncItem)f)) && !updating) {
      final Expr[] args=Arrays.copyOf(exprs,ar);
      final Expr inl=((XQFunctionExpr)f).inlineExpr(args,qc,scp,info);
      if (inl != null)       return inl;
    }
  }
 else   if (f instanceof Item && !(f instanceof FItem)) {
    throw INVFUNCITEM_X.get(info,((Item)f).type,f);
  }
  return this;
}
