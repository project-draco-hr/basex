{
  if (c != prop.is(Prop.COMPPLAN))   return;
  BufferOutput bo=null;
  try {
    if (prop.is(Prop.DOTPLAN)) {
      final String path=context.prop.get(Prop.QUERYPATH);
      final String dot=path.isEmpty() ? "plan.dot" : new IOFile(path).name().replaceAll("\\..*?$",".dot");
      bo=new BufferOutput(dot);
      final DOTSerializer d=new DOTSerializer(bo,prop.is(Prop.DOTCOMPACT));
      d.serialize(qp.plan());
      d.close();
      if (prop.is(Prop.DOTDISPLAY))       new ProcessBuilder(prop.get(Prop.DOTTY),dot).start();
    }
    if (prop.is(Prop.XMLPLAN)) {
      info(NL + QUERY_PLAN_C);
      info(qp.plan().serialize().toString());
    }
  }
 catch (  final Exception ex) {
    Util.stack(ex);
  }
 finally {
    if (bo != null)     try {
      bo.close();
    }
 catch (    final IOException ignored) {
    }
  }
}
