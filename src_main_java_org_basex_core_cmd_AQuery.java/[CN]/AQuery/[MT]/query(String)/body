{
  final int runs=Math.max(1,prop.num(Prop.RUNS));
  String err=null;
  try {
    final boolean ser=prop.is(Prop.SERIALIZE);
    long hits=0;
    int updates=0;
    for (int i=0; i < runs; ++i) {
      final Performance per=new Performance();
      qp=new QueryProcessor(query,context);
      progress(qp);
      qp.parse();
      pars+=per.getTime();
      if (i == 0)       plan(false);
      qp.compile();
      comp+=per.getTime();
      if (i == 0)       plan(true);
      final PrintOutput po=i == 0 && ser ? out : new NullOutput(!ser);
      XMLSerializer xml;
      if (context.prop.is(Prop.CACHEQUERY)) {
        result=qp.execute();
        eval+=per.getTime();
        xml=qp.getSerializer(po);
        result.serialize(xml);
        hits=result.size();
      }
 else {
        final Iter ir=qp.iter();
        eval+=per.getTime();
        hits=0;
        Item it=ir.next();
        xml=qp.getSerializer(po);
        while (it != null) {
          checkStop();
          xml.openResult();
          it.serialize(xml);
          xml.closeResult();
          it=ir.next();
          ++hits;
        }
      }
      updates=qp.updates();
      xml.close();
      qp.close();
      prnt+=per.getTime();
    }
    if (prop.is(Prop.QUERYINFO))     evalInfo(query,hits,updates,runs);
    out.flush();
    return info(NL + QUERYEXEC,perf.getTimer(runs));
  }
 catch (  final QueryException ex) {
    Util.debug(ex);
    err=ex.getMessage();
  }
catch (  final IOException ex) {
    Util.debug(ex);
    err=ex.getMessage();
  }
catch (  final ProgressException ex) {
    err=PROGERR;
  }
  if (qp != null)   try {
    qp.close();
  }
 catch (  final IOException ex) {
  }
  error(err);
  if (Util.debug) {
    info(NL);
    info(QUERYSTRING + query);
    info(qp.info());
  }
  return false;
}
