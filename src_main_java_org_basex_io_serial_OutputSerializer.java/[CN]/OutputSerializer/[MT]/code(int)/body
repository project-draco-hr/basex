{
  if (!format) {
    printChar(ch);
  }
 else   if (ch < ' ' && ch != '\n' && ch != '\t' || ch >= 0x7F && ch < 0xA0) {
    hex(ch);
  }
 else   if (ch == '&') {
    print(E_AMP);
  }
 else   if (ch == '>') {
    print(E_GT);
  }
 else   if (ch == '<') {
    print(E_LT);
  }
 else   if (ch == 0x2028) {
    print(E_2028);
  }
 else {
    printChar(ch);
  }
}
