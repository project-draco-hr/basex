{
  mode=type;
  if (fd != null) {
    if (type == Mode.OPENDIR)     fd.setFile(" ");
    fd.setMode(type == Mode.SAVE ? FileDialog.SAVE : FileDialog.LOAD);
    fd.setVisible(true);
    return fd.getFile() != null;
  }
  int state=0;
switch (type) {
case OPEN:
    state=fc.showOpenDialog(gui);
  break;
case OPENDIR:
fc.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);
state=fc.showOpenDialog(gui);
break;
case SAVE:
state=fc.showSaveDialog(gui);
break;
case DIR:
fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
state=fc.showDialog(gui,null);
break;
}
if (state != JFileChooser.APPROVE_OPTION) return false;
if (mode == Mode.SAVE) {
final IO file=getFile();
if (mode == Mode.SAVE && file.exists()) {
final int i=JOptionPane.showConfirmDialog(gui,BaseX.info(FILEREPLACE,file.name()),DIALOGINFO,JOptionPane.YES_NO_OPTION);
if (i == JOptionPane.NO_OPTION) return false;
}
}
return true;
}
