{
  final boolean empty=fpre + pos == 0;
  if (empty)   pos++;
  flush();
  os.close();
  final DataOutput out=new DataOutput(meta.dbfile(file + 'i'));
  try {
    out.writeNum(pages.size());
    out.writeNum(empty ? 0 : pages.size());
    out.writeNums(fpres.toArray());
    out.writeNums(pages.toArray());
  }
  finally {
    out.close();
  }
}
