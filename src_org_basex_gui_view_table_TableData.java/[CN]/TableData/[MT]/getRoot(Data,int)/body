{
  if (pre == -1)   return -1;
  int p=pre;
  int k=data.kind(p);
  while (p != -1 && (k != Data.ELEM || data.tagID(p) != root)) {
    p=data.parent(p,k);
    k=p != -1 ? data.kind(p) : 0;
  }
  return p;
}
