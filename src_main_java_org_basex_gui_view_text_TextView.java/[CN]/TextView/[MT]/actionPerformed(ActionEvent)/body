{
  final BaseXFileChooser fc=new BaseXFileChooser(SAVE_AS,gui.gprop.get(GUIProp.SAVEPATH),gui);
  final IO file=fc.select(BaseXFileChooser.Mode.FSAVE);
  if (file == null)   return;
  gui.gprop.set(GUIProp.SAVEPATH,file.path());
  PrintOutput out=null;
  try {
    out=new PrintOutput(file.toString());
    if (cmd != null) {
      cmd.execute(gui.context,out);
    }
 else     if (ns != null) {
      ns.serialize(Serializer.get(out));
    }
 else {
      final byte[] txt=area.getText();
      for (      final byte t : txt)       if (t < 0 || t > ' ' || Token.ws(t))       out.write(t);
    }
  }
 catch (  final IOException ex) {
    Dialog.error(gui,FILE_NOT_SAVED);
  }
 finally {
    if (out != null)     try {
      out.close();
    }
 catch (    final IOException ex) {
    }
  }
}
