{
  final BaseXFileChooser fc=new BaseXFileChooser(GUISAVEAS,gui.prop.get(GUIProp.SAVEPATH),gui);
  final IO file=fc.select(BaseXFileChooser.Mode.FSAVE);
  if (file == null)   return;
  gui.prop.set(GUIProp.SAVEPATH,file.path());
  PrintOutput out=null;
  try {
    out=new PrintOutput(file.toString());
    if (cmd != null) {
      cmd.exec(gui.context,out);
    }
 else     if (ns != null) {
      ns.serialize(new XMLSerializer(out));
    }
 else {
      final byte[] txt=area.getText();
      for (      final byte t : txt)       if (t < 0 || t > ' ' || Token.ws(t))       out.write(t);
    }
  }
 catch (  final IOException ex) {
    Dialog.error(gui,NOTSAVED);
  }
 finally {
    try {
      if (out != null)       out.close();
    }
 catch (    final IOException ex) {
    }
  }
}
