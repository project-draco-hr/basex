{
  xml.openElement(token("topic"),token("topic-id"),token(tid[q]),token("total_time_ms"),token(qtimes[q]));
  Item a;
  int r=1;
  while (res != null && (a=res.next()) != null) {
    if (r == k)     break;
    final Item b=res.next();
    if (a instanceof Str && b != null && b instanceof Dbl) {
      xml.openElement(token("result"));
      xml.openElement(token("file"));
      xml.text(token("pages"));
      xml.closeElement();
      xml.openElement(token("path"));
      xml.text(a.str());
      xml.closeElement();
      xml.openElement(token("rank"));
      xml.text(token(r++));
      xml.closeElement();
      xml.openElement(token("rsv"));
      xml.text(b.str());
      xml.closeElement();
      xml.closeElement();
    }
  }
  xml.closeElement();
}
