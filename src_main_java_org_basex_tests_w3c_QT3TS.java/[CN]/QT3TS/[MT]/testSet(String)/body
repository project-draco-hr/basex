{
  final XQuery qdoc=new XQuery("doc(' " + path + '/'+ name+ "')",ctx);
  final XQValue doc=qdoc.value();
  final String base=IO.get(doc.getBaseURI()).dir();
  final XQuery qset=new XQuery("*:test-set",ctx).context(doc);
  final XQValue set=qset.value();
  qdoc.close();
  if (supported(set)) {
    final XQuery qenv=new XQuery("*:environment",ctx).context(set);
    final ObjList<QT3Env> envs=new ObjList<QT3Env>();
    for (    final XQItem ienv : qenv)     envs.add(new QT3Env(ctx,ienv));
    qenv.close();
    final XQuery qts=new XQuery("*:test-case",ctx).context(set);
    for (    final XQItem its : qts)     testCase(its,envs,base);
    qts.close();
  }
  qset.close();
}
