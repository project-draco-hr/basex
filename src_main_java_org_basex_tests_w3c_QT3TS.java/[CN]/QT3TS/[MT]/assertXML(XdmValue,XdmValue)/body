{
  final String file=asString("@file",expect);
  final boolean norm=asBoolean("@normalize-space=('true','1')",expect);
  final boolean pref=asBoolean("@ignore-prefixes=('true','1')",expect);
  try {
    String exp=normNL(file.isEmpty() ? expect.getString() : string(new IOFile(baseDir,file).read()));
    if (norm)     exp=string(norm(token(exp)));
    final String res=normNL(asString("serialize(., map{ 'indent':='no' })",value));
    if (exp.equals(res))     return null;
    final String r=normNL(asString("serialize(., map{ 'indent':='no', 'omit-xml-declaration':='no' })",value));
    if (exp.equals(r))     return null;
    String flags="'" + Flag.ALLNODES + "'";
    if (!pref)     flags+=",'" + Flag.NAMESPACES + "'";
    final String query=Function.DEEP_EQUAL_OPT.args("<X>" + exp + "</X>","<X>" + res + "</X>","(" + flags + ")");
    return asBoolean(query,expect) ? null : exp;
  }
 catch (  final IOException ex) {
    return Util.message(ex);
  }
}
