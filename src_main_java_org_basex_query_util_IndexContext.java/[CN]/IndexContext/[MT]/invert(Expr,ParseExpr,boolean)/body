{
  if (ex instanceof Context) {
    if (text)     return root;
    if (step.test.name == null)     return root;
    final AxisStep as=AxisStep.get(step.info,Axis.SELF,step.test);
    return Path.get(root.info,root,as);
  }
  final AxisPath orig=(AxisPath)ex;
  final AxisPath path=orig.invertPath(root,step);
  if (!text) {
    final AxisStep s=orig.step(orig.steps.length - 1);
    if (s.test.name != null) {
      Expr[] steps={AxisStep.get(s.info,Axis.SELF,s.test)};
      for (      final Expr e : path.steps)       steps=Array.add(steps,e);
      path.steps=steps;
    }
  }
  return path;
}
