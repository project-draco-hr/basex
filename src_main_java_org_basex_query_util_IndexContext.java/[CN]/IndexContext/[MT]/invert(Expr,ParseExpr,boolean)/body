{
  if (ex instanceof Context) {
    if (text)     return root;
    if (step.test.name == null)     return root;
    final Step as=Step.get(step.info,Axis.SELF,step.test);
    return Path.get(root.info,root,as);
  }
  final AxisPath orig=(AxisPath)ex;
  final AxisPath path=orig.invertPath(root,step);
  if (!text) {
    final Step s=orig.step(orig.steps.length - 1);
    if (s.test.name != null) {
      Expr[] steps={Step.get(s.info,Axis.SELF,s.test)};
      for (      final Expr e : path.steps)       steps=Array.add(steps,e);
      path.steps=steps;
    }
  }
  return path;
}
