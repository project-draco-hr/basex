{
  final XQuery query=new XQuery("\n" + "               <result>{\n" + "                 for $book in $books-doc/*/book\n"+ "                 let $author-list := fn:string-join($book/author, ', ')\n"+ "                 group by $author-list\n"+ "                 order by $author-list\n"+ "                 return\n"+ "                   <author-list names=\"{$author-list}\">{\n"+ "                     for $b in $book\n"+ "                     order by $b/title\n"+ "                     return\n"+ "                       <title> {fn:data($b/title)} </title>\n"+ "                   }</author-list>\n"+ "               }</result>\n"+ "      ",ctx);
  query.bind("$products-doc",node(file("prod/GroupByClause/products.xml")));
  query.bind("$sales-records-doc",node(file("prod/GroupByClause/sales-records.xml")));
  query.bind("$stores-doc",node(file("prod/GroupByClause/stores.xml")));
  query.bind("$books-doc",node(file("prod/GroupByClause/books.xml")));
  final QT3Result res=result(query);
  result=res;
  test(assertSerialization("<result><author-list names=\"Alan Simon\"><title>Strategic Database Technology</title></author-list><author-list names=\"Jim Melton\"><title>Advanced SQL:1999</title></author-list><author-list names=\"Jim Melton, Alan Simon\"><title>SQL:1999</title></author-list><author-list names=\"Jim Melton, Andrew Eisenberg\"><title>Understanding SQL and Java Together</title></author-list><author-list names=\"Jim Melton, Stephen Buxton\"><title>Querying XML</title></author-list></result>",false));
}
