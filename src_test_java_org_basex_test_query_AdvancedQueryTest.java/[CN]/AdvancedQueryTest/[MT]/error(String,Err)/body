{
  final QueryProcessor qp=new QueryProcessor(query,context);
  qp.ctx.sc.baseURI(".");
  try {
    final ArrayOutput ao=new ArrayOutput();
    final Serializer ser=qp.getSerializer(ao);
    qp.execute().serialize(ser);
    ser.close();
    final String res=ao.toString().replaceAll("(\\r|\\n)+ *","");
    final StringBuilder sb=new StringBuilder("Query did not fail:\n");
    sb.append(query + "\n[E]");
    for (    final Err e : error)     sb.append(" " + e);
    fail(sb.append("\n[F] " + res).toString());
  }
 catch (  final Exception ex) {
    check(query,ex,error);
  }
 finally {
    qp.close();
  }
}
