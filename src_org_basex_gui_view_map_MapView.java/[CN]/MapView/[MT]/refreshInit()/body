{
  if (painter != null)   painter.close();
  painter=null;
  mainRects=null;
  focused=null;
  textLen=null;
  zoomStep=0;
  final Data data=gui.context.data();
  final GUIProp gprop=gui.prop;
  if (data != null && getWidth() != 0) {
    if (!visible())     return;
    painter=data.fs != null ? new MapFS(this,data.fs,gprop) : new MapDefault(this,gprop);
    mainMap=createImage();
    zoomMap=createImage();
    if (gprop.is(GUIProp.MAPINTERACTION))     hugeMap=new BufferedImage(fkt * getWidth(),fkt * getHeight(),BufferedImage.TYPE_INT_BGR);
    refreshLayout();
    repaint();
  }
}
