{
  final int w=getWidth(), h=getHeight();
  final ViewRect rect=new ViewRect(0,0,w,h,0,0);
  rectn=rect;
  mainRects=new ArrayList<ViewRect>();
  final Nodes nodes=gui.context.current();
  calc(rect,mainRects,nodes,mainMap);
  if (GUIProp.mapinfo) {
    final Data data=gui.context.data();
    nnn=mainRects.size();
    aaro=oldRects != null ? MapLayout.aar(oldRects,data) : 0;
    aarn=MapLayout.aar(mainRects,data);
    distance=5d;
    infoinit=true;
    if (mapInfo != null) {
      mapInfo.setValues(nno,nnn,recto,rect,aaro,aarn,distance);
      mapInfo.validate();
    }
  }
  oldRects=new ArrayList<ViewRect>();
  oldRects=(ArrayList<ViewRect>)mainRects.clone();
  recto=new ViewRect(0,0,w,h);
  nno=oldRects != null ? oldRects.size() : 0;
  repaint();
}
