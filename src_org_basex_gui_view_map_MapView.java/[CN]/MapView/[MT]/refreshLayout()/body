{
  final int w=getWidth(), h=getHeight();
  final MapRect rect=new MapRect(0,0,w,h,0,0);
  mainRects=new ArrayList<MapRect>();
  rectn=rect;
  mainRects=new ArrayList<MapRect>();
  final Nodes nodes=gui.context.current();
  calc(rect,mainRects,nodes,mainMap);
  if (GUIProp.mapinfo) {
    nnn=mainRects.size();
    distance=0;
    infoinit=true;
    if (mapInfo != null) {
      aaro=(oldRects != null) ? MapLayout.aar(oldRects) : 0;
      aarn=MapLayout.aar(mainRects);
      mapInfo.setValues(nno,nnn,recto,rect,aaro,aarn,distance);
      mapInfo.validate();
    }
  }
  oldRects=new ArrayList<MapRect>();
  oldRects=(ArrayList<MapRect>)mainRects.clone();
  recto=new MapRect(0,0,w,h);
  nno=oldRects != null ? oldRects.size() : 0;
  repaint();
}
