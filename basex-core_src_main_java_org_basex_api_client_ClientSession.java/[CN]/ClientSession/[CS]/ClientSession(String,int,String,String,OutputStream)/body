{
  super(output);
  ehost=host;
  socket=new Socket();
  try {
    socket.connect(new InetSocketAddress(host,port),5000);
  }
 catch (  final IllegalArgumentException ex) {
    throw new BaseXException(ex);
  }
  sin=socket.getInputStream();
  final BufferInput bi=new BufferInput(sin);
  final String ts=bi.readString();
  sout=PrintOutput.get(socket.getOutputStream());
  send(username);
  send(Strings.md5(Strings.md5(password) + ts));
  sout.flush();
  if (!ok(bi))   throw new LoginException();
}
