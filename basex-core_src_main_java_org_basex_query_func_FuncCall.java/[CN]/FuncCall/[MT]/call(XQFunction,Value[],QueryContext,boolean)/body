{
  final int calls=ctx.tailCalls, max=ctx.maxCalls;
  if (tailCall && max >= 0 && ++ctx.tailCalls >= max) {
    throw new Continuation(fun,arg);
  }
  try {
    if (tailCall)     return itm ? fun.invItem(ctx,info,arg) : fun.invValue(ctx,info,arg);
    XQFunction func=fun;
    Value[] args=arg;
    for (; ; ) {
      try {
        return itm ? func.invItem(ctx,info,args) : func.invValue(ctx,info,args);
      }
 catch (      final Continuation c) {
        func=c.getFunc();
        args=c.getArgs();
        ctx.tailCalls=calls;
      }
    }
  }
 catch (  final QueryException ex) {
    ex.add(info);
    throw ex;
  }
 finally {
    ctx.tailCalls=calls;
  }
}
