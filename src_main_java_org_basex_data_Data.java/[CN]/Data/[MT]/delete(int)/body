{
  meta.update();
  int k=kind(pre);
  final int s=size(pre,k);
  resources.delete(pre,s);
  if (meta.updindex) {
    indexDelete(pre,s);
  }
  if (k != DOC && k != ELEM)   delete(pre,k != ATTR);
  int par=pre;
  if (k == ATTR) {
    par=parent(par,ATTR);
    attSize(par,ELEM,attSize(par,ELEM) - 1);
    size(par,ELEM,size(par,ELEM) - 1);
    k=kind(par);
  }
  while (par > 0 && k != DOC) {
    par=parent(par,k);
    k=kind(par);
    size(par,k,size(par,k) - s);
  }
  if (kind(pre) == DOC)   --meta.ndocs;
  if (meta.updindex) {
    idmap.delete(pre,id(pre),-s);
  }
  table.delete(pre,s);
  if (!cache)   updateDist(pre,-s);
  nspaces.delete(pre,s,this);
}
