{
  DropDB.drop(name,mprop);
  mprop.dbpath(name).mkdirs();
  final IO file=parser.src;
  meta=new MetaData(name,prop,mprop);
  meta.original=file != null ? file.path() : "";
  meta.filesize=file != null ? file.length() : 0;
  meta.time=System.currentTimeMillis();
  meta.dirty=true;
  final Runtime rt=Runtime.getRuntime();
  int bs=(int)Math.min(meta.filesize,Math.min(1 << 22,rt.maxMemory() - rt.freeMemory() >> 2));
  bs=Math.max(IO.BLOCKSIZE,bs - bs % IO.BLOCKSIZE);
  tout=new DataOutput(new TableOutput(meta,DATATBL));
  xout=new DataOutput(meta.dbfile(DATATXT),bs);
  vout=new DataOutput(meta.dbfile(DATAATV),bs);
  sout=new DataOutput(meta.dbfile(DATATMP),bs);
  parse();
  close();
  final TableAccess ta=new TableDiskAccess(meta,DATATBL);
  final DataInput in=new DataInput(meta.dbfile(DATATMP));
  for (; spos < ssize; ++spos)   ta.write4(in.readNum(),8,in.readNum());
  ta.close();
  in.close();
  meta.dbfile(DATATMP).delete();
  return new DiskData(meta,tags,atts,path,ns);
}
