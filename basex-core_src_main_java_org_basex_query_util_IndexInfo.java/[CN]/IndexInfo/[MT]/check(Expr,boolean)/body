{
  orig=ex;
  Step s=step;
  if (!(ex instanceof Context)) {
    if (!(ex instanceof AxisPath))     return false;
    final AxisPath path=(AxisPath)ex;
    if (path.root != null)     return false;
    s=path.step(path.steps.length - 1);
  }
  final Data data=ic.data;
  final boolean elem=s.test.type == NodeType.ELM;
  if (elem) {
    if (!data.meta.uptodate || data.nspaces.size() != 0 || s.test.kind != Kind.NAME)     return false;
    name=s.test.name.local();
    final Stats stats=data.elemNames.stat(data.elemNames.id(name));
    if (stats == null || !stats.isLeaf())     return false;
  }
  if (ft)   return (elem || s.test.type == NodeType.TXT) && data.meta.ftxtindex;
  text=(elem || s.test.type == NodeType.TXT) && data.meta.textindex;
  attr=!text && s.test.type == NodeType.ATT && data.meta.attrindex;
  return text || attr;
}
