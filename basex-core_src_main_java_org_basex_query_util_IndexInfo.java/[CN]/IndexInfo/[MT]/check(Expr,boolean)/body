{
  pred=pr;
  final Step last=lastStep();
  if (last == null)   return false;
  final Data data=ic.data;
  final boolean elem=last.test.type == NodeType.ELM;
  if (elem) {
    if (!(data.meta.uptodate && data.nspaces.isEmpty() && last.test.kind == Kind.NAME))     return false;
    test=(NameTest)last.test;
    final Stats stats=data.elemNames.stat(data.elemNames.id(test.name.local()));
    if (stats == null || !stats.isLeaf())     return false;
  }
  text=elem || last.test.type == NodeType.TXT;
  final IndexNames in=new IndexNames(ft ? IndexType.FULLTEXT : text ? IndexType.TEXT : IndexType.ATTRIBUTE,data);
  if (!in.contains(qname()))   return false;
  if (ft)   return text && data.meta.ftindex;
  if (text)   return data.meta.textindex;
  return last.test.type == NodeType.ATT && data.meta.attrindex;
}
