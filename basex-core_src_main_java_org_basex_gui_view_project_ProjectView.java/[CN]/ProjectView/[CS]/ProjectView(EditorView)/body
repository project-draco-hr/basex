{
  super(ev.gui);
  view=ev;
  setLayout(new BorderLayout());
  final DefaultMutableTreeNode invisible=new DefaultMutableTreeNode();
  tree=new BaseXTree(invisible,gui).border(4,4,4,4);
  renderer=new ProjectCellRenderer();
  tree.setExpandsSelectedPaths(true);
  tree.setCellRenderer(renderer);
  tree.addTreeWillExpandListener(this);
  tree.addKeyListener(new KeyAdapter(){
    @Override public void keyPressed(    final KeyEvent e){
      if (BaseXKeys.REFRESH.is(e)) {
        new RefreshCmd().execute(gui);
      }
 else       if (BaseXKeys.DELNEXT.is(e)) {
        new DeleteCmd().execute(gui);
      }
 else       if (BaseXKeys.NEWDIR.is(e)) {
        new NewCmd().execute(gui);
      }
    }
    @Override public void keyTyped(    final KeyEvent e){
      if (BaseXKeys.SHIFT_ENTER.is(e)) {
        new OpenExternalCmd().execute(gui);
      }
 else       if (BaseXKeys.ENTER.is(e)) {
        new OpenCmd().execute(gui);
      }
    }
  }
);
  tree.addMouseListener(new MouseAdapter(){
    @Override public void mousePressed(    final MouseEvent e){
      if (SwingUtilities.isLeftMouseButton(e) && e.getClickCount() == 2)       new OpenCmd().execute(gui);
    }
  }
);
  tree.setCellEditor(new ProjectCellEditor(tree,renderer));
  tree.setEditable(true);
  root=new ProjectDir(new IOFile(root()),this);
  invisible.add(root);
  for (int r=0; r < 2; r++)   tree.expandRow(r);
  tree.setRootVisible(false);
  tree.setSelectionRow(0);
  new BaseXPopup(tree,gui,new OpenCmd(),new OpenExternalCmd(),null,new DeleteCmd(),new RenameCmd(),new NewCmd(),null,new RefreshCmd());
  scroll=new JScrollPane(tree);
  scroll.setBorder(new EmptyBorder(0,0,0,0));
  list=new ProjectList(this);
  BaseXLayout.addInteraction(list,gui);
  final BaseXBack back=new BaseXBack().layout(new BorderLayout(2,2));
  back.setBorder(new CompoundBorder(new MatteBorder(0,0,1,0,GUIConstants.GRAY),new EmptyBorder(3,1,3,2)));
  path=new BaseXTextField(gui);
  path.setText(root.file.path());
  path.setEnabled(false);
  filter=new ProjectFilter(this);
  final BaseXButton browse=new BaseXButton(DOTS,gui);
  browse.setMargin(new Insets(0,2,0,2));
  browse.setToolTipText(CHOOSE_DIR);
  browse.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    final ActionEvent e){
      change();
    }
  }
);
  back.add(path,BorderLayout.CENTER);
  back.add(browse,BorderLayout.EAST);
  back.add(filter,BorderLayout.SOUTH);
  add(back,BorderLayout.NORTH);
  add(scroll,BorderLayout.CENTER);
}
