{
  checkAdmin(qc);
  final ValueBuilder vb=new ValueBuilder();
  final boolean global=exprs.length == 0;
  for (  final User u : global ? qc.context.users.users(null) : checkData(qc).meta.users.users(qc.context.users)) {
    final String perm=u.perm().toString().toLowerCase(Locale.ENGLISH);
    final FElem user=new FElem(USER).add(NAME,u.name()).add(PERMISSION,perm);
    if (global) {
      for (      final Entry<Algorithm,EnumMap<Code,String>> codes : u.alg().entrySet()) {
        final FElem password=new FElem(PASSWORD).add(ALGORITHM,codes.getKey().toString());
        for (        final Entry<Code,String> code : codes.getValue().entrySet()) {
          password.add(new FElem(code.getKey().toString()).add(code.getValue()));
        }
        user.add(password);
      }
    }
    vb.add(user);
  }
  return vb;
}
