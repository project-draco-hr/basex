{
  int s=steps.length;
  final Expr[] e=new Expr[s--];
  final Expr rt=step(s).preds.length != 0 ? new Filter(input,r,step(s).preds) : r;
  int c=0;
  while (--s >= 0) {
    e[c++]=AxisStep.get(input,step(s + 1).axis.invert(),step(s).test,step(s).preds);
  }
  e[c]=AxisStep.get(input,step(s + 1).axis.invert(),curr.test);
  return new AxisPath(input,rt,e);
}
