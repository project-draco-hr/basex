{
  size=size(ctx);
  type=size != -1 ? SeqType.get(Type.NOD,size) : step[step.length - 1].type();
  if (root == null || root.uses(Use.VAR) || root.duplicates())   return false;
  for (int i=0; i < step.length; ++i) {
switch (step[i].axis) {
case ANC:
case ANCORSELF:
case PREC:
case PRECSIBL:
      return false;
case DESC:
case DESCORSELF:
case FOLL:
case FOLLSIBL:
    return i + 1 == step.length;
default :
}
}
return true;
}
