{
  final Value rt=root(ctx);
  final Data data=rt != null && rt.type == Type.DOC && rt instanceof DBNode ? ((DBNode)rt).data : null;
  if (data == null || !data.meta.pthindex || !data.meta.uptodate || data.ns.size() != 0)   return -1;
  ArrayList<PathNode> nodes=data.path.root();
  for (  final AxisStep s : step) {
    nodes=s.size(nodes,data);
    if (nodes == null)     return -1;
  }
  long sz=0;
  for (  final PathNode pn : nodes)   sz+=pn.size;
  return sz;
}
