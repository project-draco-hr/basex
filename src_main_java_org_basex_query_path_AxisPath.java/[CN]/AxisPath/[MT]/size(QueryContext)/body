{
  final Value rt=root(ctx);
  final Data data=rt != null && rt.type == NodeType.DOC && rt instanceof DBNode ? ((DBNode)rt).data : null;
  if (data == null || !data.meta.pathindex || !data.meta.uptodate || !data.single())   return -1;
  ArrayList<PathNode> nodes=data.pthindex.root();
  for (  final AxisStep s : step) {
    nodes=s.size(nodes,data);
    if (nodes == null)     return -1;
  }
  long sz=0;
  for (  final PathNode pn : nodes)   sz+=pn.size;
  return sz;
}
