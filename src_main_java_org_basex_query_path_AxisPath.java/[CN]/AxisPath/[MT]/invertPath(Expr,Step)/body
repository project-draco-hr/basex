{
  int s=step.length;
  final Step[] e=new Step[s--];
  final Expr rt=step[s].pred.length != 0 ? new Pred(input,r,step[s].pred) : r;
  int c=0;
  while (--s >= 0) {
    e[c++]=Step.get(input,step[s + 1].axis.invert(),step[s].test,step[s].pred);
  }
  e[c]=Step.get(input,step[s + 1].axis.invert(),curr.test);
  return new AxisPath(input,rt,e);
}
