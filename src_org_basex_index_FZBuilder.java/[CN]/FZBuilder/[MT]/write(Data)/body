{
  final String db=data.meta.dbname;
  final DataOutput outx=new DataOutput(db,DATAFTX + 'x');
  final DataOutput outy=new DataOutput(db,DATAFTX + 'y');
  final DataOutput outz=new DataOutput(db,DATAFTX + 'z');
  outx.write(isize);
  long dr=0;
  int c=0, tr=0;
  byte j=1;
  for (; j < tree.length; j++) {
    if (c == isize - 1)     break;
    final FZHash tre=tree[j];
    if (tre == null)     continue;
    outx.write(j);
    outx.writeInt(tr);
    tre.init();
    while (tre.more()) {
      int p=tre.next();
      byte[] key=tre.key();
      for (int x=0; x != j; x++)       outy.write(key[x]);
      outy.write5(dr);
      final int ds=tre.ns[p];
      outy.writeInt(ds);
      byte[] val=tre.pre[p];
      if (Prop.fcompress) {
        for (int z=4; z < val.length; z++)         outz.write(val[z]);
      }
 else {
        for (int v=0, ip=4; v < ds; ip+=Num.len(val,ip), v++)         outz.writeInt(Num.read(val,ip));
      }
      val=tre.pos[p];
      if (Prop.fcompress) {
        for (int z=4; z < val.length; z++)         outz.write(val[z]);
      }
 else {
        for (int v=0, ip=4; v < ds; ip+=Num.len(val,ip), v++)         outz.writeInt(Num.read(val,ip));
      }
      dr=outz.size();
      tr=(int)outy.size();
    }
    c++;
  }
  tree=null;
  outx.write((byte)(j - 1));
  outx.writeInt((int)(tr - j - 7L));
  outx.close();
  outy.close();
  outz.close();
}
