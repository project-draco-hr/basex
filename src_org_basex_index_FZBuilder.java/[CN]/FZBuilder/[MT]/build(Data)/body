{
  final Performance p=new Performance();
  total=data.size;
  for (id=0; id < total; id++) {
    checkStop();
    if (data.kind(id) == Data.TEXT)     index(data.text(id));
  }
  if (Prop.debug) {
    Performance.gc(5);
    System.out.println("Indexed: " + Performance.getMem() + ", "+ p);
  }
  write(data);
  if (Prop.debug) {
    Performance.gc(5);
    System.out.println("Written: " + Performance.getMem() + ", "+ p);
  }
  return new Fuzzy(data.meta.dbname);
}
