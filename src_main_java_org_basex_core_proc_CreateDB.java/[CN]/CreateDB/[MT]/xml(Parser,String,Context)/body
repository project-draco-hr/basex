{
  if (ctx.prop.is(Prop.MAINMEM))   return MemBuilder.build(parser,ctx.prop,db);
  if (ctx.pinned(db))   throw new IOException(Main.info(DBLOCKED,db));
  final Builder builder=new DiskBuilder(parser,ctx.prop);
  try {
    final Data data=builder.build(db);
    if (data.meta.txtindex)     data.setIndex(IndexType.TXT,new ValueBuilder(data,true).build());
    if (data.meta.atvindex)     data.setIndex(IndexType.ATV,new ValueBuilder(data,false).build());
    if (data.meta.ftxindex)     data.setIndex(IndexType.FTX,FTBuilder.get(data,data.meta.wildcards).build());
    data.close();
  }
 catch (  final IOException ex) {
    try {
      builder.close();
    }
 catch (    final IOException exx) {
      Main.debug(exx);
    }
    throw ex;
  }
  return Open.open(ctx,db);
}
