{
  do {
    final Resource l=waiting.removeFirst();
synchronized (l) {
      l.locked=false;
      l.notify();
    }
  }
 while (waiting.size() > 0 && waiting.getFirst().reader);
}
