{
  if (encoding == null)   return UTF8;
  final String e=encoding.toUpperCase(Locale.ENGLISH);
  if (eq(e,UTF8,UTF82))   return UTF8;
  if (e.equals(UTF16BE))   return UTF16BE;
  if (e.equals(UTF16LE))   return UTF16LE;
  if (eq(e,UTF16,UTF162))   return old == UTF16BE || old == UTF16LE ? old : UTF16BE;
  if (eq(e,UTF32,UTF322))   return UTF32;
  return encoding;
}
