{
  final QueryProcessor proc=name.equals(XPATH) ? new XPathProcessor(query) : new XQueryProcessor(query);
  try {
    if (id == null) {
      return new BXResourceSet(proc.query(coll.ctx.current()),coll);
    }
    return new BXResourceSet(proc.query(new Nodes(((BXXMLResource)coll.getResource(id)).getData())),coll);
  }
 catch (  final QueryException ex) {
    throw new XMLDBException(ErrorCodes.VENDOR_ERROR,ex.getMessage());
  }
catch (  final Exception ex) {
    BaseX.notexpected();
    return null;
  }
}
