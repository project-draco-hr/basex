{
  try {
    final QueryProcessor proc=name.equals(XPATH) ? new XPathProcessor(query) : new XQueryProcessor(query);
    return new BXResourceSet(proc.query(nodes),coll);
  }
 catch (  final QueryException ex) {
    throw new XMLDBException(ErrorCodes.VENDOR_ERROR,ex.getMessage());
  }
}
