{
  perf=new Performance();
  context=ctx;
  prop=ctx.prop;
  mprop=ctx.mprop;
  out=PrintOutput.get(os);
  try {
    return run();
  }
 catch (  final ProgressException ex) {
    abort();
    return error(PROGERR);
  }
catch (  final Throwable ex) {
    Performance.gc(2);
    abort();
    if (ex instanceof OutOfMemoryError) {
      Util.debug(ex);
      return error(PROCMEM + ((flags & (User.CREATE | User.WRITE)) != 0 ? PROCMEMCREATE : ""));
    }
    return error(Util.bug(ex));
  }
 finally {
    try {
      if (out != null)       out.flush();
    }
 catch (    final IOException ex) {
    }
  }
}
