{
  final String type=conn.getContentType();
  InputStream is=conn.getErrorStream();
  final boolean error=is != null;
  try {
    if (!error)     is=conn.getInputStream();
  }
 catch (  final IOException ex) {
    Util.debug(ex);
  }
  final ValueBuilder vb=new ValueBuilder();
  final FElem response=new FElem(Q_RESPONSE).declareNS();
  response.add(STATUS,token(conn.getResponseCode()));
  response.add(MESSAGE,conn.getResponseMessage());
  for (  final String header : conn.getHeaderFields().keySet()) {
    if (header != null) {
      final FElem hdr=new FElem(Q_HEADER);
      hdr.add(NAME,token(header));
      hdr.add(VALUE,conn.getHeaderField(header));
      response.add(hdr);
    }
  }
  vb.add(response);
  final boolean body=status == null || !Bln.parse(status,info);
  if (is != null) {
    final HTTPPayload hp=new HTTPPayload(is,body,info,options);
    response.add(hp.parse(error,type,utype));
    if (body)     vb.add(hp.payloads());
  }
  return vb;
}
