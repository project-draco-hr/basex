{
  final Auth a=HttpManager.request().getAuthorization();
  if (a != null)   http.credentials(a.getUser(),a.getPassword());
  try {
    final HttpServletRequest r=getRequest();
    Path p=Path.path(dbpath);
    if (!r.getContextPath().isEmpty())     p=p.getStripFirst();
    if (!r.getServletPath().isEmpty())     p=p.getStripFirst();
    if (p.isRoot())     return new BXRoot(service);
    final String db=p.getFirst();
    return p.getLength() == 1 ? service.dbExists(db) ? new BXDatabase(new ResourceMetaData(db,service.timestamp(db)),service) : null : service.resource(db,p.getStripFirst().toString());
  }
 catch (  final LoginException ex) {
    return BXNotAuthorizedResource.NOAUTH;
  }
catch (  final Exception ex) {
    Util.errln(ex);
  }
  return null;
}
