{
  if (context.data() == null)   return error(PROCNODB);
  try {
    final Data data=context.data();
    IndexToken.TYPE index=null;
    if (type.equals(TXT)) {
      data.meta.txtindex=true;
      index=IndexToken.TYPE.TXT;
    }
 else     if (type.equals(ATV)) {
      data.meta.atvindex=true;
      index=IndexToken.TYPE.ATV;
    }
 else     if (type.equals(FTX)) {
      data.meta.ftxindex=true;
      index=IndexToken.TYPE.FTX;
    }
 else {
      throw new IllegalArgumentException();
    }
    data.meta.finish(data.size);
    buildIndex(index,data);
    return inf ? info(DBINDEXED,perf.getTimer()) : true;
  }
 catch (  final IOException ex) {
    BaseX.debug(ex);
    return error(ex.getMessage());
  }
}
