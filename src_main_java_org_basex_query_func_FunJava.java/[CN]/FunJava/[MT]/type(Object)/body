{
  final Type t=type(o.getClass());
  if (t != AtomType.JAVA)   return t;
  if (o instanceof Element)   return NodeType.ELM;
  if (o instanceof Document)   return NodeType.DOC;
  if (o instanceof DocumentFragment)   return NodeType.DOC;
  if (o instanceof Attr)   return NodeType.ATT;
  if (o instanceof Comment)   return NodeType.COM;
  if (o instanceof ProcessingInstruction)   return NodeType.PI;
  if (o instanceof Text)   return NodeType.TXT;
  if (o instanceof Duration) {
    final Duration d=(Duration)o;
    return !d.isSet(YEARS) && !d.isSet(MONTHS) ? AtomType.DTD : !d.isSet(HOURS) && !d.isSet(MINUTES) && !d.isSet(SECONDS) ? AtomType.YMD : AtomType.DUR;
  }
  if (o instanceof XMLGregorianCalendar) {
    final QName type=((XMLGregorianCalendar)o).getXMLSchemaType();
    if (type == DATE)     return AtomType.DAT;
    if (type == DATETIME)     return AtomType.DTM;
    if (type == TIME)     return AtomType.TIM;
    if (type == GYEARMONTH)     return AtomType.YMO;
    if (type == GMONTHDAY)     return AtomType.MDA;
    if (type == GYEAR)     return AtomType.YEA;
    if (type == GMONTH)     return AtomType.MON;
    if (type == GDAY)     return AtomType.DAY;
  }
  return AtomType.JAVA;
}
