{
  final Type t=type(o.getClass());
  if (t != SimpleType.JAVA)   return t;
  if (o instanceof Element)   return NodeType.ELM;
  if (o instanceof Document)   return NodeType.DOC;
  if (o instanceof DocumentFragment)   return NodeType.DOC;
  if (o instanceof Attr)   return NodeType.ATT;
  if (o instanceof Comment)   return NodeType.COM;
  if (o instanceof ProcessingInstruction)   return NodeType.PI;
  if (o instanceof Text)   return NodeType.TXT;
  if (o instanceof Duration) {
    final Duration d=(Duration)o;
    return !d.isSet(YEARS) && !d.isSet(MONTHS) ? SimpleType.DTD : !d.isSet(HOURS) && !d.isSet(MINUTES) && !d.isSet(SECONDS) ? SimpleType.YMD : SimpleType.DUR;
  }
  if (o instanceof XMLGregorianCalendar) {
    final QName type=((XMLGregorianCalendar)o).getXMLSchemaType();
    if (type == DATE)     return SimpleType.DAT;
    if (type == DATETIME)     return SimpleType.DTM;
    if (type == TIME)     return SimpleType.TIM;
    if (type == GYEARMONTH)     return SimpleType.YMO;
    if (type == GMONTHDAY)     return SimpleType.MDA;
    if (type == GYEAR)     return SimpleType.YEA;
    if (type == GMONTH)     return SimpleType.MON;
    if (type == GDAY)     return SimpleType.DAY;
  }
  return null;
}
