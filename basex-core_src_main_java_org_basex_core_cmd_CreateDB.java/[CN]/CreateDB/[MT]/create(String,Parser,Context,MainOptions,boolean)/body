{
  if (!ctx.user.has(Perm.CREATE))   throw new BaseXException(PERM_REQUIRED_X,Perm.CREATE);
  if (mem)   return MemBuilder.build(name,parser);
  if (ctx.pinned(name))   throw new BaseXException(DB_PINNED_X,name);
  new DiskBuilder(name,parser,ctx.soptions,options).build().close();
  final Data data=Open.open(name,ctx,options);
  if (data.meta.createtext)   create(IndexType.TEXT,data,options,null);
  if (data.meta.createattr)   create(IndexType.ATTRIBUTE,data,options,null);
  if (data.meta.createftxt)   create(IndexType.FULLTEXT,data,options,null);
  return data;
}
