{
  if (!ctx.user.has(Perm.CREATE))   throw new BaseXException(PERM_REQUIRED_X,Perm.CREATE);
  if (mem)   return MemBuilder.build(name,parser);
  if (ctx.pinned(name))   throw new BaseXException(DB_PINNED_X,name);
  try (final DiskBuilder builder=new DiskBuilder(name,parser,ctx)){
    final Data data=builder.build();
    try {
      if (data.meta.createtext)       data.setIndex(IndexType.TEXT,new ValueIndexBuilder(data,true).build());
      if (data.meta.createattr)       data.setIndex(IndexType.ATTRIBUTE,new ValueIndexBuilder(data,false).build());
      if (data.meta.createftxt)       data.setIndex(IndexType.FULLTEXT,new FTBuilder(data).build());
    }
  finally {
      data.close();
    }
  }
   return Open.open(name,ctx);
}
