{
  if (inf)   compInfo(NL + QUERYCOMP);
  if (queryOpt != null) {
    for (    final Entry<String,String> e : queryOpt.entrySet()) {
      Set.set(e.getKey(),e.getValue(),context.prop);
    }
  }
  if (initExpr != null) {
    try {
      value=initExpr.value(this);
    }
 catch (    final QueryException ex) {
      if (ex.err() != XPNOCTX)       throw ex;
      CTXINIT.thrw(((ParseExpr)initExpr).input,ex.getMessage());
    }
  }
 else   if (nodes != null) {
    if (nodes.ftpos != null)     ftpos=new FTPosData();
    resource.compile(nodes);
  }
  if (value != null && initType != null) {
    value=initType.promote(value,this,null);
  }
  try {
    funcs.comp(this);
    root=root.comp(this);
  }
 catch (  final StackOverflowError ex) {
    Util.debug(ex);
    XPSTACK.thrw(null);
  }
  if (inf)   info.add(NL + QUERYRESULT + funcs+ root+ NL);
}
