{
  final SeqType r=expr.type();
  final SeqType retType=updating ? SeqType.EMP : ret == null || r.instanceOf(ret) ? r : ret;
  type=FuncType.get(ann,args,retType).seqType();
  size=1;
  try {
    for (    final Entry<Var,Value> e : staticBindings()) {
      final Var v=e.getKey();
      final Expr inlined=expr.inline(ctx,scope,v,v.checkType(e.getValue(),ctx,info,true));
      if (inlined != null)       expr=inlined;
    }
  }
 catch (  final QueryException qe) {
    expr=FNInfo.error(qe,ret != null ? ret : expr.type());
  }
 finally {
    scope.cleanUp(this);
  }
  return nonLocal.isEmpty() ? preEval(ctx) : this;
}
