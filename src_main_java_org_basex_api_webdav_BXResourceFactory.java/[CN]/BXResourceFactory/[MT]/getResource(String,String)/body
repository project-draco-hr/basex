{
  final Auth a=HttpManager.request().getAuthorization();
  final String u;
  final String p;
  if (a == null) {
    if (System.getProperty(DBUSER) == null)     return NOAUTH;
    u=System.getProperty(DBUSER);
    p=System.getProperty(DBPASS);
  }
 else {
    u=a.getUser();
    p=a.getPassword();
  }
  final Path path=Path.path(dbpath);
  if (path.isRoot())   return new BXAllDatabasesResource(this,u,p);
  final String db=path.getFirst();
  try {
    final Session s=login(u,p);
    try {
      return path.getLength() == 1 ? listDbs(s).contains(db) ? new BXDatabase(db,this,u,p) : null : resource(s,db,path.getStripFirst().toString(),u,p);
    }
  finally {
      s.close();
    }
  }
 catch (  Exception ex) {
    handle(ex);
  }
  return null;
}
