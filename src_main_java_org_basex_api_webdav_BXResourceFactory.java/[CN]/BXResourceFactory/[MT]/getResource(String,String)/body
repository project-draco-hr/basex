{
  final Auth a=HttpManager.request().getAuthorization();
  if (a == null && System.getProperty(DBUSER) == null)   return NOAUTH;
  final Path p=Path.path(dbpath);
  if (p.isRoot())   return new BXAllDatabasesResource(a.getUser(),a.getPassword());
  final String db=p.getFirst();
  try {
    final ClientSession s=login(a);
    try {
      if (p.getLength() == 1)       return listDatabases(s).contains(db) ? new BXDatabase(db) : null;
      return resource(s,db,stripLeadingSlash(p.getStripFirst().toString()));
    }
  finally {
      s.close();
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return null;
}
