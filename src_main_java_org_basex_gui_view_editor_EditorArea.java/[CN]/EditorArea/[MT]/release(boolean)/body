{
  final byte[] in=getText();
  final boolean eq=eq(in,last);
  if (eq && !force)   return;
  last=in;
  view.refresh(modified || !eq,false);
  threadID++;
  view.pos.setText(pos());
  gui.context.prop.set(Prop.QUERYPATH,file.path());
  if (file.isXML()) {
    view.info(OK,true);
    executable=false;
  }
 else {
    final String qu=in.length == 0 ? "()" : string(in);
    executable=!module(in);
    if (executable && (force || gui.gprop.is(GUIProp.EXECRT))) {
      gui.execute(true,new XQuery(qu));
    }
 else {
      final QueryContext ctx=new QueryContext(gui.context);
      try {
        if (!executable)         ctx.module(qu);
 else         ctx.parse(qu);
        view.info(OK,true);
      }
 catch (      final QueryException ex) {
        view.info(ex.getMessage(),false);
      }
    }
  }
}
