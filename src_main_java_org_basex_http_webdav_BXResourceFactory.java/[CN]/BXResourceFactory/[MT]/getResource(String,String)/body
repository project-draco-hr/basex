{
  final Auth a=HttpManager.request().getAuthorization();
  if (a != null)   http.credentials(a.getUser(),a.getPassword());
  try {
    final HttpServletRequest r=getRequest();
    Path p=Path.path(dbpath);
    if (!r.getContextPath().isEmpty())     p=p.getStripFirst();
    if (!r.getServletPath().isEmpty())     p=p.getStripFirst();
    if (p.isRoot())     return new BXRoot(http);
    final String db=p.getFirst();
    return p.getLength() == 1 ? dbExists(db,http) ? database(db,http) : null : resource(db,p.getStripFirst().toString(),http);
  }
 catch (  final LoginException ex) {
    return NOAUTH;
  }
catch (  final Exception ex) {
    Util.errln(ex);
  }
  return null;
}
