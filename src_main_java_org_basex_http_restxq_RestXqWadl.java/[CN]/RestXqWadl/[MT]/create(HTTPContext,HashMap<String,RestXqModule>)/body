{
  final FElem appl=new FElem("application",WADL).declareNS();
  final FElem ress=new FElem("resources",WADL);
  final String base=http.req.getRequestURL().toString().replaceAll(HTTPText.WADL,"");
  appl.add(ress.add("base",base));
  final TreeMap<String,FElem> map=new TreeMap<String,FElem>();
  for (  final RestXqModule mod : modules.values()) {
    for (    final RestXqFunction func : mod.functions()) {
      final FElem res=new FElem("resource",WADL);
      final String path=func.path.toString();
      res.add("path",path);
      map.put(path,res);
      final FElem method=new FElem("method",WADL);
      res.add(method.add("name",func.methods.toString().replaceAll("[^A-Z ]","")));
      final FElem request=new FElem("request",WADL);
      method.add(request);
      addParams(func.queryParams,"query",request);
      addParams(func.formParams,"query",request);
      addParams(func.headerParams,"header",request);
      final FElem response=new FElem("response",WADL);
      method.add(response);
      final FElem representation=new FElem("representation",WADL);
      response.add(representation.add("mediaType",HTTPContext.mediaType(func.output)));
    }
  }
  for (  final FElem elem : map.values())   ress.add(elem);
  final Serializer ser=Serializer.get(http.res.getOutputStream());
  ser.serialize(appl);
  ser.close();
}
