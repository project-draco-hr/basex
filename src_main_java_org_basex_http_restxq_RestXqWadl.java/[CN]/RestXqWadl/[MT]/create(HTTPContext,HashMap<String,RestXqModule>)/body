{
  final Atts ns=new Atts(Token.EMPTY,WADL);
  final FElem appl=new FElem(new QNm("application",WADL),ns);
  final FElem ress=new FElem(new QNm("resources",WADL));
  final String base=http.req.getRequestURL().toString().replaceAll(HTTPText.WADL,"");
  appl.add(ress.add(new QNm("base"),base));
  final TreeMap<String,FElem> map=new TreeMap<String,FElem>();
  for (  final RestXqModule mod : modules.values()) {
    for (    final RestXqFunction func : mod.functions()) {
      final FElem res=new FElem(new QNm("resource",WADL));
      final String path=func.path.toString();
      res.add(new QNm("path"),path);
      map.put(path,res);
      final FElem method=new FElem(new QNm("method",WADL));
      final String mths=func.methods.toString().replaceAll("[^A-Z ]","");
      res.add(method.add(new QNm("name"),mths));
      final FElem request=new FElem(new QNm("request",WADL));
      method.add(request);
      addParams(func.queryParams,"query",request);
      addParams(func.formParams,"query",request);
      addParams(func.headerParams,"header",request);
      final FElem response=new FElem(new QNm("response",WADL));
      method.add(response);
      final FElem representation=new FElem(new QNm("representation",WADL));
      response.add(representation.add(new QNm("mediaType"),HTTPContext.mediaType(func.output)));
    }
  }
  for (  final FElem elem : map.values())   ress.add(elem);
  final Serializer ser=Serializer.get(http.res.getOutputStream());
  ser.serialize(appl);
  ser.close();
}
