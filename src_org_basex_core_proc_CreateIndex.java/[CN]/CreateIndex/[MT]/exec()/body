{
  final Data data=context.data();
  if (data instanceof MemData)   return error(PROCMM);
  try {
    Type index=null;
switch (type) {
case TEXT:
      data.meta.txtindex=true;
    index=Type.TXT;
  break;
case ATTRIBUTE:
data.meta.atvindex=true;
index=Type.ATV;
break;
case FULLTEXT:
data.meta.ftxindex=true;
data.meta.ftfz=prop.is(Prop.FTFUZZY);
data.meta.ftst=prop.is(Prop.FTST);
data.meta.ftcs=prop.is(Prop.FTCS);
data.meta.ftdc=prop.is(Prop.FTDC);
index=Type.FTX;
break;
}
data.flush();
buildIndex(index,data);
return info(DBINDEXED,perf.getTimer());
}
 catch (final IOException ex) {
BaseX.debug(ex);
return error(ex.getMessage());
}
}
