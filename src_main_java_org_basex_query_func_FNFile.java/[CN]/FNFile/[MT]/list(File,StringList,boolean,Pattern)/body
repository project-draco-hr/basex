{
  final File[] ch=dir.listFiles();
  if (ch == null)   return;
  if (rec) {
    for (    final File f : ch) {
      if (!mayBeLink(f) && f.isDirectory())       list(f,list,rec,pat);
    }
  }
  for (  final File f : ch) {
    if (!mayBeLink(f) && (pat == null || pat.matcher(f.getName()).matches() && !f.isDirectory()))     list.add(f.getPath());
  }
}
