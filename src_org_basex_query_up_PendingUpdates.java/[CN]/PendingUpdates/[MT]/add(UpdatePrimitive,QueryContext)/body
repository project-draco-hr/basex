{
  if (p.node instanceof FNode) {
    frags.add(p);
  }
 else   if (p.node instanceof DBNode) {
    final Data d=((DBNode)p.node).data;
    DBPrimitives dp=dbs.get(d);
    if (dp == null) {
      User user=ctx.context.user;
      final User us=d.meta.users.get(user.name);
      if (us != null)       user=us;
      if (!user.perm(User.READ))       throw new QueryException(Main.info(PERMNO,CmdPerm.READ));
      dp=new DBPrimitives(false);
      dbs.put(d,dp);
    }
    dp.add(p);
  }
}
