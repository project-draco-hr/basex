{
  int p=par;
  while (p >= 0) {
    int k=kind(p);
    size(p,k,size(p,k) + s);
    p=parent(p,k);
  }
  updateDist(pre + s,s);
}
