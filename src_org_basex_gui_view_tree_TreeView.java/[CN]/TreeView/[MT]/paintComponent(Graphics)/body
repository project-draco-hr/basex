{
  super.paintComponent(g);
  g.setFont(GUIConstants.font);
  nodeHeight=fontHeight=g.getFontMetrics().getHeight();
  setLevelDistance();
  if (windowSizeChanged()) {
    if (markedImage != null) {
      markedImage=null;
      refreshedMark=true;
    }
    focusedRect=null;
    cache.generateBordersAndRects(g,gui.context,getWidth());
    createNewMainImage();
  }
  g.drawImage(treeImage,0,0,getWidth(),getHeight(),this);
  if (refreshedMark)   markNodes();
  if (markedImage != null)   g.drawImage(markedImage,0,0,getWidth(),getHeight(),this);
  if (focus())   highlightNode(g,0,gui.context.focused,focusedRect,focusedRectLevel,-1,false,SHOW_ANCESTORS,SHOW_DESCENDANTS);
  if (selection)   markSelektedNodes(g);
}
