{
  final int h=getHeight() - 5;
  final int lvs=gui.context.current.data.meta.height + 1;
  int lD=0;
  while ((lD=(int)((h - lvs * nodeHeight) / (double)(lvs - 1))) < MINIMUM_LEVEL_DISTANCE && nodeHeight > MINIMUM_NODE_HEIGHT)   nodeHeight--;
  levelDistance=lD < MINIMUM_LEVEL_DISTANCE ? MINIMUM_LEVEL_DISTANCE : lD > MAXIMUM_LEVEL_DISTANCE ? MAXIMUM_LEVEL_DISTANCE : lD;
  final int ih=(int)((h - (levelDistance * (lvs - 1) + lvs * nodeHeight)) / 2d);
  topMargin=ih < TOP_MARGIN ? TOP_MARGIN : ih;
}
