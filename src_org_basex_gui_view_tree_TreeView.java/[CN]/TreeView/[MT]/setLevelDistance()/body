{
  final int h=getHeight() - 5;
  final int lvs=cache.getHeight(0);
  int lD;
  while ((lD=(int)((h - lvs * nodeHeight) / (double)(lvs - 1))) < MIN_LEVEL_DISTANCE && nodeHeight > MIN_NODE_HEIGHT)   nodeHeight--;
  levelDistance=lD < MIN_LEVEL_DISTANCE ? MIN_LEVEL_DISTANCE : lD > MAX_LEVEL_DISTANCE ? MAX_LEVEL_DISTANCE : lD;
  final int ih=(int)((h - (levelDistance * (lvs - 1) + lvs * nodeHeight)) / 2d);
  topMargin=ih < TOP_MARGIN ? TOP_MARGIN : ih;
}
