{
  final int[] dists=distances(ids);
  final int sz=dists.length;
  int bytes=Num.length(sz);
  for (  final int id : dists)   bytes+=Num.length(id);
  final long offset=free.get(bytes,idxl.length());
  writeIdOffset(index,offset,key);
  idxl.writeNums(offset,dists);
  cache.add(key,sz,offset + Num.length(sz));
}
