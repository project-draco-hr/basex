{
  final TokenList allkeys=new TokenList(m).sort(true);
  final IntList empty=new IntList(m.size());
  int p=-1;
  final int s=size.get();
  for (  final byte[] key : allkeys) {
    p=get(key,++p,s);
    if (p < 0)     Util.notexpected("Tried to delete ids " + m.get(key) + " of non-existing index key: '"+ string(key)+ '\'');
 else     if (deleteIds(p,key,m.get(key).sort().toArray()) == 0)     empty.add(p);
  }
  if (!empty.isEmpty())   deleteKeys(empty.toArray());
}
