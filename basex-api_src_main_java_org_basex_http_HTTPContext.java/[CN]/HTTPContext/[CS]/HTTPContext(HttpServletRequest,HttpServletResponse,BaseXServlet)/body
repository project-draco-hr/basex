{
  this.req=req;
  this.res=res;
  params=new HTTPParams(this);
  method=req.getMethod();
  final StringBuilder uri=new StringBuilder(req.getRequestURL());
  final String qs=req.getQueryString();
  if (qs != null)   uri.append('?').append(qs);
  context.log.write(address(),context.user(),LogType.REQUEST,'[' + method + "] "+ uri,null);
  res.setCharacterEncoding(Strings.UTF8);
  path=decode(normalize(req.getPathInfo()));
  final StaticOptions mprop=context().soptions;
  user=servlet.user != null ? servlet.user : mprop.get(StaticOptions.USER);
  password=servlet.pass != null ? servlet.pass : mprop.get(StaticOptions.PASSWORD);
  auth=servlet.auth != null ? servlet.auth : mprop.get(StaticOptions.AUTHMETHOD);
}
