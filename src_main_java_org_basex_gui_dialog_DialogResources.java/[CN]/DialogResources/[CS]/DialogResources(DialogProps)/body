{
  setLayout(new BorderLayout(0,5));
  dialog=d;
  final DefaultMutableTreeNode rootNode=new DefaultMutableTreeNode();
  tree=new BaseXTree(rootNode,d);
  tree.setBorder(new EmptyBorder(4,4,4,4));
  tree.setRootVisible(false);
  tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  final ImageIcon xml=BaseXLayout.icon("file_xml");
  final ImageIcon raw=BaseXLayout.icon("file_raw");
  tree.setCellRenderer(new TreeNodeRenderer(xml,raw));
  tree.addTreeSelectionListener(new TreeSelectionListener(){
    @Override public void valueChanged(    final TreeSelectionEvent e){
      TreeNode n=(TreeNode)e.getPath().getLastPathComponent();
      String filt=n.equals(root) ? "" : n.path();
      String trgt=filt + '/';
      if (n.isLeaf()) {
        n=(TreeNode)n.getParent();
        trgt=(n == null || n.equals(root) ? "" : n.path()) + '/';
      }
 else {
        filt=trgt;
      }
      filterText.setText(filt);
      dialog.add.target.setText(trgt);
    }
  }
);
  final Data data=d.gui.context.data();
  root=new TreeRootFolder(token(data.meta.name),token("/"),tree,data);
  ((DefaultTreeModel)tree.getModel()).insertNodeInto(root,rootNode,0);
  tree.expandPath(new TreePath(root.getPath()));
  filter=new BaseXButton(FILTER,d);
  clear=new BaseXButton(CLEAR,d);
  new BaseXPopup(tree,d.gui,new DeleteCmd(),new RenameCmd());
  final BaseXBack buttons=new BaseXBack(Fill.NONE);
  buttons.add(filter);
  buttons.add(clear);
  final BaseXBack btn=new BaseXBack(Fill.NONE).layout(new BorderLayout());
  btn.add(buttons,BorderLayout.EAST);
  filterText=new BaseXTextField("",d.gui);
  BaseXLayout.setWidth(filterText,220);
  final BaseXBack panel=new BaseXBack(new BorderLayout());
  panel.add(filterText,BorderLayout.CENTER);
  panel.add(btn,BorderLayout.SOUTH);
  add(new JScrollPane(tree),BorderLayout.CENTER);
  add(panel,BorderLayout.SOUTH);
}
