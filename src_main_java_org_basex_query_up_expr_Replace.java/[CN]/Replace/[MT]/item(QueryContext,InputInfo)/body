{
  final Constr c=new Constr(ii,ctx).add(expr[1]);
  if (c.errAtt)   UPNOATTRPER.thrw(info);
  if (c.duplAtt != null)   UPATTDUPL.thrw(info,c.duplAtt);
  final Iter t=ctx.iter(expr[0]);
  final Item i=t.next();
  if (i == null)   throw UPSEQEMP.thrw(info,Util.name(this));
  final Type tp=i.type;
  if (!(i instanceof ANode) || tp == NodeType.DOC || t.next() != null)   UPTRGMULT.thrw(info);
  final ANode targ=(ANode)i;
  final DBNode dbn=ctx.updates.determineDataRef(targ,ctx);
  final ANodeList aList=c.atts;
  ANodeList list=c.children;
  if (value) {
    final byte[] txt=list.size() < 1 ? aList.size() < 1 ? EMPTY : aList.get(0).string() : list.get(0).string();
    if (tp == NodeType.COM)     FComm.parse(txt,info);
    if (tp == NodeType.PI)     FPI.parse(txt,info);
    ctx.updates.add(new ReplaceValue(dbn.pre,dbn.data,info,txt),ctx);
  }
 else {
    final ANode par=targ.parent();
    if (par == null)     UPNOPAR.thrw(info,i);
    if (tp == NodeType.ATT) {
      if (list.size() > 0)       UPWRATTR.thrw(info);
      list=checkNS(aList,par,ctx);
    }
 else {
      if (aList.size() > 0)       UPWRELM.thrw(info);
    }
    ctx.updates.add(new ReplaceNode(dbn.pre,dbn.data,info,list),ctx);
  }
  return null;
}
