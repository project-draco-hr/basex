{
  final Value val=exprs[0].value(qc);
  final long pos=toLong(exprs[1],qc);
  final Value sub=exprs[2].value(qc);
  final long n=val.size(), k=sub.size();
  if (n == 0)   return sub;
  if (k == 0)   return val;
  final long p=Math.min(Math.max(0,pos - 1),n);
  if (n > 1)   return ((Seq)val).insertBefore(p,sub);
  final Item v=(Item)val;
  if (k > 1)   return ((Seq)sub).insert(p == 0 ? k : 0,v);
  final Item s=(Item)sub;
  return p == 0 ? Seq.get(s,v) : Seq.get(v,s);
}
