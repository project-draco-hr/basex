{
  final XQuery query=new XQuery("\n" + "        declare function local:section-summary($book-or-section as element()*) as element()* { \n" + "            for $section in $book-or-section \n"+ "            return <section> { $section/@* } { $section/title } <figcount> { count($section/figure) } </figcount> { local:section-summary($section/section) } </section> \n"+ "        }; \n"+ "        <toc> { \n"+ "            for $s in /book/section \n"+ "            return local:section-summary($s) \n"+ "        } </toc>\n"+ "      ",ctx);
  query.context(node(file("docs/book.xml")));
  final QT3Result res=result(query);
  result=res;
  test(assertSerialization("<toc><section id=\"intro\" difficulty=\"easy\"><title>Introduction</title><figcount>0</figcount><section><title>Audience</title><figcount>0</figcount></section><section><title>Web Data and the Two Cultures</title><figcount>1</figcount></section></section><section id=\"syntax\" difficulty=\"medium\"><title>A Syntax For Data</title><figcount>1</figcount><section><title>Base Types</title><figcount>0</figcount></section><section><title>Representing Relational Databases</title><figcount>1</figcount></section><section><title>Representing Object Databases</title><figcount>0</figcount></section></section></toc>",false));
}
