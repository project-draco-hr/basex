{
  final XQuery query=new XQuery("\n" + "        declare function local:toc($book-or-section as element()) as element()* { \n" + "            for $section in $book-or-section/section \n"+ "            return <section> { $section/@* , $section/title , local:toc($section) } </section> };\n"+ "        <toc> { for $s in /book return local:toc($s) } </toc>\n"+ "      ",ctx);
  try {
    query.context(node(file("docs/book.xml")));
    result=new QT3Result(query.value());
  }
 catch (  final Throwable trw) {
    result=new QT3Result(trw);
  }
 finally {
    query.close();
  }
  test(assertSerialization("<toc><section id=\"intro\" difficulty=\"easy\"><title>Introduction</title><section><title>Audience</title></section><section><title>Web Data and the Two Cultures</title></section></section><section id=\"syntax\" difficulty=\"medium\"><title>A Syntax For Data</title><section><title>Base Types</title></section><section><title>Representing Relational Databases</title></section><section><title>Representing Object Databases</title></section></section></toc>",false));
}
