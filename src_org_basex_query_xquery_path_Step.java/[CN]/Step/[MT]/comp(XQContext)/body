{
  if (!test.comp(ctx))   return Seq.EMPTY;
  final DBNode db=ctx.dbroot();
  if (db != null && test.kind == Kind.NAME) {
    ctx.leaf=axis.down && db.data.meta.uptodate && db.data.ns.size() == 0 && db.data.tags.stat(db.data.tagID(((NameTest)test).ln)).leaf;
  }
  final Expr e=super.comp(ctx);
  ctx.leaf=false;
  if (e != this)   return Seq.EMPTY;
  if (pred.length == 0)   return get(axis,test);
  final Expr p=pred[0];
  final Pos pos=p instanceof Pos ? (Pos)p : null;
  final boolean last=p instanceof Fun && ((Fun)p).func == FunDef.LAST;
  if (pred.length > 1 || !last && pos == null && usesPos(ctx))   return this;
  return new IterStep(axis,test,pred,pos,last);
}
