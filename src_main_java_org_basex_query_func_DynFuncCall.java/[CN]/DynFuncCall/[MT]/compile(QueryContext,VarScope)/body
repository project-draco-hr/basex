{
  super.compile(ctx,scp);
  final int ar=expr.length - 1;
  final Expr f=expr[ar];
  final Type t=f.type().type;
  if (t instanceof FuncType) {
    final FuncType ft=(FuncType)t;
    if (ft.args != null && ft.args.length != ar)     INVARITY.thrw(info,f,ar);
    if (ft.ret != null)     type=ft.ret;
  }
  return allAreValues() && f instanceof Map ? optPre(value(ctx),ctx) : this;
}
