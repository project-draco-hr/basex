{
  final boolean empty=pages == 0 && pos == 0;
  if (empty)   pos++;
  flush();
  os.close();
  final DataOutput out=new DataOutput(meta.dbfile(file + 'i'));
  try {
    out.writeNum(pages);
    out.writeNum(empty ? 0 : Integer.MAX_VALUE);
  }
  finally {
    out.close();
  }
}
