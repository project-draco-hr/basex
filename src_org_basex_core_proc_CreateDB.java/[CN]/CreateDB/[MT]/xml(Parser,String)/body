{
  try {
    if (Prop.onthefly)     return new MemBuilder().build(p,db);
    final Data data=new DiskBuilder().build(p,db);
    if (data.meta.txtindex)     data.openIndex(IndexToken.TYPE.TXT,new ValueBuilder(true).build(data));
    if (data.meta.atvindex)     data.openIndex(IndexToken.TYPE.ATV,new ValueBuilder(false).build(data));
    if (data.meta.ftxindex)     data.openIndex(IndexToken.TYPE.FTX,data.meta.ftfuzzy ? new FZBuilder().build(data) : new FTBuilder().build(data));
    return data;
  }
 catch (  final IOException ex) {
    BaseX.debug(ex);
    return null;
  }
}
