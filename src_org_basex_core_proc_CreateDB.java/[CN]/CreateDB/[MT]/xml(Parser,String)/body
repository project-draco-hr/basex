{
  if (Prop.onthefly)   return new MemBuilder().build(p,db);
  final Data data=new DiskBuilder().build(p,db);
  if (data.meta.txtindex)   data.setIndex(IndexToken.Type.TXT,new ValueBuilder(true).build(data));
  if (data.meta.atvindex)   data.setIndex(IndexToken.Type.ATV,new ValueBuilder(false).build(data));
  if (data.meta.ftxindex)   data.setIndex(IndexToken.Type.FTX,data.meta.ftfz ? new FTFuzzyBuilder().build(data) : new FTBuilder().build(data));
  return data;
}
