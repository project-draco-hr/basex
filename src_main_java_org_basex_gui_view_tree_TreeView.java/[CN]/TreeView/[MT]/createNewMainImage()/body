{
  treeImage=createImage();
  final Graphics tg=treeImage.getGraphics();
  tg.setFont(font);
  smooth(tg);
  for (int rn=0; rn < numRoots; rn++) {
    final int h=sub.getSubtreeHeight(rn);
    for (int lv=0; lv < h; lv++) {
      final boolean br=tr.isBigRectangle(sub,rn,lv);
      final TreeRect[] lr=tr.getTreeRectsPerLevel(rn,lv);
      for (int i=0; i < lr.length; i++) {
        final TreeRect r=lr[i];
        final int pre=sub.getPrePerIndex(rn,lv,i);
        drawRectangle(tg,rn,lv,r,pre,DRAW_RECTANGLE);
      }
      if (br) {
        final TreeRect r=lr[0];
        int nh=nodeHeight;
        final int w=r.x + r.w - 1;
        int x=r.x + 1;
        final int y=getYperLevel(lv);
        final int box=4;
        tg.setColor(GUIConstants.back);
        while (nh > 0) {
          nh=nh - box;
          while (nh < 0)           nh++;
          tg.drawLine(x,y + nh,w,y + nh);
        }
        while (x < w) {
          x=x + box - 1 < w ? x + box : x + box - 1;
          tg.drawLine(x,y,x,y + nodeHeight);
        }
      }
    }
    if (SHOW_CONN_MI) {
      final TreeRect rr=tr.getTreeRectPerIndex(rn,0,0);
      highlightDescendants(tg,rn,0,rr,roots[rn],getRectCenter(rr),DRAW_CONN);
    }
  }
}
