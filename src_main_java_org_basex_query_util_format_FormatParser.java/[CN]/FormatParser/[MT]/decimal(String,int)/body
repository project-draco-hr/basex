{
  int s=-1;
  final int l=in.length();
  boolean d=false;
  boolean g=false;
  while (++s < l) {
    final int ch=cp(in,s);
    if (Character.isLetter(ch))     break;
    if (ch == '#') {
      if (d)       return -1;
      g=false;
    }
 else     if (ch == '*') {
      g=false;
    }
 else     if (ch >= ba && ch <= ba + 9) {
      d=true;
      g=false;
    }
 else {
      if (g)       return -1;
      g=true;
    }
  }
  if (!d || g)   return -1;
  return s;
}
