{
  final XQuery query=new XQuery("\n" + "            declare function local:distinct-nodes-stable($seq as node()*) { \n" + "                fold-left( function($foundSoFar as node()*, $this as node()) as node()* { \n"+ "                if ($foundSoFar intersect $this) \n"+ "                then $foundSoFar \n"+ "                else ($foundSoFar, $this) }, (), $seq) \n"+ "            }; \n"+ "            let $nodes := (<a/>, <b/>, <c/>, <d/>, <e/>, <f/>) \n"+ "            let $perm := ($nodes[1], $nodes[2], $nodes[4], $nodes[1], $nodes[2], $nodes[3], $nodes[2], $nodes[1]) \n"+ "            return local:distinct-nodes-stable($perm)/local-name()\n"+ "      ",ctx);
  try {
    result=new QT3Result(query.value());
  }
 catch (  final Throwable trw) {
    result=new QT3Result(trw);
  }
 finally {
    query.close();
  }
  test(assertStringValue(false,"a b d c"));
}
