{
  if (expr == null)   throw (declared ? VAREMPTY : VARUNDEF).thrw(info,this);
  if (!compiled) {
    final StaticContext tmp=ctx.sc;
    ctx.sc=sc;
    final int fp=scope.enter(ctx);
    try {
      expr=expr.compile(ctx,scope);
    }
 catch (    final QueryException qe) {
      compiled=true;
      if (lazy) {
        expr=FNInfo.error(qe,info);
        return this;
      }
      throw qe.notCatchable();
    }
 finally {
      scope.cleanUp(this);
      scope.exit(ctx,fp);
      ctx.sc=tmp;
    }
    compiled=true;
    if (!lazy || expr.isValue()) {
      final Value val=bind(value(ctx));
      return val;
    }
  }
  return value != null ? value : this;
}
