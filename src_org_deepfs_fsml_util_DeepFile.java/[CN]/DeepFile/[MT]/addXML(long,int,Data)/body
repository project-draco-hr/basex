{
  if (!extractXML())   return;
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  final PrintOutput po=new PrintOutput(baos);
  final XMLSerializer ser=new XMLSerializer(po);
  final Context ctx=new Context();
  ctx.openDB(data);
  final QueryProcessor qp=new QueryProcessor("/",ctx);
  byte[] xmlContent;
  try {
    final Result res=qp.query();
    res.serialize(ser);
    xmlContent=baos.toByteArray();
    ser.close();
    po.close();
  }
 catch (  final QueryException e) {
    xmlContent=new byte[]{};
  }
  if (xmlContent.length == 0)   return;
  final int textmax=context.prop.num(Prop.FSTEXTMAX);
  if (xmlContent.length > textmax) {
    if (!extractText())     return;
    final byte[] text=new byte[textmax];
    System.arraycopy(xmlContent,0,text,0,textmax);
    textContents.add(new TextContent(position,textmax,text));
  }
 else {
    xmlContents.add(new XMLContent(position,byteCount,new String(xmlContent)));
  }
}
