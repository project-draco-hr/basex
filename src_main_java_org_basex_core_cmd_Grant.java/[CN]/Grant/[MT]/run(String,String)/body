{
  if (user.equals(ADMIN))   return !info(ADMIN_STATIC_X);
  if (db == null) {
    context.users.get(user).perm=prm;
    context.users.write();
    return info(GRANTED_X_X,args[0],user);
  }
  try {
    final Data data=Open.open(db,context);
    if (data.pinned())     return !info(DB_PINNED_X,db);
    User u=data.meta.users.get(user);
    if (u == null) {
      u=context.users.get(user).copy();
      data.meta.users.create(u);
    }
    u.perm=prm;
    data.meta.dirty=true;
    data.flush();
    Close.close(data,context);
    return info(GRANTED_ON_X_X_X,args[0],user,db);
  }
 catch (  final IOException ex) {
    Util.debug(ex);
    final String msg=ex.getMessage();
    return !info(msg.isEmpty() ? DB_NOT_OPENED_X : msg,db);
  }
}
