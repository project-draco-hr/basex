{
  final byte[] contTypeHdr=r.headers.get(lc(token(CONT_TYPE)));
  if (contTypeHdr != null) {
    conn.setRequestProperty(CONT_TYPE,string(contTypeHdr));
  }
 else {
    final String mediaType=string(r.payloadAttrs.get(MEDIATYPE));
    if (r.isMultipart) {
      final String b=string(r.payloadAttrs.get(BOUNDARY));
      final String boundary=(b != null) ? b : DEFAULT_BOUND;
      StringBuilder sb=new StringBuilder();
      sb.append(mediaType).append("; ").append("boundary=").append(boundary);
      conn.setRequestProperty(CONT_TYPE,sb.toString());
    }
 else {
      conn.setRequestProperty(CONT_TYPE,mediaType);
    }
  }
}
