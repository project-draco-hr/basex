{
  final BufferedFileChannel bfc=deepFile.getBufferedFileChannel();
  final int maxSize=deepFile.maxTextSize();
  if (bfc.size() <= maxSize) {
    final Data data=parse(bfc,deepFile.getContext().prop);
    if (data != null) {
      if (deepFile.extractMeta()) {
        deepFile.setFileType(FileType.XML);
        final String name=bfc.getFileName();
        final String suf=name.substring(name.lastIndexOf('.') + 1).toLowerCase();
        final MimeType mime=SUFFIXES.get(suf);
        if (mime == null)         Util.notexpected();
        deepFile.setFileFormat(mime);
      }
      if (deepFile.extractXML()) {
        deepFile.addXML(bfc.getOffset(),(int)bfc.size(),data);
      }
      return;
    }
  }
  if (deepFile.extractText()) {
    try {
      deepFile.fallback();
    }
 catch (    final ParserException ex) {
      deepFile.debug("XMLParser: Failed to read text content from file with " + "fallback parser (%).",ex);
    }
  }
}
