{
  final Map<String,Integer> m=new HashMap<String,Integer>();
  final Set<Integer> ats=new HashSet<Integer>();
  for (  final int pre : pres) {
    if (d.kind(pre) == Data.ATTR) {
      ats.add(pre);
      addAttributeChanges(m,pre);
    }
 else {
      addElementChanges(m,pre);
      int p=pre + 1;
      while (p < pre + d.attSize(pre,Data.ELEM) && !ats.contains(p)) {
        changeAttributePool(m,true,Token.string(d.attName(p++)));
      }
    }
  }
  findDuplicates(m);
  m.clear();
}
