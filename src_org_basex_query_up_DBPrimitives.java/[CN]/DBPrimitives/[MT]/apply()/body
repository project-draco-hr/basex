{
  for (int i=nodes.length - 1; i >= 0; i--) {
    final UpdatePrimitive[] pl=op.get(nodes[i]);
    int add=0;
    for (    final UpdatePrimitive pp : pl) {
      if (pp == null)       continue;
      if (pp.type() == PrimitiveType.INSERTBEFORE) {
        add=((InsertBefore)pp).m.meta.size;
      }
      pp.apply(add);
      if (pp.type() == PrimitiveType.REPLACENODE)       break;
    }
  }
  d.flush();
}
