{
  for (int i=nodes.length - 1; i >= 0; i--) {
    int add=0;
    for (    final UpdatePrimitive pp : op.get(nodes[i])) {
      if (pp == null)       continue;
      if (pp.type() == PrimitiveType.INSERTBEFORE) {
        add=((NodeCopy)pp).md.meta.size;
      }
      pp.apply(add);
      if (pp.type() == PrimitiveType.REPLACENODE)       break;
    }
  }
  d.flush();
}
