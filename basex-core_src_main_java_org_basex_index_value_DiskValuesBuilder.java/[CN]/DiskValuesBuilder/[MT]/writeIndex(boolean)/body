{
  final String name=DiskValues.getFileSuffix(text,tokenize) + (partial ? splits : "");
  try (final DataOutput outL=new DataOutput(data.meta.dbfile(name + 'l'));final DataOutput outR=new DataOutput(data.meta.dbfile(name + 'r'))){
    outL.write4(index.size());
    final LongList il=new LongList();
    index.init();
    while (index.more()) {
      final byte[] values=index.values.get(index.next());
      final int vs=Num.size(values);
      if (partial) {
        outR.write5(outL.size());
        outL.write(values,0,vs);
      }
 else {
        for (int ip=4; ip < vs; ip+=Num.length(values,ip)) {
          long value=Num.get(values,ip);
          if (tokenize) {
            ip+=Num.length(values,ip);
            value=value << 32 | Num.get(values,ip);
          }
          il.add(value);
        }
        write(outL,outR,il,tokenize);
      }
    }
  }
   if (partial) {
    try (final DataOutput outT=new DataOutput(data.meta.dbfile(name + 't'))){
      index.init();
      while (index.more())       outT.writeToken(index.keys.get(index.next()));
    }
   }
  splits++;
}
