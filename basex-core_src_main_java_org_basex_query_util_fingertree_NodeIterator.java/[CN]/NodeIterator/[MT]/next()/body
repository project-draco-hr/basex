{
  if (index >= rootSize)   throw new NoSuchElementException();
  index++;
  if (leafPos >= leaf.arity()) {
    while (poss[top] >= nodes[top].arity() - 1)     top--;
    poss[top]++;
    Node<?,E> sub=nodes[top].getSub(poss[top]);
    while (sub instanceof InnerNode) {
      ++top;
      nodes[top]=(InnerNode<?,E>)sub;
      poss[top]=0;
      sub=nodes[top].getSub(0);
    }
    leaf=(Node<E,E>)sub;
    leafPos=0;
  }
  return leaf.getSub(leafPos++);
}
