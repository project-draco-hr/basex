{
  final TransformerFactory tc=TransformerFactory.newInstance();
  final Transformer tr=tc.newTransformer(new StreamSource(new ByteArrayInputStream(xsl.content())));
  for (  final byte[] key : params) {
    tr.setParameter(string(key),params.get(key));
  }
  for (  final byte[] key : output) {
    tr.setOutputProperty(string(key),output.get(key).toString());
  }
  final ArrayOutput ao=new ArrayOutput();
  tr.transform(new StreamSource(new ByteArrayInputStream(in.content())),new StreamResult(ao));
  return ao.toArray();
}
