{
  events.start();
  running=true;
  while (running) {
    try {
      final Socket s=socket.accept();
      final ClientListener cl=new ClientListener(s,context,log);
      if (stop.exists()) {
        if (!stop.delete())         log.write(Util.info(DBNOTDELETED,stop));
        quit();
      }
 else {
        final byte[] address=s.getInetAddress().getAddress();
        if (cl.init()) {
          blocked.delete(address);
          context.add(cl);
        }
 else {
          int delay=blocked.get(address);
          delay=delay == -1 ? 1 : Math.min(delay,1024) * 2;
          blocked.add(address,delay);
          new ClientDelayer(delay,cl,this);
        }
      }
    }
 catch (    final IOException ex) {
      break;
    }
  }
}
